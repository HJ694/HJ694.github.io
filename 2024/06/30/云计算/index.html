

<!DOCTYPE html>
<html lang="zh-CN" data-default-color-scheme=auto>



<head>
  <meta charset="UTF-8">
  <link rel="apple-touch-icon" sizes="76x76" href="/img/fluid.png">
  <link rel="icon" href="/img/fluid.png">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=5.0, shrink-to-fit=no">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  
  <meta name="theme-color" content="#2f4154">
  <meta name="author" content="John Doe">
  <meta name="keywords" content="">
  
    <meta name="description" content="*第一阶段liunx基础**：  liunx目录结构：linux目录组织结构：     bin****：二进制目录，存放简单的命令字符目录    boot：启动目录，文件启动的内核目录    run：运行目录，程序运行所使用的目录    etc：配置目录，程序配置所使用的目录，比如网卡****之类的    dev****：设备目录，存放媒体设备之类文件的目录    home：家目录，普通用户存放">
<meta property="og:type" content="article">
<meta property="og:title" content="云计算">
<meta property="og:url" content="http://example.com/2024/06/30/%E4%BA%91%E8%AE%A1%E7%AE%97/index.html">
<meta property="og:site_name" content="Hexo">
<meta property="og:description" content="*第一阶段liunx基础**：  liunx目录结构：linux目录组织结构：     bin****：二进制目录，存放简单的命令字符目录    boot：启动目录，文件启动的内核目录    run：运行目录，程序运行所使用的目录    etc：配置目录，程序配置所使用的目录，比如网卡****之类的    dev****：设备目录，存放媒体设备之类文件的目录    home：家目录，普通用户存放">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="https://hqrchvz3h42.feishu.cn/space/api/box/stream/download/asynccode/?code=MTEzMWQxNmQxYjZiNTIxZGE0MTcyNTE1MjY4MTc5MWNfRlF0dFAyZTlxQzdkc1V5NDZ6ZEVIZ09yNHQ1WXl5ajFfVG9rZW46VFVQeGJvQ25Vb0N4bEZ4ZGZ2TWM2RTdQblpnXzE3MTk3MTk1MjE6MTcxOTcyMzEyMV9WNA">
<meta property="og:image" content="https://hqrchvz3h42.feishu.cn/space/api/box/stream/download/asynccode/?code=NjFlM2NjNDA3NGExNThiYzNkNDczZWJjYWY5ZTNjM2JfZGIzYTFnNUQ1enJjbmlmcGpRREZYUmVIb280M09aRzNfVG9rZW46VmNlbmJ4QTZHb3RzbnZ4WGk2aGNGMkVXbjhjXzE3MTk3MTk1MjE6MTcxOTcyMzEyMV9WNA">
<meta property="og:image" content="https://hqrchvz3h42.feishu.cn/space/api/box/stream/download/asynccode/?code=ODUyOTUxZjI5NjFlZjgwNTA0ZDg0YmYzOWM0NDg3MjJfUE8yNHNvQWoxS2QxYUpiU1A1SnFlVVVVMjVHcWJHM3NfVG9rZW46U0FIa2JiRkRjb09WR3V4WU5DUmNIVElnbnFlXzE3MTk3MTk1MjE6MTcxOTcyMzEyMV9WNA">
<meta property="og:image" content="https://hqrchvz3h42.feishu.cn/space/api/box/stream/download/asynccode/?code=YjEzZjc3ZmI1ZTc0YmY0MDdmMWY3MDM0MTZlZGRhMDFfdGRCQ0FTRDJpak9sR0FCM2hlZFlzamNpWXh5UnRvc2xfVG9rZW46SnZWZ2IybGlNb05YbVN4bVh5dGM2MGlWblliXzE3MTk3MTk1MjE6MTcxOTcyMzEyMV9WNA">
<meta property="og:image" content="https://hqrchvz3h42.feishu.cn/space/api/box/stream/download/asynccode/?code=Njg0MzlhZTFhYzgwNDVkNDAxYzc1MzZkOTNmNjRkNTBfUmE2dHh6SkRzRUdJQ1JpYkc0Q3NUbDBxbGtTZVJCbU9fVG9rZW46WnVmamJ5anc3b0l0SWt4Z1ZTcmNZNUNEbkplXzE3MTk3MTk1MjE6MTcxOTcyMzEyMV9WNA">
<meta property="og:image" content="https://hqrchvz3h42.feishu.cn/space/api/box/stream/download/asynccode/?code=NGI4NGZhNTMzNGEyNjVmNGI1NmZiOGFlODdkOWM1N2JfS2RzbFFTcnNvdzdmNzd6YzFFeXVoRlRYeURYcHhhZ1ZfVG9rZW46WDlOd2JZT1Eyb0dXUWN4a0ptRmNvMUlHbm9lXzE3MTk3MTk1MjE6MTcxOTcyMzEyMV9WNA">
<meta property="og:image" content="https://hqrchvz3h42.feishu.cn/space/api/box/stream/download/asynccode/?code=YmUxZjg2ZGYzM2Y5NDRjZjE4ZmRhNGUzOGJiNDgyNDBfajE0bExocHRtbkYxYjZtM2ZhSVU2aUp6RFNzWDh1VWdfVG9rZW46RTZTcWJvQ0hYb25vS0x4VDZQZ2NaVU9FbjFlXzE3MTk3MTk1MjE6MTcxOTcyMzEyMV9WNA">
<meta property="og:image" content="https://hqrchvz3h42.feishu.cn/space/api/box/stream/download/asynccode/?code=NzRhOThhYjI2NzMxYzhhYzRlOTc1ZGUzNGVkMDZhY2NfNmQweXU4RzhtZmRxUExIRUswUmJTYVNFUU15akJRQ0JfVG9rZW46TVNkOWJBTzhtb1NSVHR4VjFQVWNlTm9hbnJjXzE3MTk3MTk1MjE6MTcxOTcyMzEyMV9WNA">
<meta property="og:image" content="https://hqrchvz3h42.feishu.cn/space/api/box/stream/download/asynccode/?code=YzY2M2IzN2UxMzlmZWM0MjA2YjY1MzdhMTY1NGUxYjFfVElBWWdnRUhubnlqTU5sTkRHM21DNUhNeElVN21OWEVfVG9rZW46S1VlTWJTTFlVb2I0Qzh4aDNIMmMwdm5zblZlXzE3MTk3MTk1MjE6MTcxOTcyMzEyMV9WNA">
<meta property="og:image" content="https://hqrchvz3h42.feishu.cn/space/api/box/stream/download/asynccode/?code=YmVlOTIwYjZkNWUzMTJmOWU2NDc2N2JiNmQ3YTYzNDVfOHVtcjc0ZERSVWNzZGpMWHFxVmY5czBlcUcwYlJTa2dfVG9rZW46SUJaaGJ0dHdwb1l5N2t4dkZoSmNsQXI0bk5mXzE3MTk3MTk1MjE6MTcxOTcyMzEyMV9WNA">
<meta property="og:image" content="https://hqrchvz3h42.feishu.cn/space/api/box/stream/download/asynccode/?code=YWI1M2E2MWNjZDczNzU1NWZlMjc4NmJiYTQ1Y2QxNDVfUVZZMGR5TUNwQUdKV0prbWMzdXRESXRaUnpHdFBCbEJfVG9rZW46QzdDZWJ5RVl3b250dWh4dWg5RGNVcUFIblZlXzE3MTk3MTk1MjE6MTcxOTcyMzEyMV9WNA">
<meta property="og:image" content="https://hqrchvz3h42.feishu.cn/space/api/box/stream/download/asynccode/?code=MGNhMjlhZWMyNzg2MzRlNzQ4MjZmOTU5N2M4ZDk4NWVfVnVkeVcxeHdFTXR2TDk4S0pEY29zbkVwZXVpRVBwanBfVG9rZW46Qk5Pb2JQVG5Tb0tNeWd4cVZvb2M0TGs5bmdoXzE3MTk3MTk1MjE6MTcxOTcyMzEyMV9WNA">
<meta property="og:image" content="https://hqrchvz3h42.feishu.cn/space/api/box/stream/download/asynccode/?code=NGYzNGQzYmM1YTJhYzYxY2NhZDQ1ODEwNTI5ZTJjZThfZDlQVER3UXh4cEVNTzF2cEpYVkp2TzRtYTkwdDQ3VnhfVG9rZW46SjFrU2I5QmVGb2k3Vnl4MmhFUmNnVlZUbjRjXzE3MTk3MTk1MjE6MTcxOTcyMzEyMV9WNA">
<meta property="og:image" content="https://hqrchvz3h42.feishu.cn/space/api/box/stream/download/asynccode/?code=MWE4NTIxZmFkYWU5NGRhZTAwNTk3MzgwNTgzMGVhZGZfcHNiUlV1WE5kaWJTbFExUmw5dnRGNUJFOEZWZkJRWjVfVG9rZW46RGhkNGJnSjNob1JWSHR4NXlrcmNTWjdQblFnXzE3MTk3MTk1MjE6MTcxOTcyMzEyMV9WNA">
<meta property="article:published_time" content="2024-06-30T03:50:36.161Z">
<meta property="article:modified_time" content="2024-06-30T03:55:39.485Z">
<meta property="article:author" content="John Doe">
<meta name="twitter:card" content="summary_large_image">
<meta name="twitter:image" content="https://hqrchvz3h42.feishu.cn/space/api/box/stream/download/asynccode/?code=MTEzMWQxNmQxYjZiNTIxZGE0MTcyNTE1MjY4MTc5MWNfRlF0dFAyZTlxQzdkc1V5NDZ6ZEVIZ09yNHQ1WXl5ajFfVG9rZW46VFVQeGJvQ25Vb0N4bEZ4ZGZ2TWM2RTdQblpnXzE3MTk3MTk1MjE6MTcxOTcyMzEyMV9WNA">
  
  
  
  <title>云计算 - Hexo</title>

  <link  rel="stylesheet" href="https://lib.baomitu.com/twitter-bootstrap/4.6.1/css/bootstrap.min.css" />



  <link  rel="stylesheet" href="https://lib.baomitu.com/github-markdown-css/4.0.0/github-markdown.min.css" />

  <link  rel="stylesheet" href="https://lib.baomitu.com/hint.css/2.7.0/hint.min.css" />

  <link  rel="stylesheet" href="https://lib.baomitu.com/fancybox/3.5.7/jquery.fancybox.min.css" />



<!-- 主题依赖的图标库，不要自行修改 -->
<!-- Do not modify the link that theme dependent icons -->

<link rel="stylesheet" href="//at.alicdn.com/t/font_1749284_hj8rtnfg7um.css">



<link rel="stylesheet" href="//at.alicdn.com/t/font_1736178_lbnruvf0jn.css">


<link  rel="stylesheet" href="/css/main.css" />


  <link id="highlight-css" rel="stylesheet" href="/css/highlight.css" />
  
    <link id="highlight-css-dark" rel="stylesheet" href="/css/highlight-dark.css" />
  




  <script id="fluid-configs">
    var Fluid = window.Fluid || {};
    Fluid.ctx = Object.assign({}, Fluid.ctx)
    var CONFIG = {"hostname":"example.com","root":"/","version":"1.9.7","typing":{"enable":true,"typeSpeed":70,"cursorChar":"_","loop":false,"scope":[]},"anchorjs":{"enable":true,"element":"h1,h2,h3,h4,h5,h6","placement":"left","visible":"hover","icon":""},"progressbar":{"enable":true,"height_px":3,"color":"#29d","options":{"showSpinner":false,"trickleSpeed":100}},"code_language":{"enable":true,"default":"TEXT"},"copy_btn":true,"image_caption":{"enable":true},"image_zoom":{"enable":true,"img_url_replace":["",""]},"toc":{"enable":true,"placement":"right","headingSelector":"h1,h2,h3,h4,h5,h6","collapseDepth":0},"lazyload":{"enable":true,"loading_img":"/img/loading.gif","onlypost":false,"offset_factor":2},"web_analytics":{"enable":false,"follow_dnt":true,"baidu":null,"google":{"measurement_id":null},"tencent":{"sid":null,"cid":null},"woyaola":null,"cnzz":null,"leancloud":{"app_id":null,"app_key":null,"server_url":null,"path":"window.location.pathname","ignore_local":false}},"search_path":"/local-search.xml","include_content_in_search":true};

    if (CONFIG.web_analytics.follow_dnt) {
      var dntVal = navigator.doNotTrack || window.doNotTrack || navigator.msDoNotTrack;
      Fluid.ctx.dnt = dntVal && (dntVal.startsWith('1') || dntVal.startsWith('yes') || dntVal.startsWith('on'));
    }
  </script>
  <script  src="/js/utils.js" ></script>
  <script  src="/js/color-schema.js" ></script>
  


  
<meta name="generator" content="Hexo 7.2.0"></head>


<body>
  

  <header>
    

<div class="header-inner" style="height: 70vh;">
  <nav id="navbar" class="navbar fixed-top  navbar-expand-lg navbar-dark scrolling-navbar">
  <div class="container">
    <a class="navbar-brand" href="/">
      <strong>Fluid</strong>
    </a>

    <button id="navbar-toggler-btn" class="navbar-toggler" type="button" data-toggle="collapse"
            data-target="#navbarSupportedContent"
            aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle navigation">
      <div class="animated-icon"><span></span><span></span><span></span></div>
    </button>

    <!-- Collapsible content -->
    <div class="collapse navbar-collapse" id="navbarSupportedContent">
      <ul class="navbar-nav ml-auto text-center">
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/" target="_self">
                <i class="iconfont icon-home-fill"></i>
                <span>首页</span>
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/archives/" target="_self">
                <i class="iconfont icon-archive-fill"></i>
                <span>归档</span>
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/categories/" target="_self">
                <i class="iconfont icon-category-fill"></i>
                <span>分类</span>
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/tags/" target="_self">
                <i class="iconfont icon-tags-fill"></i>
                <span>标签</span>
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/about/" target="_self">
                <i class="iconfont icon-user-fill"></i>
                <span>关于</span>
              </a>
            </li>
          
        
        
          <li class="nav-item" id="search-btn">
            <a class="nav-link" target="_self" href="javascript:;" data-toggle="modal" data-target="#modalSearch" aria-label="Search">
              <i class="iconfont icon-search"></i>
            </a>
          </li>
          
        
        
          <li class="nav-item" id="color-toggle-btn">
            <a class="nav-link" target="_self" href="javascript:;" aria-label="Color Toggle">
              <i class="iconfont icon-dark" id="color-toggle-icon"></i>
            </a>
          </li>
        
      </ul>
    </div>
  </div>
</nav>

  

<div id="banner" class="banner" parallax=true
     style="background: url('/img/default.png') no-repeat center center; background-size: cover;">
  <div class="full-bg-img">
    <div class="mask flex-center" style="background-color: rgba(0, 0, 0, 0.3)">
      <div class="banner-text text-center fade-in-up">
        <div class="h2">
          
            <span id="subtitle" data-typed-text="云计算"></span>
          
        </div>

        
          
  <div class="mt-3">
    
    
      <span class="post-meta">
        <i class="iconfont icon-date-fill" aria-hidden="true"></i>
        <time datetime="2024-06-30 11:50" pubdate>
          2024年6月30日 中午
        </time>
      </span>
    
  </div>

  <div class="mt-1">
    
      <span class="post-meta mr-2">
        <i class="iconfont icon-chart"></i>
        
          27k 字
        
      </span>
    

    
      <span class="post-meta mr-2">
        <i class="iconfont icon-clock-fill"></i>
        
        
        
          223 分钟
        
      </span>
    

    
    
  </div>


        
      </div>

      
    </div>
  </div>
</div>

</div>

  </header>

  <main>
    
      

<div class="container-fluid nopadding-x">
  <div class="row nomargin-x">
    <div class="side-col d-none d-lg-block col-lg-2">
      

    </div>

    <div class="col-lg-8 nopadding-x-md">
      <div class="container nopadding-x-md" id="board-ctn">
        <div id="board">
          <article class="post-content mx-auto">
            <h1 id="seo-header">云计算</h1>
            
            
              <div class="markdown-body">
                
                <ol>
<li><h1 id="第一阶段liunx基础-："><a href="#第一阶段liunx基础-：" class="headerlink" title="*第一阶段liunx基础**："></a>*第一阶段liunx基础**：</h1></li>
</ol>
<h2 id="liunx目录结构："><a href="#liunx目录结构：" class="headerlink" title="liunx目录结构："></a>liunx目录结构：</h2><p><strong>linux目录组织结构：</strong>     <strong>bin****：二进制目录，存放简单的命令字符目录</strong>    <strong>boot：启动目录，文件启动的内核目录</strong>    <strong>run：运行目录，程序运行所使用的目录</strong>    <strong>etc<strong><strong>：配置目录，程序配置所使用的目录，比如</strong></strong>网卡****之类的</strong>    <strong>dev****：设备目录，存放媒体设备之类文件的目录</strong>    <strong>home：家目录，普通用户存放文件的目录</strong>    <strong>root：超级权限管理目录，存放<strong><strong>超管</strong></strong>文件的目录</strong>   <strong>sbin：超级权限管理存放命令字符的目录</strong>   <strong>var：日志目录</strong>   <strong>usr：自定义目录，存储系统在local里</strong>   <strong>tmp：临时存放目录</strong></p>
<h2 id="文件管理命令："><a href="#文件管理命令：" class="headerlink" title="文件管理命令："></a><strong>文件管理命令：</strong></h2><p>​        ls：查看文件</p>
<p>​    pwd：显示当前所在目录</p>
<p>  touch：创建文件     如：#touch+空格+文件名.txt</p>
<p>  mkdir：创建目录     如：mkdir   文件夹名   也可以：#mkdir   -p(代表可选项)    文件夹名&#x2F;次级文                                     件夹名</p>
<p>​       cp：复制文件     如：cp    文件名.txt   文件目录  或 ：#cp    文件名.txt    文件目录&#x2F;次级文件目录</p>
<p>​      mv：移动文件    如：mv     文件名.txt     文件目录    或 ：#mv   文件名.txt    文件目录&#x2F;次级文件目录</p>
<p>​     rm：删除命令    加通配符rf可直接删除  如：#rm   -rf   文件名.txt&#x2F;目录</p>
<p>   history：查看历史命</p>
<h4 id="1-1-文本编辑："><a href="#1-1-文本编辑：" class="headerlink" title="1.1 文本编辑："></a>1.1 文本编辑：</h4><p>vi   vim：进入文本              # vi   文件名.txt</p>
<p>   cat：  查看全部文本内容    cat   -n：显示文本行号</p>
<p>   head：查看头部内容</p>
<p>  more：显示翻页内容</p>
<p>  fail：查看文本尾部内容   failf：锁定文本后10行</p>
<p>  grep：过滤关键字，快速查找关键字</p>
<p>​     i：文本编辑模式  </p>
<p>   Esc：退出文本编辑模式</p>
<p>  wq：保存编辑内容</p>
<p>  q！：强制退出并且不保存编辑内容</p>
<h4 id="1-2-光标定位："><a href="#1-2-光标定位：" class="headerlink" title="1.2 光标定位："></a>1.2 <strong>光标定位：</strong></h4><p>  H,J,K,L：光标左下上右方向移动</p>
<p>​      0，$：移动到行首，行尾</p>
<p>​    gg，G：移动到页首，页尾</p>
<p>（数字）G：跳转到这一行</p>
<p>​     &#x2F;（关键字）：查找字符，按N跳到下一个</p>
<p>yy：复制</p>
<p>dd：删除</p>
<p>p：粘贴</p>
<p>u：撤销</p>
<p>s：查找替换    #1,17(范围)   s&#x2F;原内容&#x2F;新内容&#x2F;g(全局)</p>
<p>w：另存为     #w   文件名</p>
<p>cd：改变自己当前所处目录位置    #cd   目录路径</p>
<p>cd~：回到原路径</p>
<p>  .&#x2F;：当前路径</p>
<p>..&#x2F;：返回上一级路径</p>
<p>ls  -l ：查看文件属性         如#ls   -l     &#x2F;dev&#x2F;sad</p>
<p>ls  -l  -d：查看目录本身属性</p>
<h2 id="用户基本信息文件："><a href="#用户基本信息文件：" class="headerlink" title="用户基本信息文件："></a>用户基本信息文件：</h2><p>root    :   x            :  0   :  0   :   root  :  &#x2F;root   :  &#x2F;bin&#x2F;bash</p>
<p>用户名  密码占位符  uid    gid     描述    家目录    命令解释器</p>
<h2 id="用户密码信息文件："><a href="#用户密码信息文件：" class="headerlink" title="用户密码信息文件："></a>用户密码信息文件：</h2><p> <strong>了解即可</strong>：（1）root:（2）$1$MYG2NDG6$a1wtyr5GDM2esAPjug0YP0:（3）15636:（4）0:（5）99999:（6）7:（7）:（8） :（9）</p>
<p>1）“登录名”是与&#x2F;etc&#x2F;passwd文件中的登录名相一致的用户账号</p>
<p>2）“口令”字段存放的是加密后的用户口令字，如果为空，则对应用户没有口令，登录时不需要口令；   </p>
<p>星号代表帐号被锁定；</p>
<p>双叹号表示这个密码已经过期了。</p>
<p>$$$$开头的，表明是用SHA-512加密的，</p>
<p>$$$$ 表明是用MD5加密的</p>
<p>$$$$ 是用Blowfish加密的</p>
<p>$$$$ 是用 SHA-256加密的。 </p>
<p>3）“最后一次修改时间”表示的是从某个时刻起，到用户最后一次修改口令时的天数。时间起点对不同的系统可能不一样。例如在SCOLinux中，这个时间起点是1970年1月1日。</p>
<p>4）“最小时间间隔”指的是两次修改口令之间所需的最小天数。</p>
<p>5）“最大时间间隔”指的是口令保持有效的最大天数。</p>
<p>6）“警告时间”字段表示的是从系统开始警告用户到用户密码正式失效之间的天数。</p>
<p>7）“不活动时间”表示的是用户没有登录活动但账号仍能保持有效的最大天数。（软限制。到期后多少天就不能用账号了。）</p>
<p>8）“失效时间”字段给出的是一个绝对的天数，如果使用了这个字段，那么就给出相应账号的生存期。期满后，该账号就不再是一个合法的账号，也就不能再用来登录了。（硬限制。）</p>
<ol>
<li>保留</li>
</ol>
<h2 id="用户-组管理："><a href="#用户-组管理：" class="headerlink" title="用户&#x2F;组管理："></a>用户&#x2F;组管理：</h2><p>cat     &#x2F;etc&#x2F;passwd  : 查看组文件信息</p>
<p>cat   &#x2F;etc&#x2F;shadow   : 查看密码组文件信息</p>
<p>id    : 查看用户id</p>
<p>useradd  :创建新用户   #useradd  -u   创建指定uid的新用户 ：useradd    用户名    -u    1230</p>
<p>passwd: 修改密码  </p>
<p>userdel   -r : 删除用户,带上-r表示依次删除</p>
<p>usermod  :  修改用户属性  # usermod   -u   1230   用户名</p>
<p>cat    &#x2F;etc&#x2F;group   查看组目录信息</p>
<p>groupadd ：创建一个新的组</p>
<p>groupdel  :删除组</p>
<p>usermod  -a(追加)G  ：追加用户到组目录   #usermod     -aG    目录组名   用户名</p>
<p>gpasswd  : 将用户踢出组目录     gpasswd    -d  用户名   目录组名</p>
<p>su  -   :   切换到另一个用户       su  -    用户名</p>
<h2 id="权限管理："><a href="#权限管理：" class="headerlink" title="权限管理："></a>权限管理：</h2><p>u:用户    g:组  o:其他人      r:读   w:写   x:执行</p>
<p>读取：r&#x3D;4     写入：w&#x3D;2      执行：x&#x3D;1</p>
<p>-rw-r–r–.   1   root root  179  5月  25  14:27  &#x2F;root&#x2F;1.txt</p>
<p>文件权限       属主  属组</p>
<p>chmod   ：修改文件的授权     chmod    u+x   文件&#x2F;目录  给用户在文件里加入执行权</p>
<p>chown   ：改变他的属主.属组       chown      属主.属组   文件&#x2F;目录  改变用户在文件&#x2F;目录的属主属组</p>
<p>chgrp      ：    chgrp  -R(递归)  属组   文件名   # chgrp -R it dir1     改文件属组</p>
<p>setfacl   ：设置用户在文件&#x2F;组的不同权限    #setfacl    -m(设置)    u(用户&#x2F;组)：alice(用户名)：rwx(权限)    1.txt文件对象   </p>
<p>getfacl   ：查看权限列表      getfacl    路径&#x2F;文件名</p>
<p>setfacl   -x  :删除用户的acl权限      #setfacl   -x    u:alice  删除用户alice的acl权限</p>
<p>setfacl  -b  ：清除额外组或用户的所用权限    #setfacl   -b   &#x2F;tmp&#x2F;1.txt   清除1.txt基本用户和基本属组外的所有额外权限</p>
<p>高级权限suid : #chmod   u+s  &#x2F;usr&#x2F;bin&#x2F;cat   修改用户的临时权限使他获得查看所有文件的权限</p>
<p>​                    修改    用户+提权  使用cat的权利   用完记得-s恢复成原来的权限</p>
<p>高级权限sgid ：#chmod   g+s  &#x2F;tmp&#x2F;file1    修改属组的临时权限使他里面新建的文件有和他一样的权限，让同属这一组的所用用户都有读写执行的权利</p>
<p>高级权限stick ：#chmod   o+t   &#x2F;tmp&#x2F;file1   针对目录设置，目录中的文件，只有属主能删除</p>
<p> chattr作用 ：用于锁定某个文件，拒绝修改</p>
<p>lsattr  ：查看文件的属性</p>
<p> chattr  +i  文件名     ：锁定文件，不允许修改，删除和重命名</p>
<p> umask  进程掩码   ： 新建文件，目录的默认权限受umask的影响，umask表示要间减掉的权限</p>
<p> umask掩码一般默认为0022，新建的目录默认为0777-0022&#x3D;755，新建的文件一般默认去掉执行权，默认为644权限</p>
<h2 id="进程管理："><a href="#进程管理：" class="headerlink" title="进程管理："></a>进程管理：</h2><p>Precess:进程   status:状态</p>
<p>ps  a:显示现行终端机下的所有程序    ps   u:  以用户为主的格式来显示程序的状况      ps    x: 不以终端机来区分</p>
<p>ps   aux   :   任务管理器</p>
<p>​    USER        PID %CPU %MEM    VSZ     RSS     TTY      STAT  START   TIME   COMMAND</p>
<p>​     root          1      0.0       0.6   128096   6708     ?          Ss      16:20      0:01      &#x2F;usr&#x2F;lib&#x2F;systemd&#x2F;systemd </p>
<p>USER  ：运行者身份</p>
<p>PID    ：进程编号</p>
<p>%CPU：CPU占用率</p>
<p>%MEN：内存占用率</p>
<p>VSZ   ：占用的虚拟内存</p>
<p>RSS   ：占用的实际内存</p>
<p>STAT ：进程的状态</p>
<p>START：进程的启动时间</p>
<p> TIME ：进程运行需要的时间</p>
<p> COMMAND：进程文件名</p>
<p>STAT：R运行   S睡眠   T停止    Z僵尸  X结束</p>
<p>Ps  - ef   查看进程的父子关系，ppid  </p>
<p>ps   axo ：自定义查看需要的信息    #ps  axo    user,pid,ppid,%mem,command | head -3 查看用户，pid,父子id,cpu占用率，进程名</p>
<p>top  -p  ：查看编号进程    top -p  5546</p>
<p>top  -d ：设置进程刷新时间</p>
<p>Kill   -数字 ：</p>
<p>（1）sighap :重启</p>
<p>（2）sigint  :立刻终止程序  ctrl+c</p>
<p>  (3)  sigquit :强制退出   ctrl+\</p>
<p>（9） sigkill :强制终止</p>
<p>（15） sigterm : 正常终止程序</p>
<p>（18） sigont：继续运行</p>
<p>（19） sigstop：停止运行</p>
<p>（20）sigtstp：键盘终止运行  clrt+z</p>
<p>nice  ：-20~19  数字越小，代表优先级越高  #ps  axo  pid,command,nice  –sort&#x3D;-nice 查看pid,进程名，nice值</p>
<p>nice  -n  ：nice  -n  -20~19  sleep  8888&amp;   设置睡觉程序的优先级，需要程序还没开始使用</p>
<p>renice  ：renice  -20~19  6163   修改正在使用的进程的优先级</p>
<p>Prority ：系统分配资源的砝码，在nice值上加上20</p>
<p>作业控制（jobs）了解 ：</p>
<p>foreground  : fg  :让后台运行的进程占领前台终端   fg   (后台进程编号)</p>
<p>Background ：bg ：让前台的进程进入后台运行     bg  (后台进程编号)</p>
<p> &amp;   ：后台运行程序</p>
<p> jobs  ：查看后台的进程</p>
<p> kill  %1  ：停止后台编号1的进程</p>
<p>虚拟文件系统 proc （了解）：</p>
<p>  采集服务器自身，内核，进程运行的状态信息</p>
<p>CPU ：&#x2F;proc&#x2F;cpuinfo : [root@localhost ~]# cat   &#x2F;proc&#x2F;cpuinfo cpu文件信息</p>
<p>内存：&#x2F;proc&#x2F;meminfo  ：[root@localhost ~]# less &#x2F;proc&#x2F;meminfo 内存文件信息</p>
<p>内核：&#x2F;proc&#x2F;cmdline ：[root@localhost ~]# cat &#x2F;proc&#x2F;cmdline   内核文件信息</p>
<h2 id="重定向管道："><a href="#重定向管道：" class="headerlink" title="重定向管道："></a>重定向管道：</h2><p>FD ：文件描述符，句柄</p>
<p>0  ：stdin ：标准输入</p>
<p>1  ：stdout ：标椎输出</p>
<p>2  ：stderr ：错误输出</p>
<p>3….  ：other files  ：其他文件</p>
<p> &gt;    ：date &gt; date.txt  将date里的内容输出到date.txt</p>
<p> 2&gt;  ：  ls  &#x2F;aaaaaaaaa 2&gt;  list.txt  输出错误的信息，2必须加上 </p>
<p> &gt;&gt;  :  1&gt;覆盖   &gt;&gt;追加</p>
<p> &lt;    ：mail  -s  “test01” u1 &lt; file1 将file1文本内容输入到用户u1邮件中</p>
<p> |     ：管道重定向  管道命令可以将多条命令组合起来，一次性完成复杂的处理任务。</p>
<p>如   ：# cat   &#x2F;etc&#x2F;passwd   |   tail -3   查看passwd中的尾部3行</p>
<p>tee管道  ： 三通管道，即交给另一个程序处理，又保存一份副本</p>
<p>如   ：#cat  &#x2F;etc&#x2F;passwd  | tee 88.txt | tail -3  查看passwd中的后3行的同时保存一份passwd全部名单在88.txt中</p>
<p>参数传递 Xargs  ： cp rm一些特殊命令就是不服其他程序，无法直接与管道一起直接使用需加转码</p>
<p>如   ：cat files.txt |xargs rm -rvf   按照files.txt中文本内容来删除文件</p>
<h2 id="磁盘管理："><a href="#磁盘管理：" class="headerlink" title="磁盘管理："></a>磁盘管理：</h2><p>lsblk   ：查看磁盘</p>
<p>fdisk  ：创建磁盘分区    #fdisk    &#x2F;dev&#x2F;sd*</p>
<p><strong>提示1</strong></p>
<p>​        [root@localhost ~]# fdisk &#x2F;dev&#x2F;sdb</p>
<p>欢迎使用 fdisk (util-linux 2.23.2)。</p>
<p>更改将停留在内存中，直到您决定将更改写入磁盘。</p>
<p>使用写入命令前请三思。</p>
<p>Device does not contain a recognized partition table</p>
<p>使用磁盘标识符 0xd43058cb 创建新的 DOS 磁盘标签。</p>
<p>命令(输入 m 获取帮助)：</p>
<p>​        操作</p>
<p>​                敲击字母“n”键</p>
<p>​                        新建分区</p>
<p>​        说明</p>
<p>​                欢迎界面，输入帮助指令或操作指令。</p>
<p><strong>提示2</strong></p>
<p>​        命令(输入 m 获取帮助)：n</p>
<p>Partition type:</p>
<p>   p   primary (0 primary, 0 extended, 4 free)</p>
<p>   e   extended</p>
<p>Select (default p):</p>
<p>​        操作</p>
<p>​                敲击字母“p”键</p>
<p>​        说明</p>
<p>​                请选择主分区，或扩展分区</p>
<p><strong>提示3</strong></p>
<p>​        Select (default p): p</p>
<p>分区号 (1-4，默认 1)：</p>
<p>​        操作</p>
<p>​                敲击数字“1”键</p>
<p>​        说明</p>
<p>​                选择分区号</p>
<p><strong>提示4</strong></p>
<p>​        分区号 (1-4，默认 1)：1</p>
<p>起始 扇区 (2048-10485759，默认为 2048)：</p>
<p>​        操作</p>
<p>​                敲击回车键</p>
<p>​        说明</p>
<p>​                选择磁盘开始的扇区</p>
<p><strong>提示5</strong></p>
<p>​        起始 扇区 (2048-10485759，默认为 2048)：</p>
<p>将使用默认值 2048</p>
<p>Last 扇区, +扇区 or +size{K,M,G} (2048-10485759，默认为 10485759)：</p>
<p>​        操作</p>
<p>​                输入分区大小“+2G” 后回车</p>
<p>​                实际环境根据磁盘划分，如4T磁盘，可以500G 一个分区。</p>
<p>​        说明</p>
<p>​                选择磁盘分区结束的扇区，即分区大小</p>
<p><strong>提示6</strong></p>
<p>​        Last 扇区, +扇区 or +size{K,M,G} (2048-10485759，默认为 10485759)：+2G</p>
<p>分区 1 已设置为 Linux 类型，大小设为 2 GiB</p>
<p>命令(输入 m 获取帮助)：</p>
<p>​        说明</p>
<p>​                已经完成 2G 大小分区记录。但未生效</p>
<p><strong>提示7</strong></p>
<p>​        命令(输入 m 获取帮助)：w</p>
<p>The partition table has been altered!</p>
<p>Calling ioctl() to re-read partition table.</p>
<p>正在同步磁盘。</p>
<p>[root@localhost ~]#</p>
<p>​        操作</p>
<p>​                输入w保存分区信息</p>
<p>​                自动退出分区工具</p>
<p> partprobe   ：刷新磁盘信息</p>
<p>mkfs.ext4   ：格式化，分出的磁盘空间都需要格式化   #mkfs.ext4   、dev&#x2F;sdb1</p>
<p> mount   ：挂载  # mount  -t  ext4  &#x2F;dev&#x2F;sdb1  &#x2F;mnt&#x2F;disk1</p>
<p> df  -hT  ：查看挂载信息</p>
<p>挂载重启失效的问题   可以进入# vim  &#x2F;root&#x2F;.bashrc  添加永久挂载命令</p>
<p>​            #mount  -t  ext4    dev&#x2F;sdb1   &#x2F;mnt&#x2F;disk1     重启后生效，不要影响文件原先的内容</p>
<p><strong>LVM  : 随意扩张大小</strong></p>
<p> pv    ：将物理磁盘转化为物理卷    #pvcreate   &#x2F;dev&#x2F;sdd  </p>
<p> vg    ：创建卷组VG     # vgcreate  vg1   &#x2F;dev&#x2F;sd*</p>
<p> lv     ：创建逻辑卷      #lvcreate   -L大小  -n卷名   vg1卷组名</p>
<p> lvextend ：扩大lv   # lvextend   -L+大小   &#x2F;dev&#x2F;vg1(卷组名)&#x2F;lv1(逻辑卷名)</p>
<p> vgextend：扩大卷组空间  #vgextend  vg1   &#x2F;dev&#x2F;sd*</p>
<p> resize  ：刷新    # resize2fs   &#x2F;dev&#x2F;vg1(卷组名)&#x2F;lv1(逻辑卷名)</p>
<p>PE ：物理块   1pe块等于4M</p>
<p>ctrl+r ：搜索使用过的命令</p>
<p> <strong>swap：交换分区管理</strong></p>
<p>作用：提升’ 内存的容量，防止OOM（Out Of Memory）</p>
<p>推荐设置交换分区大小为内存的2倍</p>
<p>查看当前交换分区 ：# free  -m</p>
<p>增加交换分区：</p>
<p>​            # fdisk  &#x2F;dev&#x2F;sd*    创建分区</p>
<p>​           #partprobe   &#x2F;dev&#x2F;sdf       刷新磁盘</p>
<p>​          #mkswap   &#x2F;dev&#x2F;sdf1     格式化</p>
<p>​         #wapson   &#x2F;dev&#x2F;sdf1      挂载</p>
<p>4.验证</p>
<p>​        查看增加后的交换分区。是不是变大了？</p>
<p>​        [root@localhost ~]# free -m</p>
<p>​       #waspoff   &#x2F;dev&#x2F;sdf1    减少交换分区</p>
<p>​       #partprobe   &#x2F;dev&#x2F;sdf     记得刷新</p>
<p>​         </p>
<h2 id="文件系统："><a href="#文件系统：" class="headerlink" title="文件系统："></a>文件系统：</h2><p>\1. <a target="_blank" rel="noopener" href="https://so.csdn.net/so/search?q=EXT4&spm=1001.2101.3001.7020">EXT4</a></p>
<p>EXT4是最为常用，最早和稳定的Linux文件系统之一，它是EXT3文件系统的升级版。采用了更高效的方式组织磁盘空间，支持更大的分区和更高的性能</p>
<p>\2. XFS</p>
<p>XFS是另一个高性能、日志式Linux文件系统。它适合大容量存储设备，并提供了较高的数据可靠性、灵活性和可扩展性</p>
<p>3.ZFS</p>
<p>ZFS是一个基于（搜来儿死）Solaris开发的先进文件系统，也可以在Linux上使用。ZFS被认为是一种不可变式存储方式，它可以保证任何时间点数据都不会发生变化</p>
<p>4.F2FS</p>
<p>F2FS是一个专为闪存设备（如eMMC、SSD等）设计的文件系统，特别适合在移动设备、嵌入式系统等场景下使用，拥有快速的固态硬盘读写能力、高效的垃圾回收机制和较少的写入延迟</p>
<p>5.VFAT</p>
<p>(Virtual File Allocation Table) 是一种通用的文件系统，主要用于在不同操作系统之间共享文件。它支持多语言字符集和长文件名。VFAT可以被Linux、Windows和其他操作系统所支持</p>
<p> df  -i ：查看索引节点</p>
<p> inode ：索引节点决定了文件系统中的数量</p>
<p> block ：kb决定了文件的储存空间</p>
<p> superblock ：block和inode的总量，未使用与已使用block&#x2F;inode数量</p>
<p>Block group ：块组</p>
<h4 id="1-1-文件链接"><a href="#1-1-文件链接" class="headerlink" title="1.1 文件链接"></a>1.1 文件链接</h4><p>一.<strong>软连接</strong></p>
<p>示例：</p>
<p>​        1 创建一个文件，并输入内容。</p>
<p>​                [root@localhost ~]# echo 111 &gt; &#x2F;file1</p>
<p>​        2 创建一个软连接。</p>
<p>​                [root@localhost ~]# ln -s &#x2F;file1 &#x2F;home&#x2F;file11</p>
<p>​                -s  软连接</p>
<p>​        3 观察软连接</p>
<p>​                [root@localhost ~]# ll &#x2F;home&#x2F;file11</p>
<p>​                lrwxrwxrwx 1 root root 6 Dec 20 17:58 &#x2F;home&#x2F;file11 -&gt; &#x2F;file1</p>
<p>​        4 观察软连接文件</p>
<p>​                [root@localhost ~]# ll  &#x2F;file1 &#x2F;home&#x2F;file11</p>
<p>​                -rw-r–r– 1 root root 4 Dec 20 17:57 &#x2F;file1</p>
<p>​                lrwxrwxrwx 1 root root 6 Dec 20 17:58 &#x2F;home&#x2F;file11 -&gt; &#x2F;file1</p>
<p>​        5 查看两个文件，内容一致。</p>
<p>​                [root@localhost ~]# cat &#x2F;file1</p>
<p>​                111</p>
<p>​                [root@localhost ~]# cat &#x2F;home&#x2F;file11</p>
<p>​                111</p>
<p>​        6 删除源文件，软连接闪烁，不可用。</p>
<p>​                [root@localhost ~]# rm -rf &#x2F;file1</p>
<p>​                [root@localhost ~]# ll &#x2F;home&#x2F;file11</p>
<p>​                lrwxrwxrwx 1 root root 6 Dec 20 17:58 &#x2F;home&#x2F;file11 -&gt; &#x2F;file1</p>
<p>总结</p>
<p>​        软连接像快捷方式，可以对文件和目录做软连接。</p>
<p>​        软连接记录的只是源文件的路径。</p>
<p>​        软连接失去源文件不可用。</p>
<p>二、硬链接</p>
<p>​        1 创建同分区硬链接成功，创建不同分区硬链接失败。</p>
<p>​                [root@localhost ~]# echo 222 &gt; &#x2F;file2</p>
<p>​                [root@localhost ~]# ln &#x2F;file2 &#x2F;file2-h1</p>
<p>​                [root@localhost ~]# ln &#x2F;file2 &#x2F;home&#x2F;file2-h2                </p>
<p>​                &#x2F;&#x2F;将文件已硬链接方式，发送到其他分区。结果是？错误</p>
<p>​                ln: failed to create hard link ‘&#x2F;home&#x2F;file2-h2’ &#x3D;&gt; ‘&#x2F;file2’: Invalid cross-device link</p>
<p>​        2 硬链接删除源文件，依然可以用</p>
<p>​                [root@localhost ~]#rm -rf &#x2F;file2</p>
<p>​                [root@localhost ~]#cat    &#x2F;file2-h1</p>
<p>​                222</p>
<p>​        3 不允许将硬链接指向目录</p>
<p>​                [root@qianfeng home]# ln &#x2F;home&#x2F; &#x2F;mnt</p>
<p>​                ln: “&#x2F;home&#x2F;”: 不允许将硬链接指向目录</p>
<p>​        总结</p>
<p>​                硬链接只能针对文件做。不能对目录做。</p>
<p>​                硬链接只能在同分区做。</p>
<h4 id="1-2-RAID-了解"><a href="#1-2-RAID-了解" class="headerlink" title="1.2 RAID(了解)"></a>1.2 <strong>RAID(了解)</strong></h4><p>​        简介</p>
<p>​                RAID：廉价磁盘冗余阵列（Redundant Array of Independent Disks）</p>
<p>​                作 用：容错、提升读写速率</p>
<p>​        类型</p>
<p>​                RAID0</p>
<p>​                                RAID0 条带集 2块磁盘以上， 读写速率快 100%*N，但不容错</p>
<p>​                RAID1</p>
<p>​                                RAID1 镜像集 2块磁盘， 容量50% ，读写速率一般，容错</p>
<p>​                RAID5</p>
<p>​                                RAID5 带奇偶校验条带集 3块磁盘以上，</p>
<p>​         利用率 (n-1）&#x2F;n 读写速率快，容错</p>
<p>​        一、不同场景RAID的使用</p>
<p>​                硬RAID： 需要RAID卡，有自己的CPU，处理速度快，有电池和无电池。</p>
<p>​                软RAID： 通过操作系统实现，比如Windows、Linux</p>
<p><strong>二、软RAID示例</strong></p>
<p>\1. 准备4块硬盘</p>
<p>​                        [root@localhost ~]# ll &#x2F;dev&#x2F;sd*</p>
<p>​                                brw-rw—- 1 root disk 8, 48 Jan 13 16:07 &#x2F;dev&#x2F;sdd</p>
<p>brw-rw—- 1 root disk 8, 64 Jan 13 16:07 &#x2F;dev&#x2F;sde</p>
<p>brw-rw—- 1 root disk 8, 80 Jan 13 16:07 &#x2F;dev&#x2F;sdf</p>
<p>brw-rw—- 1 root disk 8, 80 Jan 13 16:07 &#x2F;dev&#x2F;sdg</p>
<p>​                        RAID5 :(3块数据盘) + （1块热备硬盘)</p>
<p>\2. 创建RAID</p>
<p>​                        [root@localhost ~]# mdadm -C &#x2F;dev&#x2F;md0 -l5 -n3 -x1 &#x2F;dev&#x2F;sd{d,e,f,g}</p>
<p>​                                -C 创建RAID</p>
<p>&#x2F;dev&#x2F;md0 第一个RAID设备</p>
<p>-l5 RAID5</p>
<p>-n RAID成员的数量</p>
<p>-x 热备磁盘的数量</p>
<p>可用空间2G</p>
<p>​                                [root@localhost ~]# yum -y install mdadm &#x2F;&#x2F;确保mdadm命令可用</p>
<p>\3. 格式化，挂载</p>
<p>​                        [root@localhost ~]# mkfs.ext4 &#x2F;dev&#x2F;md0</p>
<p>[root@localhost ~]# mkdir &#x2F;mnt&#x2F;raid5</p>
<p>[root@localhost ~]# mount &#x2F;dev&#x2F;md0 &#x2F;mnt&#x2F;raid5</p>
<p>[root@localhost ~]# cp -rf &#x2F;etc &#x2F;mnt&#x2F;raid5&#x2F;etc1</p>
<p>\4. 查看RAID信息</p>
<p>​                        [root@localhost ~]# mdadm -D &#x2F;dev&#x2F;md0 &#x2F;&#x2F;-D 查看详细信息</p>
<p>​                                &#x2F;dev&#x2F;md0:</p>
<p>Version : 1.2</p>
<p>Creation Time : Mon Jan 13 16:28:47 2016</p>
<p>Raid Level : raid5                &#x2F;&#x2F;raid类型</p>
<p>Array Size : 2095104 (2046.34 MiB 2145.39 MB)</p>
<p>Used Dev Size : 1047552 (1023.17 MiB 1072.69 MB)</p>
<p>Raid Devices : 3                &#x2F;&#x2F;组中设备的数量</p>
<p>Total Devices : 4        &#x2F;&#x2F;总设备数</p>
<p>Persistence : Superblock is persistent</p>
<p>Update Time : Mon Jan 13 16:34:51 2016</p>
<p>State : clean         &#x2F;&#x2F;状态，卫生的，哈哈</p>
<p>Active Devices : 3        &#x2F;&#x2F;活跃3个</p>
<p>Working Devices : 4  &#x2F;&#x2F;4个在工作</p>
<p>Failed Devices : 0                &#x2F;&#x2F;坏了1就危险了，2个就完蛋了</p>
<p>Spare Devices : 1                &#x2F;&#x2F;热备的1个。</p>
<p>Layout : left-symmetric</p>
<p>Chunk Size : 512K        &#x2F;&#x2F;校验码大小</p>
<p>Number Major Minor RaidDevice State</p>
<p>0 8 48 0 active sync &#x2F;dev&#x2F;sdd                &#x2F;&#x2F;同步</p>
<p>1 8 64 1 active sync &#x2F;dev&#x2F;sde                &#x2F;&#x2F;同步</p>
<p>4 8 80 2 active sync &#x2F;dev&#x2F;sdf                        &#x2F;&#x2F;同步</p>
<p>3 8 96 - spare &#x2F;dev&#x2F;sdg</p>
<p>​                \5. 模拟一块硬盘损坏，并移除</p>
<p>​                        \5. 模拟一块硬盘损坏，并移除</p>
<p>终端一：</p>
<p>[root@localhost ~]# watch -n 0.5 ‘mdadm -D &#x2F;dev&#x2F;md0 | tail’ &#x2F;&#x2F;watch持续查看</p>
<p>终端二：</p>
<p>[root@localhost ~]# mdadm &#x2F;dev&#x2F;md0 -f &#x2F;dev&#x2F;sde -r &#x2F;dev&#x2F;sde </p>
<p>&#x2F;&#x2F;模拟坏了并移除</p>
<p> -f –fail</p>
<p> -r –remove</p>
<h2 id="文件查找和打包及压缩："><a href="#文件查找和打包及压缩：" class="headerlink" title="文件查找和打包及压缩："></a>文件查找和打包及压缩：</h2><p>which  ：命令查找    #which  ls    查找ls命令的位置</p>
<p>whereis  : 查找     #whereis  vim   查找所有带vim的位置</p>
<p> locate  : 查找文件 #locate  hosts  查找hotst文件 新建的无法查找需更新数据库</p>
<p> updatedb ：更新locate数据库</p>
<p> find   ：find   [path…]    [options]   [expression]    [action]</p>
<p>​            命令   路径           选项         表达式           动作</p>
<p>  <strong>按文件名：</strong></p>
<p># find  &#x2F;etc   -name    “hosts”    寻找&#x2F;etc下名字叫hosts的文件  </p>
<p>​            #find &#x2F;etc&#x2F;  -iname   “hosts”     i代表可以忽略大小写</p>
<p><strong>按文件大小：</strong></p>
<p>​           #find   &#x2F;etc  -size     (+,-)5M     寻找&#x2F;etc下文件大小为（大于，小于）5兆的文件</p>
<p><strong>指定查找的目录深度</strong></p>
<p>​          #find  &#x2F;  -maxdepth  4  -a   -name  “ifcfg-en*”  寻找根下4级目录内和名字叫ifcfg-en的所有文件</p>
<p><strong>按文件的属主，属组查找</strong></p>
<p>​         #find    &#x2F;home    -user   jack     查找属主是杰克的文件</p>
<p>​        #find    &#x2F;home    -group  jack     查找属组是杰克的文件</p>
<p><strong>按文件类型查找</strong></p>
<p>​        #find   &#x2F;tmp  -type   f      查找文件类型为普通文件的文件</p>
<p>​          f  普通文件   d 目录文件  b 块设备文件  p 管道文件  l 链接文件</p>
<p><strong>按文件权限查找</strong>  </p>
<p>​         #find   .&#x2F;   -perm    644   查找当前目录下权限为644的文件</p>
<p><strong>找到后的处理动作</strong></p>
<p>找到后默认是显示文件</p>
<p>​        [root@localhost ~]# find . -perm  715  -print  文件名</p>
<p>​        [root@localhost ~]# find . -perm  715  -l  文件属性</p>
<p>找到后删除</p>
<p>​        [root@localhost ~]# find &#x2F;etc -name “775*” -delete</p>
<p>找到后复制</p>
<p>[root@localhost ~]# find     &#x2F;etc     -name       “ifcfg*”      -ok     cp     -rvf   {}    &#x2F;tmp    ;</p>
<p>​                           找到&#x2F;etc下名字叫ifcfg的所有文件并复制到&#x2F;tmp目录中</p>
<p> tar  -cf  : 打包文件  #tar  -cf    tar.var     &#x2F;etc    将&#x2F;etc文件夹打包压缩成tar.var</p>
<p> tar   -czvf       etc-gzip.tar.gz         &#x2F;etc&#x2F;  &#x2F;&#x2F;z是gzip</p>
<p> tar   -cjf       etc-bzip.tar.bz        &#x2F;etc&#x2F;  &#x2F;&#x2F;j是bzip</p>
<p> tar   -cJf         etc-xzip.tar.xz        &#x2F;etc&#x2F;    &#x2F;&#x2F;J是xzip</p>
<p> tar  -xf ：解压文件  #tar  -xf    tar.var  -c(指定地方)    &#x2F;tmp   将tar.var解压到&#x2F;tmp文件夹中，不加-c就解压到当前目录中</p>
<h2 id="软件管理："><a href="#软件管理：" class="headerlink" title="软件管理："></a>软件管理：</h2><p> <strong>yum</strong> :基于RPM包管理，能够从指定的服务器自动下载RPM包并且安装，可以自动处理依赖性关系，并且一次安装所有依赖的软件包，无须繁琐地一次次下载、安装。</p>
<p><strong>1.本地源：系统安装光盘</strong></p>
<p>​        目的</p>
<p>​                通过系统光盘获得软件包，并安装软件</p>
<p>​        0.观察YUM核心配置目录</p>
<p>​                记住这个目录&#x2F;etc&#x2F;yum.repos.d&#x2F;</p>
<p>​                打开一个*.repo</p>
<p>​                观察国外地址（下载速度慢）</p>
<p>​                yum install -y wget</p>
<p>​                        没有任何修改，即可安装软件。YUM默认是配置好的。</p>
<p>​        1 备份移除官方YUM库</p>
<p>​                [root@localhost ~]#mv   &#x2F;etc&#x2F;yum.repos.d&#x2F;*     &#x2F;tmp</p>
<p>​        2编写本地YUM库配置文件</p>
<p>​                [root@localhost ~]# vim &#x2F;etc&#x2F;yum.repos.d&#x2F;dvd.repo </p>
<p>[dvd] </p>
<p>name&#x3D;dvd </p>
<p>baseurl&#x3D;file:&#x2F;&#x2F;&#x2F;mnt&#x2F;cdrom</p>
<p>gpgcheck&#x3D;0</p>
<p>​                注释</p>
<p>​                        &#x2F;etc&#x2F;yum.repos.d&#x2F;是YUM下载地址库目录</p>
<p>​                        [dvd]某一个库的名称，中括号[]是必须的</p>
<p>​                        name&#x3D;dvd是库的说明，name是必须的</p>
<p>​                        baseurl&#x3D;file:&#x2F;&#x2F;&#x2F;mnt&#x2F;cdrom下载库的具体地址.重要</p>
<p>​                        gpgcheck&#x3D;0是关闭校验</p>
<p>​                        老铁多检查检查，很容易打错字</p>
<p>​        3 挂载安装光盘：</p>
<p>​                老铁千万记得要把光盘放到服务器上，通电</p>
<p>​                [root@localhost ~]# mkdir  &#x2F;mnt&#x2F;cdrom</p>
<p>​                [root@localhost ~]# mount &#x2F;dev&#x2F;cdrom  &#x2F;mnt&#x2F;cdrom&#x2F;</p>
<p>​                        手动挂载光驱</p>
<p>​                重启后，使用ls  &#x2F;mnt&#x2F;cdrom,查看到光盘信息即可</p>
<p>​                        [root@localhost ~]# ls &#x2F;mnt&#x2F;cdrom&#x2F;</p>
<p>​                        CentOS_BuildTag  GPL       LiveOS    RPM-GPG-KEY-CentOS-7</p>
<p>​                        EFI              images    Packages  RPM-GPG-KEY-CentOS-Testing-7</p>
<p>​                        EULA             isolinux  repodata  TRANS.TBL</p>
<p>​        4 使用YUM 安装和卸载程序</p>
<p>​                [root@localhost ~]#yum install -y httpd</p>
<p>​                        安装软件</p>
<p>​                [root@localhost ~]#systemctl start httpd</p>
<p>​                        启动软件</p>
<p>​        5.模拟客户机访问</p>
<p>​                打开浏览器，输入网站服务器的IP地址。<a target="_blank" rel="noopener" href="http://127.0.0.1,验证网站程序部署成功./">http://127.0.0.1，验证网站程序部署成功。</a></p>
<p>​        6.观察仓库信息</p>
<p>​                [root@localhost ~]# yum repolist</p>
<p>​                        已加载插件：fastestmirror, langpacks</p>
<p>Loading mirror speeds from cached hostfile</p>
<p>源标识                                  源名称                                   状态</p>
<p>dvd                                      dvd                                      4,067</p>
<p>repolist: 4,067       说明我们使用的是本地光驱中 的软件包</p>
<p>  <strong>前提是需要联网</strong></p>
<p><strong>Base&#x2F;Extras&#x2F;Updates: 默认(国外源)</strong></p>
<p>1.<strong>首先清理原先YUM库</strong></p>
<p><strong>yum  install   wget  安装wget</strong></p>
<p><strong>mv     &#x2F;etc&#x2F;yum.repos.d&#x2F;*    &#x2F;tmp</strong></p>
<p><strong>2 下载阿里源至yum库</strong></p>
<p><strong>wget</strong>  <strong><a target="_blank" rel="noopener" href="http://mirrors.aliyun.com/repo/Centos-7.repo">http://mirrors.aliyun.com/repo/Centos-7.repo</a></strong>  <strong>-O &#x2F;etc&#x2F;yum.repos.d&#x2F;CentOS-Base.repo</strong> </p>
<p><strong>3 更新YUM源</strong></p>
<p><strong>yum  repolist   列出安装表</strong></p>
<p><strong>yum makecache   刷新</strong></p>
<p>E<strong>PEL (Extra Packages for Enterprise Linux,企业版Linux的额外软件包)</strong> </p>
<p><strong>下载epel配置文件 ： wget -O &#x2F;etc&#x2F;yum.repos.d&#x2F;epel.repo</strong> <strong><a target="_blank" rel="noopener" href="http://mirrors.aliyun.com/repo/epel-7.repo">http://mirrors.aliyun.com/repo/epel-7.repo</a></strong></p>
<p>**重建缓存  ：[root@**<strong>localhost</strong> <strong>~]# yum  makecache</strong></p>
<p>  yum   install -y  : 安装软件     #yum  -y   install   httpd   vsftpd</p>
<p>yum 主命令  </p>
<p>  -y  自动确认</p>
<p>install 安装</p>
<p>httpd 软件包1</p>
<p>vsftpd 软件包2</p>
<p>yum -y    reinstall  ：重新安装  # yum    -y     reinstall     httpd</p>
<p>yum  -y    update  ：升级安装   ： 升级一个程序</p>
<p>yum    repolist  ：查询yum源</p>
<p>Yum   list ：查询程序，带@符号的是已安装  #yum  list  httpd    查询http程序</p>
<p> yum  -y   remove  ：卸载移除软件包</p>
<p><strong>rpm:</strong></p>
<p>升级一个程序htt1.管理红帽系统&#x2F;centos系统，rpm包的基本工具</p>
<p>2.YUM功能相同</p>
<p>3.优点不需要配置，直接使用</p>
<p>4.无法解决依赖关系</p>
<p>5.无法自行下载软件包</p>
<p> 先找到安装包</p>
<p> mkdir   &#x2F;mnt&#x2F;cdrom</p>
<p> mount   &#x2F;dev&#x2F;cdrom    &#x2F;mnt&#x2F;cdrom挂载光驱</p>
<p> rpm  -ivh  : 安装软件   # rpm -ivh wget-1.14-18.el7.x86_64.rpm   安装wget-1.14-18.el7.x86_64.rpm</p>
<p>  i  ：安装</p>
<p>  v ：可视</p>
<p>  h：百分比</p>
<p>  rpm  -q  ：查询</p>
<p>  rpm  -e : 移除，卸载</p>
<h2 id="计划任务："><a href="#计划任务：" class="headerlink" title="计划任务："></a>计划任务：</h2><p>  at   ：一次性执行计划  at  now  +1min  一分钟后执行，回车进去写要执行的指令</p>
<p>​    at&gt; useradd uuuu </p>
<p>   at&gt; <EOT>   ctrl+d  保存，提交任务</p>
<p>  atq ：查询任务</p>
<p> cron ：cron的概念和crontab是不可分割的。</p>
<p> crontab是一个命令，常见于Unix和Linux的操作系统之中</p>
<p> 用于设置周期性被执行的指令</p>
<p>  crontab  -e ：创建计划</p>
<p>  crontab  -l  :  查看计划任务</p>
<p>  crontab  -r : 删除计划任务</p>
<p> #crontab -e</p>
<p>​         输入以下内容</p>
<p>​         *  *  *   *   *    &#x2F;root&#x2F;1.sh</p>
<p>​       时 ，分，日 ，月，周   创建一个具体时间执行root下的1.sh </p>
<h2 id="日志管理："><a href="#日志管理：" class="headerlink" title="日志管理："></a>日志管理：</h2><p>  rsyslog  ：系统日志系统</p>
<p>  logrotate  :日志轮转</p>
<p> 常见的日志文件：</p>
<p>  tailf   &#x2F;var&#x2F;log&#x2F;messages&#x2F;  查看全部日志文件</p>
<p>  tailf   &#x2F;var&#x2F;log&#x2F;srcure&#x2F;      认证，安全   </p>
<p>  tailf    &#x2F;var&#x2F;log&#x2F;yum.log     yum  软件</p>
<p>  tailf     &#x2F;var&#x2F;log&#x2F;maillog      邮件日志</p>
<p>  tailf     &#x2F;var&#x2F;log&#x2F;cron         计划任务日志</p>
<p>  tailf    &#x2F;var&#x2F;log&#x2F;demsg        和系统相关</p>
<p>  tailf     &#x2F;var&#x2F;log&#x2F;wtmp        当前登录用户</p>
<p> 设备类型：</p>
<p> LOG_SYSLOG        syslog自身产生的日志</p>
<p> LOG_AUTHPRN        安全认证</p>
<p> LOG_CRON             调度程序</p>
<p> LOG_MAIL                邮件系统</p>
<p> LOG_USER              用户相关</p>
<p> LOG_DAEMON          后台进程</p>
<p> LOG_FTP                文件</p>
<p> LOG_KERN             内核设备</p>
<p> LOG_LPR                打印机设备</p>
<p> LOG_LOCALO  through  LOG_LOCAL7   用户自定义设备</p>
<p> level级别：从低到高</p>
<p> LOG_EMERC      紧急，致命，服务无法继续运行</p>
<p> LOG_ALERT        报警，需要立即处理，如磁盘空间占用95%</p>
<p> LOG_CRIT          致命行为</p>
<p> LOG_ERR           错误行为</p>
<p> LOG_WARNING    警告信息</p>
<p> LOG_NOTICE      普通，重要的标椎信息</p>
<p> LOG_INFO          标椎信息</p>
<p> LOG_DEBUG       调试信息，排错所需，一般不建议用</p>
<p> 修改ssh程序的设备类型：</p>
<p>​    # vim   &#x2F;etc&#x2F;ssh&#x2F;sshd_config</p>
<p>   #SyslogFacillaty  AUTHPRIV</p>
<p>​    SyslogFacility LOCAL5</p>
<p> 修改rsyslog程序的规则:</p>
<p>   #vim  &#x2F;etc&#x2F;rsyslog.conf</p>
<p>   在rulus下空白的地方加上</p>
<p>  local5.*    &#x2F;var&#x2F;log&#x2F;serverzz</p>
<p> 重启rsyslog程序和ssh程序</p>
<p>  systemctl  restart   rsyslog.service  sshd  </p>
<h2 id="网络管理1："><a href="#网络管理1：" class="headerlink" title="网络管理1："></a>网络管理1：</h2><p>  network    interface</p>
<p>  网络          接口</p>
<p>   systemctl   status   NetworkManager</p>
<p>   查看网络管理程序的状态</p>
<p>   systemctl  status   network</p>
<p>   查看网络子管理程序的状态</p>
<p>   vim  &#x2F;etc&#x2F;sysconfig&#x2F;network-scripts&#x2F;ifcfg-ens33</p>
<p>​       配置网卡参数， 如果没有这个命令可以安装</p>
<p>​    yum install  -y  NetworkManager</p>
<p> 图形配置 ：umtui    简易图形</p>
<p> 先备份网卡配置文件再修改：</p>
<p>​    cp    &#x2F;etc&#x2F;sysconfig&#x2F;network-scripts&#x2F;ifcfg-ens33   .&#x2F;</p>
<p> 记得查看本机的自动获取IP截图</p>
<p>  vim   &#x2F;etc&#x2F;sysconfig&#x2F;network-scripts&#x2F;ifcfg-ens33：</p>
<p>  修改这个文件需谨慎</p>
<p> ONBOOT&#x3D;yes    是否启用该网络</p>
<p> BOOTPROTO&#x3D;none    手动（none&#x2F;static）或者自动获取ip(dhcp)</p>
<p> IPADDR&#x3D;192.168.XXX.XXX      根据自动获取的IP地址进行配置</p>
<p> NETMASK&#x3D;255.255.255.0        子网掩码</p>
<p> GATEWAY&#x3D;192.168.XXX.X        网关，也叫默认路由器地址</p>
<p> DNS1&#x3D;192.168.XXX.X               域名解析，dns后面的数字不要忘记打了</p>
<p> 重启网络服务：systemctl    restart  network</p>
<p> 修改主机名：</p>
<p> （1）改名方式1：查看主机名：hostname</p>
<p>​                          配置主机名：hostnamectl   set-hostname    名字.com</p>
<p>​                          退出shell即可生效</p>
<p>  (2)  改名方式2：查看和配置主机名：cat    &#x2F;etc&#x2F;hostname</p>
<p>​                                                      vim   &#x2F;etc&#x2F;hostname</p>
<p>​                               要重启才会生效：reboot  或  init6</p>
<p>   iP    a    ：查看所有</p>
<p>   ip   route   ：查看路由，查看网关</p>
<p>   ip   neigh  ： 另一台主机的ping通，查看邻居</p>
<p>   ping  127.0.0.1   </p>
<p> 查看端口 ：</p>
<p> 端口号是一段数字：0~65536之间</p>
<p> 每一个服务程序对应一到多个数字</p>
<p> 通过检查端口号，确认服务是否提供</p>
<p>  ss    -tnl   查看端口号</p>
<p>  ss   -tna   查看端口号</p>
<p> 初始化服务器：</p>
<p> （1）最小化安装</p>
<p> （2）为服务器配置root密码</p>
<p> （3）配置ip(NAT)地址自动获取</p>
<p>​         vim   &#x2F;etc&#x2F;sysconfig&#x2F;network-scripts&#x2F;ifcfg-ens33</p>
<p>​         ONBOOT&#x3D;yes    BOOTPROTO&#x3D;dhcp</p>
<p> （4）配置yum源</p>
<p>​         yum   install  -y   wget</p>
<p>​         mv     &#x2F;etc&#x2F;yum.repos.d&#x2F;*   &#x2F;tmp</p>
<p>​       安装阿里源到yum库</p>
<p>​        更新yum源库</p>
<p>​        yum  repolist</p>
<p>​       刷新缓存</p>
<p>​       yum   makecache</p>
<p>​    安装epel到yum库</p>
<p>​     刷新缓存</p>
<p>​    yum  makecache</p>
<p> （5）关防火墙</p>
<p>​                      停止防火墙   systemctl    stop   firewalld</p>
<p>​                开机禁用防火墙    systemctl   disable  firewalld</p>
<p>​                查看防火墙状态     systemctl  status   firewalld</p>
<p> （6）selinux                                     enforcing    开启</p>
<p>​                   查看selinux：getenforce{ premissive   开启放行</p>
<p>​                                                        disable        禁用  </p>
<p>​                   临时关闭 ：setenforce   0     数字0关闭 ，1开启</p>
<p>​                   永久关闭：vi    &#x2F;etc&#x2F;sysconfig&#x2F;selinux</p>
<p>​                                   SELINUX&#x3D;disabled</p>
<p> （7）安装常用程序</p>
<p>​                           yum  install  -y   lrzsz               sysstat          enlinux         wget            net-tools       </p>
<p>​                                                 上传下载工具    系统状态     字符浏览器     下载工具        网络工具</p>
<p>​                                                  bash-completion          vim</p>
<p>​                                                    自动补全                  编辑</p>
<p> （8）快照关机</p>
<p> OSI   开放式系统互联模型</p>
<p> ISO   国际标准化组织</p>
<p> OSI 7层结构，功能：</p>
<p> 应用层：应用程序&#x2F;原始数据</p>
<p> 表示层：格式&#x2F;加密&#x2F;压缩</p>
<p> 会话层：会话&#x2F;全双工&#x2F;半双工</p>
<p> 传输层：分段&#x2F;重组&#x2F;端口号</p>
<p> 网络层：IP地址&#x2F;寻址&#x2F;路由</p>
<p> 数据链路层：MAC地址&#x2F;局域网</p>
<p> 物理层：传输介质&#x2F;比特流</p>
<p> TCP&#x2F;IP ：Transmission Control Protocol&#x2F;Internet  protocol&#x2F;传输控制协议&#x2F;网际协议   </p>
<p> 5层模型协议分类：</p>
<p> 应用层：</p>
<p> HTTP&#x2F;超文本传输协议&#x2F;网站</p>
<p> SSH&#x2F;远程连接协议&#x2F;远程控制</p>
<p> FTP&#x2F;文件传输协议</p>
<p> SMTP&#x2F;简单邮件传输协议&#x2F;email</p>
<p> DNS&#x2F;域名服务&#x2F;www</p>
<p> 传输层：</p>
<p> TCP&#x2F;传输控制协议&#x2F;可靠</p>
<p> UDP&#x2F;用户数据报协议&#x2F;不可靠</p>
<p> 网络层：</p>
<p> IP&#x2F;互联网协议&#x2F;寻址</p>
<p> ICMP&#x2F;网络消息管理协议&#x2F;测试</p>
<p> 数据链路层：</p>
<p> MAC地址&#x2F;家到邮局的地址</p>
<p> 物理层：</p>
<p> 网线&#x2F;光纤</p>
<p> 二进制和十进制互转：</p>
<p> 128   64     32    16     8      4     2      1</p>
<p> 1     1       1     1     1      1      1     1</p>
<p> 位权加减法</p>
<p> 十进制转换成2进制</p>
<p> 方法：</p>
<p> 1  请将8位2进制，每个位置的位权写出来。</p>
<p> 2  通过加减法，在2进制位权中取得相应数字。 不足的位置用0填充。</p>
<p> 示例：</p>
<p> 129&#x3D;1000 0001</p>
<p> 192&#x3D;1100 0000</p>
<p> 130&#x3D;1000 0010</p>
<p> 67&#x3D;0100 0011</p>
<p> 33&#x3D;0010 0001</p>
<p> 二进制转十进制</p>
<p> 示例：</p>
<p> 1010 1010&#x3D;170</p>
<p> 1111 1110&#x3D;254</p>
<h2 id="网络管理2："><a href="#网络管理2：" class="headerlink" title="网络管理2："></a>网络管理2：</h2><h4 id="1-1-物理层"><a href="#1-1-物理层" class="headerlink" title="1.1 物理层"></a>1.1 <strong>物理层</strong></h4><p> 网线：双绞线：</p>
<p> 屏蔽型：</p>
<p><img src="https://hqrchvz3h42.feishu.cn/space/api/box/stream/download/asynccode/?code=MTEzMWQxNmQxYjZiNTIxZGE0MTcyNTE1MjY4MTc5MWNfRlF0dFAyZTlxQzdkc1V5NDZ6ZEVIZ09yNHQ1WXl5ajFfVG9rZW46VFVQeGJvQ25Vb0N4bEZ4ZGZ2TWM2RTdQblpnXzE3MTk3MTk1MjE6MTcxOTcyMzEyMV9WNA" srcset="/img/loading.gif" lazyload alt="img"></p>
<p> 非屏蔽型：UTP</p>
<p> 速率分类：</p>
<p> cat 5 &#x2F;5类线&#x2F;10M100M</p>
<p> cat 5e&#x2F;超五类线&#x2F;10M100M</p>
<p> cat 6&#x2F;六类线&#x2F;1000M</p>
<p> 线序EIA&#x2F;AIT568B:橙白，橙，绿白，蓝，蓝白，绿，棕白，棕</p>
<h4 id="1-2-数据链路层："><a href="#1-2-数据链路层：" class="headerlink" title="1.2 数据链路层："></a>1.2 数据链路层：</h4><p> Mac地址：媒体访问控制地址</p>
<p> 交换机工作原理：学习&#x2F;广播&#x2F;转发&#x2F;更新</p>
<p> VLAN：虚拟局域网</p>
<p> 语法配置</p>
<p>​         交换机1上配置</p>
<p>​         enable</p>
<p>​                 特权</p>
<p>​         config     t</p>
<p>​                 进入配置模式（config）#</p>
<p>​         vlan 10</p>
<p>​                 创建局域网10</p>
<p>​         vlan 20</p>
<p>​                 创建局域网20</p>
<p>​         interface  fastethernet0&#x2F;1</p>
<p>​                 必须要在接口模式下才可以输入</p>
<p>​         switch access vlan 10</p>
<p>​                 将端口加入VLAN</p>
<p>​         exit</p>
<p>​         Switch&gt;show vlan brief </p>
<p> TRUNK：干道</p>
<p> enable</p>
<p>​         特权</p>
<p> config t</p>
<p>​         进入配置模式</p>
<p> vlan 10</p>
<p>​         创建局域网10</p>
<p> vlan 20</p>
<p>​         创建局域网20</p>
<p> interface  fastethernet0&#x2F;1</p>
<p> switch access vlan 10</p>
<p> interface  f0&#x2F;2</p>
<p> switch access vlan 10</p>
<p> interface  f0&#x2F;3</p>
<p> switch access vlan 20</p>
<p> interface  f0&#x2F;4</p>
<p> switch access vlan 20</p>
<p> 在交换机互联的接口中配置</p>
<p> interface  f0&#x2F;5</p>
<p> switch mode  trunk</p>
<p>​         配置链路</p>
<p> switch1 也需要在f0&#x2F;5配置trunk链路</p>
<h4 id="1-3-网络层"><a href="#1-3-网络层" class="headerlink" title="1.3 网络层:"></a>1.3 网络层:</h4><p> IP地址：32位二进制数字</p>
<p> IP地址每八位为一组，用”.”分割，用十进制标识</p>
<p> 然后转换为十进制</p>
<p> 分类</p>
<p>​         A类（1~126）</p>
<p>​                 127:回环地址</p>
<p>​         B类（128~191）</p>
<p>​         C类（192~223）</p>
<p>​         D类（224~239）组播</p>
<p>​         E类（240~255）科研                    </p>
<p>  私有IP分类</p>
<p>​         A类：10.0.0.0~10.255.255.255</p>
<p>​         B类：172.16.0.0~172.31.255.255</p>
<p>​         C类：192.168.0.0~192.168.255.255</p>
<p> 子网掩码</p>
<p>​      作用</p>
<p>​              32位2进制数字</p>
<p>​               运算出IP地址的网络部分。</p>
<p>​         分类</p>
<p>​                 A类：255.0.0.0</p>
<p>​                 B类：255.255.0.0</p>
<p>​                 C类：255.255.255.0</p>
<p>​         方法</p>
<p>​                 子网掩码中为1部分，对应IP地址的网络位。</p>
<p>​                 IP地址和子网掩码，逻辑与运算</p>
<p> 网络地址</p>
<p>​         网络位相同，IP地址是同一网段</p>
<p>​                 直接通信</p>
<p>​         网络位不同，IP地址不是同一网段。</p>
<p>​                 不能直接通信，必须经过网关路由器转发</p>
<p> 网络层封装：</p>
<p><img src="https://hqrchvz3h42.feishu.cn/space/api/box/stream/download/asynccode/?code=NjFlM2NjNDA3NGExNThiYzNkNDczZWJjYWY5ZTNjM2JfZGIzYTFnNUQ1enJjbmlmcGpRREZYUmVIb280M09aRzNfVG9rZW46VmNlbmJ4QTZHb3RzbnZ4WGk2aGNGMkVXbjhjXzE3MTk3MTk1MjE6MTcxOTcyMzEyMV9WNA" srcset="/img/loading.gif" lazyload alt="img"></p>
<p>​       路由器工作原理</p>
<p>​         路由</p>
<p>​                 概念</p>
<p><img src="https://hqrchvz3h42.feishu.cn/space/api/box/stream/download/asynccode/?code=ODUyOTUxZjI5NjFlZjgwNTA0ZDg0YmYzOWM0NDg3MjJfUE8yNHNvQWoxS2QxYUpiU1A1SnFlVVVVMjVHcWJHM3NfVG9rZW46U0FIa2JiRkRjb09WR3V4WU5DUmNIVElnbnFlXzE3MTk3MTk1MjE6MTcxOTcyMzEyMV9WNA" srcset="/img/loading.gif" lazyload alt="img"></p>
<p>​                         </p>
<p>​          路由表形成</p>
<p><img src="https://hqrchvz3h42.feishu.cn/space/api/box/stream/download/asynccode/?code=YjEzZjc3ZmI1ZTc0YmY0MDdmMWY3MDM0MTZlZGRhMDFfdGRCQ0FTRDJpak9sR0FCM2hlZFlzamNpWXh5UnRvc2xfVG9rZW46SnZWZ2IybGlNb05YbVN4bVh5dGM2MGlWblliXzE3MTk3MTk1MjE6MTcxOTcyMzEyMV9WNA" srcset="/img/loading.gif" lazyload alt="img"></p>
<p>​                </p>
<p>​        路由协议</p>
<p>​                         静态路由（实现部分）</p>
<p>​                         动态路由（略）</p>
<p> 总结</p>
<p>​         上网需要网关</p>
<p>​         网关的路由表可以形成直连路由</p>
<p>​         网关的路由表可以手动添加非直连路由</p>
<h2 id="文件服务："><a href="#文件服务：" class="headerlink" title="文件服务："></a>文件服务：</h2><h4 id="1-1-FTP-（File-Transfer-Protocol，文件传输协议）"><a href="#1-1-FTP-（File-Transfer-Protocol，文件传输协议）" class="headerlink" title="1.1 FTP:（File Transfer Protocol，文件传输协议）"></a>1.1 <strong>FTP:（File Transfer Protocol，文件传输协议）</strong></h4><p>  是 TCP&#x2F;IP 协议组中应用层的协议之一</p>
<p> FTP Server 默认配置</p>
<p>​         1.安装vsftp</p>
<p>​                 # yum install  -y  vsftpd </p>
<p>​                         请提前准备好YUM源</p>
<p>​         2.准备分发的文件</p>
<p>​                 # touch &#x2F;var&#x2F;ftp&#x2F;abc.txt</p>
<p>​                 注释：FTP服务器的主目录：“&#x2F;var&#x2F;ftp&#x2F;”，是FTP程序分享内容的本机目录。</p>
<p>​         3,启动服务</p>
<p>​                 # systemctl start vsftpd</p>
<p>​                 # systemctl enable vsftpd</p>
<p>​                 # ss  -tnl   查看端口，看有没有20，21</p>
<p>​         4.关闭防火墙</p>
<p>​                 # systemctl  stop firewalld</p>
<p>​                 # systemctl  disable firewalld</p>
<p>​                 # setenforce 0</p>
<p>​                 # vim   &#x2F;etc&#x2F;selinux&#x2F;config</p>
<p>​                 修改内容为：SELINUX&#x3D;disabled</p>
<p>​           任何系统的浏览器   1 客户机打开浏览器</p>
<p>​              2 输入“ftp:&#x2F;&#x2F;服务器IP地址” 默认仅能下载文件</p>
<p>   LinuxFTP客户端程序1:lftp</p>
<p>​         安装客户端工具</p>
<p>​                 [root@localhost ~]# yum -y install lftp</p>
<p>​         访问服务器</p>
<p>​                 [root@localhost ~]# lftp 服务器的IP地址</p>
<p>​         查看并下载</p>
<p>​                 lftp qianfeng:~&gt; ls</p>
<p>​                 drwxr-xr-x 2 0 0 4096 Mar 31 2019 pub</p>
<p>​                 -rw-r–r– 1 0 0 0 Nov 22 03:53 abc.txt</p>
<p>​                 lftp qianfeng:~&gt; get abc.txt</p>
<p>​                         下载文件</p>
<p>​                 lftp qianfeng:~&gt; mirror pub</p>
<p>​                         下载目录</p>
<p> LinuxFTP客户端程序2:wget</p>
<p>​         [root@localhost ~]# wget <a href="ftp://192.168.142.132/abc.txt">ftp://192.168.142.132/abc.txt</a></p>
<p>​         [root@localhost ~]# wget <a href="ftp://192.168.142.132/abc.txt">ftp://192.168.142.132/abc.txt</a> -O &#x2F;tmp&#x2F;a.sh</p>
<p>​                 -O 指定文件名和路径。</p>
<p>​         [root@localhost ~]# wget <a target="_blank" rel="noopener" href="http://nginx.org/download/nginx-1.10.2.tar.gz">http://nginx.org/download/nginx-1.10.2.tar.gz</a></p>
<p> 启动上传功能</p>
<p>​         0.配置文件简介</p>
<p>​                 用于设定FTP服务器的功能开启或关闭的文件</p>
<p>​                 # vim  &#x2F;etc&#x2F;vsftpd&#x2F;vsftpd.conf</p>
<p>​                 老规矩，备份一个先</p>
<p>​         \1. 检查禁用匿名账户登录开启</p>
<p>​                 目的：启用&#x2F;禁用匿名账号（默认，比较方便）</p>
<p>​                 anonymous_enable&#x3D;YES</p>
<p>​                          &#x2F;&#x2F;是否允许匿名用户登录ftp</p>
<p>​                 能使  匿名&#x3D;是</p>
<p>​         2.配置上传指令</p>
<p>​                 anon_upload_enable&#x3D;YES</p>
<p>​                         启动上传文件的能力</p>
<p>​                 anon_mkdir_write_enable&#x3D;YES</p>
<p>​                         启动创建目录的能力</p>
<p>​                 systemctl restart vsftpd</p>
<p>​                         重启ftp程序</p>
<p>​         3.创建上传目录</p>
<p>​                 注意</p>
<p>​                         上传文件时，一定要来这个目录。</p>
<p>​                 mkdir   &#x2F;var&#x2F;ftp&#x2F;upload</p>
<p>​                 chmod  777   &#x2F;var&#x2F;ftp&#x2F;upload</p>
<p>​         4.客户端测试</p>
<p>​                 换个机器好吗？老铁！</p>
<p>​                 登录客户机</p>
<p>​                         echo  222  &gt; 2.txt</p>
<p>​                         lftp 192.168.142.129</p>
<p>​                 上传文件</p>
<p>​                         前提是客户机要有一个2.txt文件</p>
<p>​                         注意</p>
<p>​                                 然后进入上传目录</p>
<p>​                         cd   upload</p>
<p>​                         put 2.txt</p>
<p>​                 创建目录</p>
<p>​                         mkdir 222</p>
<p>​                 上传目录</p>
<p>​                         前提是你要有一个文件夹，等着上传。好不好</p>
<p>​                         mirror -R aaa</p>
<h4 id="1-2-NFS名词解释"><a href="#1-2-NFS名词解释" class="headerlink" title="1.2 NFS名词解释"></a>1.2 <strong>NFS名词解释</strong></h4><p>​         NFS：Network File System 网络文件系统，Linux&#x2F;Unix系统之间共享文件的一种协议</p>
<p>​         NFS 的客户端主要为Linux</p>
<p>​         支持多节点同时挂载,以及并发写入</p>
<p> 作用</p>
<p>​         提供文件共享服务</p>
<p>​         为 Web Server 配置集群中的后端存储</p>
<p> 环境</p>
<p>​         nas 192.168.142.133</p>
<p>​         web1 192.168.142.132</p>
<p>​         web2 192.168.142.130</p>
<p>​         web3 192.168.142.134</p>
<p> 关防火墙</p>
<p>​         #vi   &#x2F;etc&#x2F;selinux&#x2F;config</p>
<p>​                 SELINUX&#x3D;disabled</p>
<p>​         # setenforce 0</p>
<p>​         # systemctl stop firewalld</p>
<p>​         # systemctl disable firewalld</p>
<p> 一、nas（存储端）</p>
<p>​         NAS</p>
<p>​                 Network Attached Storage：网络附属存储</p>
<p>​                 NFS是NAS的一种</p>
<p>​         1.安装NFS服务器</p>
<p>​                 [root@nas ~]# yum -y install nfs-utils</p>
<p>​                 [root@nas ~]# mkdir &#x2F;webdata</p>
<p>​                         存储网站代码</p>
<p>​                 [root@nas ~]# echo “nfs test…” &gt; &#x2F;webdata&#x2F;index.html</p>
<p>​                         放置测试页面</p>
<p>​         2.配置NFS服务器</p>
<p>​                 [root@nas ~]# vim &#x2F;etc&#x2F;exports</p>
<p>​                 &#x2F;webdata              192.168.142.0&#x2F;24(rw)</p>
<p>​                 注释</p>
<p>​                         &#x2F;webdata指的是发布资源的目录</p>
<p>​                         192.168.142.0&#x2F;24允许访问NFS的客户机</p>
<p>​                         (rw)可读可写</p>
<p>​         3.启动NFS服务器</p>
<p>​                 [root@nas ~]# systemctl start nfs-server</p>
<p>​                 [root@nas ~]# systemctl enable nfs-server</p>
<p>​                 检查NFS输出是否正常</p>
<p>​                         [root@nas ~]# exportfs -v</p>
<p>​                                 -v 检查输出的目录</p>
<p>​                 &#x2F;webdata 192.168.122.0&#x2F;24(rw,wdelay,no_root_squash,no_subtree_check,sec&#x3D;sys,rw,secure,no_root_squash,no_all_squash)</p>
<p> 二、web1 web2 web3 客户端</p>
<p>​         WEB1服务器</p>
<p>​                 1.安装NFS客户端</p>
<p>​                         [root@web1 ~]# yum -y install nfs-utils httpd</p>
<p>​                         [root@web1 ~]# systemctl start httpd</p>
<p>​                         [root@web1 ~]# systemctl enable httpd</p>
<p>​                 2.查看存储端共享</p>
<p>​                         [root@web1 ~]# showmount -e 192.168.142.133</p>
<p>​                                 &#x2F;&#x2F; 查询NFS服务器可用目录</p>
<p>​                         Export list for 192.168.142.133</p>
<p>​                         &#x2F;webdata 192.168.142.0&#x2F;24</p>
<p>​                 \3. 手动挂载</p>
<p>​                         [root@web1 ~]# mount -t nfs 192.168.142.133:&#x2F;webdata      &#x2F;var&#x2F;www&#x2F;html&#x2F;</p>
<p>​                         注释</p>
<p>​                                 mount      -t        nfs           192.168.142.133:&#x2F;webdata        &#x2F;var&#x2F;www&#x2F;html</p>
<p>​                                 挂载命令    类型     nfs类型       nfs服务器地址：nfs输出目录       本地目录</p>
<p>​                 4.查看挂载</p>
<p>​                         [root@web1 ~]# df</p>
<p>​                         192.168.142.133:&#x2F;webdata 17811456 4444928 13366528   25% &#x2F;var&#x2F;www&#x2F;html</p>
<p>​                         [root@web1 ~]# ls &#x2F;var&#x2F;www&#x2F;html&#x2F;</p>
<p>​                         index.html</p>
<p>​                 5.使用web客户端查看web服务器</p>
<p>​                         真机打开浏览器浏览网页即可。</p>
<p>​         WEB2服务器</p>
<p>​                 同WEB1</p>
<p>​         WEB3服务器</p>
<p>​                 同WEB1</p>
<h4 id="1-3-ssh-server-远程登录操作系统"><a href="#1-3-ssh-server-远程登录操作系统" class="headerlink" title="1.3 ssh  server   远程登录操作系统"></a>1.3 <strong>ssh  server   远程登录操作系统</strong></h4><p> 1.查看ssh是否安装  #rpm -qa | grep  shh   若没安装SSH则可输入：yum install openssh-server安装</p>
<p> 2、SSH服务管理</p>
<p>​         启动服务</p>
<p>​                 （默认启动）systemctl start sshd</p>
<p>​         查看端口</p>
<p>​                 ss -anpt | grep sshd        22号端口提供者SSH服务</p>
<p>​         开机启动</p>
<p>​                 （默认启动）systemctl enable sshd</p>
<p> 3、使用SSH远程管理</p>
<p>​         #ssh   账户名@IP地址</p>
<p> 4、免密登录</p>
<p>​         环境</p>
<p>​                 192.168.142.134</p>
<p>​                         业务服务器-数量非常大</p>
<p>​                 192.168.142.129</p>
<p>​                         跳板机</p>
<p>​         1.使用129远程134</p>
<p>​                 需要使用密码</p>
<p>​         2.在129生成秘钥并传递给134</p>
<p>​                 生成秘钥</p>
<p>​                 传递秘钥</p>
<p>​         3.使用129远程134-免密</p>
<h2 id="网站服务："><a href="#网站服务：" class="headerlink" title="网站服务："></a>网站服务：</h2><p> 网站架构</p>
<p>​         LAMP</p>
<p>​                 Linux + Apache + MySQL + PHP</p>
<p>​                 系统+服务器程序+数据管理软件+中间软件</p>
<h4 id="1-1-静态站点："><a href="#1-1-静态站点：" class="headerlink" title="1.1 静态站点："></a>1.1 静态站点：</h4><p> 安装Apache</p>
<p>​         [root@localhost ~]# yum -y install httpd</p>
<p>​                 安装</p>
<p>​         [root@localhost ~]# systemctl start httpd</p>
<p>​                 启动</p>
<p>​         [root@localhost ~]# systemctl status  httpd</p>
<p>​                 查看服务状态</p>
<p>​         [root@localhost ~]# systemctl enable httpd</p>
<p>​                 开机自启</p>
<p>​         [root@localhost ~]# systemctl stop  firewalld</p>
<p>​                 关闭防火墙</p>
<p>​         [root@localhost ~]# setenforce 0</p>
<p>​                 关闭selinux</p>
<p>​         [root@localhost ~]# systemctl   stop   firewalld</p>
<p>​                 关闭防火墙</p>
<p>​         [root@localhost ~]# httpd -v</p>
<p>​                 查看版本</p>
<p>​         Server version: Apache&#x2F;2.4.6 (CentOS)</p>
<p>​                 输出信息</p>
<p> <strong>配置静态站点：</strong></p>
<p> 目的</p>
<p>​         虚拟主机VirtualHost</p>
<p>​         作用：在一台物理服务器上运行多个网站 </p>
<p> 类型</p>
<p>​         基于主机名</p>
<p>​                 <a target="_blank" rel="noopener" href="http://www.a.org/">www.a.org</a></p>
<p>​                 <a target="_blank" rel="noopener" href="http://www.b.org/">www.b.org</a></p>
<p> 1.准备网站源码（目录）</p>
<p>​       #mmkdir   &#x2F;var&#x2F;www&#x2F;html&#x2F;a.rog    创建目录</p>
<p>​      #vim    &#x2F;var&#x2F;www&#x2F;html&#x2F;a.org&#x2F;index.html        创建文件</p>
<p> 2.创建网站配置文件</p>
<p>​      #vim   &#x2F;etc&#x2F;httpd&#x2F;conf.d&#x2F;a.org.conf       创建并写入文件配置</p>
<p>​          &lt;VirtualHost             *:80&gt;</p>
<p>​           ServerName         <a target="_blank" rel="noopener" href="http://www.a.org/">www.a.org</a>    域名</p>
<p>​          DocumentRoot       &#x2F;var&#x2F;www&#x2F;html&#x2F;a.org      网站的根目录（路径）</p>
<p>​         </VirtualHost></p>
<p>​      #httpd  -t         查询配置文件语法是否正确</p>
<p>​      #systemctl    restart   httpdd      重启网站服务</p>
<p> 3.客户端域名解析</p>
<p>​      #vim   &#x2F;etc&#x2F;hossts      配置域名解析文件</p>
<p>​         192.168.217.129     <a target="_blank" rel="noopener" href="http://www.a.org/">www.a.org</a>       输入服务器ip和域名</p>
<p>​      #yum  install  -y  elinks     liunx上测试安装elinks</p>
<p>​      windows上测试打开C盘windows搜索notepad管理员身份进去hosts上添加域名解析</p>
<p> 1.准备源码</p>
<p>​    #mkdir   &#x2F;b.org      在根下创建b.org目录</p>
<p>​    #vim     &#x2F;b.org&#x2F;index.html     创建文件</p>
<p> 2.创建网站配置文件</p>
<p>​     #vim   &#x2F;etc&#x2F;httpd&#x2F;conf.d&#x2F;b.org.conf</p>
<p>​       &lt;VirtualHost           *:80&gt;</p>
<p>​        ServerName       <a target="_blank" rel="noopener" href="http://www.b.org/">www.b.org</a>     域名 </p>
<p>​        DocumentRoot      &#x2F;b.org</p>
<p>​       </VirtualHost></p>
<p>​       &lt;Directory      “&#x2F;b.org”&gt;</p>
<p>​        Require   all      granted</p>
<p>​       </Directory></p>
<p>​    #httpd  -t      查询配置文件语法</p>
<p>​    #systemctl   restart   httpd     重启</p>
<p> 3.客户端域名解析</p>
<p>​      #vim   &#x2F;etc&#x2F;hossts      配置域名解析文件</p>
<p>​         192.168.217.129     <a target="_blank" rel="noopener" href="http://www.b.org/">www.b.org</a>       输入服务器ip和域名</p>
<p>​      #yum  install  -y  elinks     liunx上测试安装elinks</p>
<p>​      windows上测试打开C盘windows搜索notepad管理员身份进去hosts上添加域名解析</p>
<h4 id="1-2-动态站点："><a href="#1-2-动态站点：" class="headerlink" title="1.2 动态站点："></a>1.2 动态站点：</h4><p> LAMP</p>
<p>​         linux系统-网站程序apache-数据库mysql-PHP中间件</p>
<p> <strong>一.部署论坛系统</strong>：</p>
<p>  1.基础环境：关闭防火墙</p>
<p>​     #systemctl  stop  firewalld     停止防火墙</p>
<p>​    #systemtl   disable   firewalld   开机禁用</p>
<p>​    #systemctl   status   firewalld   查看状态</p>
<p>   #getenforce      查看selinux防火墙状态</p>
<p>   #setenforce   0   停止防火墙</p>
<p>   #vim   &#x2F;etc&#x2F;sysconfig&#x2F;selinux</p>
<p>​      SELINUX&#x3D;disable</p>
<p>   \2. 安装LAMP：</p>
<p>​      #yum  install -y  httpd    mariadb-server   mariadb    php   php-mysql   gd  php-gd</p>
<p>​      #systemctl  start  httpd   mariadb       启动</p>
<p>​     #systemctl   enable   httpd  mariadb      开机自启</p>
<p> 3.安装discuz:</p>
<p>​      #rz     上传论坛软件包或wget下载</p>
<p> 如果出现乱码文件可以    #ll   -i      查询索引编号</p>
<p>​                                   #find   -inum   索引编号    -delete</p>
<p>​      #mkdir     -p    &#x2F;webroot&#x2F;discuz     创建目录</p>
<p>​      #yum   install   -y   unzip   下载解压工具</p>
<p>​      #unzip    Discuz_X2.5_SC_UTF8.zip       解压</p>
<p>​      #cp    -rf   upload&#x2F;*    &#x2F;webroot&#x2F;discuz      复制upload文件夹下所有文件到&#x2F;wenroot&#x2F;discuz</p>
<p>​      #chown  -R    apache.apache    &#x2F;webroot&#x2F;discuz      授权文件权限给网页</p>
<p> 4.配置虚拟主机：</p>
<p>​     #vim    &#x2F;etc&#x2F;httpd&#x2F;conf.d&#x2F;discuz.conf</p>
<p>​        &lt;VirtualHost          *:80&gt;</p>
<p>​           ServerName        <a target="_blank" rel="noopener" href="http://www.discuz.com/">www.discuz.com</a>   域名</p>
<p>​           DocumentRoot      &#x2F;webroot&#x2F;discuz    根目录</p>
<p>​         </VirtualHost></p>
<p>​         &lt;Directory        “&#x2F;webroot&#x2F;discuz”&gt;</p>
<p>​            Require   all     granted     </p>
<p>​         </Directory></p>
<p>​     #httpd  -t      查询配置文件</p>
<p>​     #systemctl    restart    httpd     重启</p>
<p> 5.准备数据库</p>
<p>​     #mysql      进入数据库</p>
<p>​     MariaDB[(none)]&gt; create   database   discuz;   创建discuz数据库</p>
<p>​     MariaDB[(none)]&gt; show   databases;  查询数据库</p>
<p>​     MariaDB[(none)]&gt; \q      退出</p>
<p> 6.客户端测试：</p>
<p>​    #vim   &#x2F;etc&#x2F;hossts      配置域名解析文件</p>
<p>​         192.168.217.129     <a target="_blank" rel="noopener" href="http://www.discuz.com/">www.discuz.com</a>      输入服务器ip和域名</p>
<p>​      #yum  install  -y  elinks     liunx上测试安装elinks</p>
<p>​      windows上测试打开C盘windows搜索notepad管理员身份进去hosts上添加域名解析</p>
<p> 二.部署商城系统:</p>
<p>​    1.基础环境（略）</p>
<p>​    2.安装lamp(略)</p>
<p>​    3.安装Ecshop:</p>
<p>​       #rz      上传或下载ecshop</p>
<p>​       #unzip    ECShop_V3.0.0_UTF8_release0518.zip      解压安装包</p>
<p>​      #mkdir     -p     &#x2F;webroot&#x2F;ecshop      创建文件夹</p>
<p>​     #cp   -rf     ECShop_V3.0.0_UTF8_release0518&#x2F;*    &#x2F;webroot&#x2F;ecshop       复制文件</p>
<p>​    #chown   -R   apache.apache   &#x2F;webroot&#x2F;ecshop       授权</p>
<p> 4.配置虚拟主机</p>
<p>​    #vim   &#x2F;etc&#x2F;httpd&#x2F;conf.d&#x2F;ecshop.conf</p>
<p>​      &lt;VirtualHost       *:80&gt;</p>
<p>​         ServerName       <a target="_blank" rel="noopener" href="http://www.ecshop.com/">www.ecshop.com</a>   域名</p>
<p>​        DocumentRoot      &#x2F;webroot&#x2F;ecshop  </p>
<p>​      </VirtualHost></p>
<p>​      &lt;Directory          “&#x2F;webroot&#x2F;ecshop”&gt;</p>
<p>​         Require     all   granted</p>
<p>​      </Directory></p>
<p> #httpd  -t</p>
<p> #systemctl   restart   httpd</p>
<p> #vim   &#x2F;etc&#x2F;php.ini      修改时区</p>
<p>​    ;date.timezone&#x3D;</p>
<p> 改为date.timezone&#x3D;Asia&#x2F;ShangHai</p>
<p> #systemctl    restart  httpd</p>
<p> 5.客户端测试：</p>
<p>​    #vim   &#x2F;etc&#x2F;hossts      配置域名解析文件</p>
<p>​         192.168.217.129     <a target="_blank" rel="noopener" href="http://www.ecshop.com/">www.ecshop.com</a>      输入服务器ip和域名</p>
<p>​      #yum  install  -y  elinks     liunx上测试安装elinks</p>
<p>​      windows上测试打开C盘windows搜索notepad管理员身份进去hosts上添加域名解析</p>
<p> <strong>部署网校系统</strong>：</p>
<p>​      1.基础环境（略）</p>
<p>​      2.epel源（略）</p>
<p>​      3.安装LAMP</p>
<p>​         # yum -y install bash-completion httpd php php-cli php-curl php-fpm php-intl php-mcrypt php-mysql php-gd    php-mbstring php-xml php-dom mariadb-server mariadb</p>
<p>​         #systemctl start httpd mariadb</p>
<p> 4.设置上传限制[可选]</p>
<p>​         网校的视频文件比较大，将默认的2M上传改大些。</p>
<p> # vim &#x2F;etc&#x2F;php.ini</p>
<p> post_max_size &#x3D; 1024M</p>
<p> memory_limit &#x3D; 1024M</p>
<p> upload_max_filesize &#x3D; 1024M</p>
<p> date.timezone &#x3D; Asia&#x2F;ShangHai</p>
<p> [可选]可以不用改</p>
<p> # vim &#x2F;etc&#x2F;php-fpm.d&#x2F;<a target="_blank" rel="noopener" href="http://www.conf/">www.conf</a></p>
<p> listen.owner &#x3D; apache</p>
<p> listen.group &#x3D; apache</p>
<p> listen.mode &#x3D; 0666</p>
<p> # systemctl start php-fpm</p>
<p> # systemctl enable php-fpm</p>
<p> 5、上传源码</p>
<p>​         # wget <a target="_blank" rel="noopener" href="http://download.edusoho.com/edusoho-7.5.12.tar.gz">http://download.edusoho.com/edusoho-7.5.12.tar.gz</a>        &#x2F;&#x2F;或者本地上传rz</p>
<p>​         #tar  xf  edusoho-7.5.12.tar.gz     解压</p>
<p>​         #mkdir   -p    &#x2F;webroot&#x2F;edusoho     创建目录</p>
<p>​         #cp   -rf   edusohp&#x2F;*    &#x2F;webroot&#x2F;edusoho     复制</p>
<p>​         #chown    -R    apache.apache    &#x2F;webroot&#x2F;edusoho     授权</p>
<p> 6.创建虚拟主机</p>
<p>​          #vim    &#x2F;etc&#x2F;httpd&#x2F;conf.d&#x2F;edusoho.conf</p>
<p>​             &lt;VirtualHost          *:80&gt;</p>
<p>​                 ServerName      <a target="_blank" rel="noopener" href="http://www.edusoho.com/">www.edusoho.com</a></p>
<p>​                 DocumentRoot    &#x2F;webroot&#x2F;edusoho&#x2F;web</p>
<p>​             </VirtualHost></p>
<p>​             &lt;Directory        “&#x2F;webroot&#x2F;edusoho&#x2F;web”&gt;</p>
<p>​                Require    all    granted</p>
<p>​             </Directory></p>
<p>​         #httpd  -t</p>
<p>​        #systemctl  restart   httpd</p>
<p> 7.创建数据库</p>
<p>​      #mysql</p>
<p>​      MariaDB [(none)]&gt; create database edusoho;</p>
<p>​      MariaDB [(none)]&gt;show  databases;</p>
<p>​      MariaDB [(none)]&gt;\q</p>
<p> 8.客户端测试：</p>
<p>​    #vim   &#x2F;etc&#x2F;hossts      配置域名解析文件</p>
<p>​         192.168.217.129     <a target="_blank" rel="noopener" href="http://www.edusoho.com/">www.edusoho.com</a>      输入服务器ip和域名</p>
<p>​      #yum  install  -y  elinks     liunx上测试安装elinks</p>
<p>​       访问<a target="_blank" rel="noopener" href="http://www.edusoho.com/app.php">www.edusoho.com/app.php</a></p>
<p>​      windows上测试打开C盘windows搜索notepad管理员身份进去hosts上添加域名解析</p>
<h2 id="域名服务："><a href="#域名服务：" class="headerlink" title="域名服务："></a>域名服务：</h2><p> 互联网的访问依靠IP地址。但IP地址不好记。</p>
<p> 所以使用域名服务（DNS，好记名），来替代访问的地址。</p>
<p> <strong>1.hosts文件（老的）</strong></p>
<p>​         不同系统的位置</p>
<p>​                 windows</p>
<p>​                         C:\Windows\System32\drivers\etc\hosts</p>
<p>​                                 需要超级管理员权限</p>
<p>​                 Linux</p>
<p>​                         &#x2F;etc&#x2F;hosts</p>
<p>​         作用： 实现名字解析，主要为本地主机名、集群节点提供快速解析</p>
<p>​         数据库： 平面式结构，集中式数据库</p>
<p>​         缺点：不便于查询，更新</p>
<p> <strong>DNS</strong></p>
<p>​         DNS（Domain Name System，域名系统）</p>
<p>​         作用： 实现名字解析（例如将主机名解析为IP）</p>
<p>​         （分布式，层次性）</p>
<p>  FQDN:主机名.四级域.三级域.二级域.顶级域.（根域）</p>
<p> <strong>域名解析流程：</strong></p>
<p> 例如客户端解析 <a target="_blank" rel="noopener" href="http://www.126.com/">www.126.com</a></p>
<ol>
<li><p>客户端查询自己的缓存（包含hosts中的记录），如果没有将查询发送&#x2F;etc&#x2F;resolv.conf中的DNS服务器</p>
</li>
<li><p>如果本地DNS服务器对于请求的信息具有权威性，会将（权威答案）发送到客户端。</p>
</li>
<li><p>否则（不具有权威性），如果DNS服务器在其缓存中有请求信息，则将（非权威答案）发送到客户端 </p>
</li>
<li><p>如果缓存中没有该查询信息，DNS服务器将搜索权威DNS服务器以查找信息：</p>
</li>
</ol>
<p> a. 从根区域开始，按照DNS层次结构向下搜索，直至对于信息具有权威的名称服务器，为客户端获答案</p>
<p> DNS服务器将信息传递给客户端 ，并在自己的缓存中保留一个副本，以备以后查找。</p>
<p> b. 转发到其它DNS服务器</p>
<p> <strong>DNS域名解析示例</strong></p>
<p>​         环境</p>
<p>​                 服务器192.168.142.129</p>
<p>​                 客户机192.168.142.？？？</p>
<p>​         1.客户机DNS本地缓存记录</p>
<p>​                 # vim   &#x2F;etc&#x2F;hosts</p>
<p>​                 192.168.142.129  <a target="_blank" rel="noopener" href="http://www.memeda.com/">www.memeda.com</a></p>
<p>​         2.客户机主机测试</p>
<p>​                 #ping   <a target="_blank" rel="noopener" href="http://www.memeda.com/">www.memeda.com</a></p>
<p>​                         1.看到解析成功</p>
<p>​                         2.看到联通成功</p>
<p>​                 #elinks  <a target="_blank" rel="noopener" href="http://www.memeda.com/">http://www.memeda.com</a></p>
<p>​         3.网站服务器辅助验证</p>
<p>​                 #yum  install -y  httpd</p>
<p>​                 #systemctl start  httpd</p>
<p>​                 #systemctl   stop   firewalld</p>
<p>​                 #echo  memeda  &gt; &#x2F;var&#x2F;www&#x2F;html&#x2F;index.html</p>
<p> ISP（阿里）域名申请及解析</p>
<p>​         1.准备阿里云服务器。启动网站功能</p>
<p>​                 搜索阿里云</p>
<p>​                 登录阿里云</p>
<p>​                 进入控制台</p>
<p>​                 选择ECS</p>
<p>​                 创建实例&#x2F;购买ECS</p>
<p>​                 选择配置</p>
<p>​                 选择带宽</p>
<p>​                 设置管理员密码</p>
<p>​                 设置标签</p>
<p>​                 确认订单</p>
<p>​                 登陆ECS，启动网站服务（例）</p>
<p>​                         论坛系统项目手册.docx</p>
<p>​         2.通过控制台找到域名注册服务。</p>
<p>​         3.输入新域名，根据需要选购合适域名。</p>
<p>​         5.选择购买。</p>
<p>​         6.支付</p>
<p>​         7.返回域名控制面板，绑定IP地址。</p>
<p>​                 </p>
<p>​         8.客户端测试</p>
<p>​         8.域名备案（略）</p>
<p>​                 第一次购买域名，需要个人身份信息。</p>
<ol>
<li><h1 id="第二阶段mysql"><a href="#第二阶段mysql" class="headerlink" title="第二阶段mysql:"></a><strong>第二阶段mysql:</strong></h1></li>
</ol>
<h2 id="mysql数据库部署："><a href="#mysql数据库部署：" class="headerlink" title="mysql数据库部署："></a>mysql数据库部署：</h2><p> 安装Mysql服务器：</p>
<p> 1.访问国内mysql镜像站</p>
<p>​         中国科学技术大学开源软件镜像</p>
<p>​         <a target="_blank" rel="noopener" href="http://mirrors.ustc.edu.cn/">http://mirrors.ustc.edu.cn/</a></p>
<p> 2.下载软件包</p>
<p>暂时无法在飞书文档外展示此内容</p>
<p>​       rz  上传至liunx上</p>
<p> 3.安装软件包</p>
<p>​        yum install -y  mysql57-community-release-el7.rpm</p>
<p>​         yum install -y  mysql-community-server</p>
<p>​       安装失败需要密钥</p>
<p>​       vim  &#x2F;etc&#x2F;yum.repos.d&#x2F;mysql-community.repo</p>
<p>​        将5.7版本的密钥验证改为0，再重装一次</p>
<p>​        yum  install -y  mysql-community-server </p>
<p> 4.启动mysql</p>
<p>​       systemctl  start   mysqld </p>
<p>​        systemctl  enable mysqld</p>
<p> 5.查看默认密码</p>
<p>​       grep  ‘password’  &#x2F;var&#x2F;log&#x2F;mysqld.log</p>
<p> 6.修改初始密码</p>
<p>​       mysqladmin  -uroot -p’初始密码’ password  ‘新密码’</p>
<p> 7.登录mysql数据库</p>
<p>​       mysql  -uroot -p ‘新密码’</p>
<p> 8.查到默认数据库</p>
<p>​      show  databases</p>
<p> 源码包安装：</p>
<p>​         特点源码安装与二进制(RPM)发行版本相比，如果我们选择了通过源代码进行安装，那么在安装过程中我们能够对MySQL所做的调整将会更多更灵活一些。因为通过源代码编译我们可以：</p>
<p> a) 针对自己的硬件平台选用合适的编译器来优化编译后的二进制代码；</p>
<p> b) 根据不同的软件平台环境调整相关的编译参数；</p>
<p> c) 针对我们特定应用场景选择需要什么组件不需要什么组件；</p>
<p> d) 根据我们的所需要存储的数据内容选择只安装我们需要的字符集；</p>
<p> e) 同一台主机上面可以安装多个MySQL；</p>
<p> f) 等等其他一些可以根据特定应用场景所作的各种调整。</p>
<p> 在源码安装给我们带来更大灵活性的同时，同样也给我们带来了可能引入的隐患：</p>
<p> a) 对编译参数的不够了解造成编译参数使用不当可能使编译出来的二进制代码不够稳定；</p>
<p> b) 对自己的应用环境把握失误而使用的优化参数可能反而使系统性能更差；</p>
<p> c) 还有一个并不能称之为隐患的小问题就是源码编译安装将使安装部署过程更为复杂，所花费的时间更长；</p>
<p>​         准备编译环境</p>
<p>​                 # yum -y install ncurses ncurses-devel openssl-devel bison gcc gcc-c++ make cmake</p>
<p>​                         编译软件</p>
<p>​                 # wget <a target="_blank" rel="noopener" href="http://sourceforge.net/projects/boost/files/boost/1.59.0/boost_1_59_0.tar.gz">http://sourceforge.net/projects/boost/files/boost/1.59.0/boost_1_59_0.tar.gz</a></p>
<p>​                 内存硬盘空间</p>
<p>​         安装mysql</p>
<p>​                 准备源码包</p>
<p>​                         # groupadd mysql</p>
<p>​                         # useradd -r -g mysql -s &#x2F;bin&#x2F;false mysql</p>
<p>​                         # tar xvf mysql-5.7.19.tar.gz</p>
<p>​                         # cd mysql-5.7.19</p>
<p>​                                 [root@mysql3 mysql-5.7.19]# pwd</p>
<p>​            &#x2F;root&#x2F;mysql-5.7.19</p>
<p>​                         # mv ..&#x2F;boost_1_59_0.tar.gz  .</p>
<p>​                         [root@mysql3 mysql-5.7.19]# tar xf  boost_1_59_0.tar.gz</p>
<p>​                                 注意包的位置</p>
<p>​                 配置</p>
<p>​                         [<a href="mailto:&#114;&#x6f;&#111;&#x74;&#x40;&#109;&#121;&#x73;&#x71;&#108;&#45;&#x35;&#46;&#55;&#46;&#x31;&#x37;">&#114;&#x6f;&#111;&#x74;&#x40;&#109;&#121;&#x73;&#x71;&#108;&#45;&#x35;&#46;&#55;&#46;&#x31;&#x37;</a> ~]# cmake . \</p>
<p> -DWITH_BOOST&#x3D;boost_1_59_0&#x2F; \</p>
<p> -DCMAKE_INSTALL_PREFIX&#x3D;&#x2F;usr&#x2F;local&#x2F;mysql \</p>
<p> -DSYSCONFDIR&#x3D;&#x2F;etc \</p>
<p> -DMYSQL_DATADIR&#x3D;&#x2F;usr&#x2F;local&#x2F;mysql&#x2F;data \</p>
<p> -DINSTALL_MANDIR&#x3D;&#x2F;usr&#x2F;share&#x2F;man \</p>
<p> -DMYSQL_TCP_PORT&#x3D;3306 \</p>
<p> -DMYSQL_UNIX_ADDR&#x3D;&#x2F;tmp&#x2F;mysql.sock \</p>
<p> -DDEFAULT_CHARSET&#x3D;utf8 \</p>
<p> -DEXTRA_CHARSETS&#x3D;all \</p>
<p> -DDEFAULT_COLLATION&#x3D;utf8_general_ci \</p>
<p> -DWITH_READLINE&#x3D;1 \</p>
<p> -DWITH_SSL&#x3D;system \</p>
<p> -DWITH_EMBEDDED_SERVER&#x3D;1 \</p>
<p> -DENABLED_LOCAL_INFILE&#x3D;1 \</p>
<p> -DWITH_INNOBASE_STORAGE_ENGINE&#x3D;1</p>
<p>​                                 常见错误</p>
<p>​                                         -DWITH_BOOST&#x3D;boost_1_59_0  </p>
<p> 如果没有提前准备，可以使用下面的参数自己装。</p>
<p> -DDOWNLOAD_BOOST&#x3D;1</p>
<p>​                                         -DWITH_READLINE&#x3D;1 \  5.6被移除</p>
<p>​                                         如果cmake失败，请将CMakeCache.txt缓存移除</p>
<p>​                 编译</p>
<p>​                         # make</p>
<p>​                                 等待1个小时左右</p>
<p>​                 安装</p>
<p>​                         # make install</p>
<p>​         初始化</p>
<p>​                 # cd &#x2F;usr&#x2F;local&#x2F;mysql</p>
<p>​                         安装位置</p>
<p>​                 # mkdir mysql-files</p>
<p>​                 # chown -R mysql.mysql  &#x2F;usr&#x2F;local&#x2F;mysql</p>
<p>​                         注意目录名称</p>
<p>​                 #  &#x2F;usr&#x2F;local&#x2F;mysql&#x2F;bin&#x2F;mysqld –initialize –user&#x3D;mysql –basedir&#x3D;&#x2F;usr&#x2F;local&#x2F;mysql –datadir&#x3D;&#x2F;usr&#x2F;local&#x2F;mysql&#x2F;data</p>
<p>​                         会生产临时密码，在屏幕上。</p>
<p>​                         保存临时密码。</p>
<p>​                         eGyLEeRr67-&#x2F;</p>
<p>​                 #  &#x2F;usr&#x2F;local&#x2F;mysql&#x2F;bin&#x2F;mysql_ssl_rsa_setup –datadir&#x3D;&#x2F;usr&#x2F;local&#x2F;mysql&#x2F;data</p>
<p>​                 建立MySQL配置文件my.cnf</p>
<p>​                         备份原有配置文件</p>
<p>​                                 [root@localhost mysql]# mv &#x2F;etc&#x2F;my.cnf  ~</p>
<p>​                         # vim &#x2F;etc&#x2F;my.cnf</p>
<p>​                                 [root@mysql1 mysql]# vim &#x2F;etc&#x2F;my.cnf</p>
<p> [mysqld]</p>
<p> basedir&#x3D;&#x2F;usr&#x2F;local&#x2F;mysql</p>
<p> datadir&#x3D;&#x2F;usr&#x2F;local&#x2F;mysql&#x2F;data</p>
<p>​         开机启动MySQL</p>
<p>​                 # cp &#x2F;usr&#x2F;local&#x2F;mysql&#x2F;support-files&#x2F;mysql.server &#x2F;etc&#x2F;init.d&#x2F;mysqld</p>
<p>​                 # chkconfig –add mysqld</p>
<p>​                         添加mysql服务</p>
<p>​                         systemctl   enable  mysqld</p>
<p>​                 # chkconfig mysqld on</p>
<p>​                         开机自动启动mysql服务</p>
<p>​                 # service mysqld start</p>
<p>​                 # ps aux |grep mysqld</p>
<p>​                 mysql -u root -p ‘密码’  登陆有问题吗？</p>
<p>​                         &#x2F;usr&#x2F;local&#x2F;mysql&#x2F;bin&#x2F;mysql -u root -p’x&#x2F;dwiQ2&lt;l:hb’</p>
<p>​                         不要忘了配置新密码。</p>
<p>​                                 # &#x2F;usr&#x2F;local&#x2F;mysql&#x2F;bin&#x2F;mysqladmin -u root -p ‘x&#x2F;dwiQ2&lt;l:hb’ password ‘QinFeng@123’</p>
<p>​                         show databases; 看到库即可。</p>
<h2 id="SQL"><a href="#SQL" class="headerlink" title="SQL:"></a>SQL:</h2><p> 数据库所在位置</p>
<p>   &#x2F;var&#x2F;lib&#x2F;mysql&#x2F;  数据库的实体</p>
<p>​       创建数据库：</p>
<p>​        &gt;create  database 数据库名;</p>
<p>​       查看所有数据库：</p>
<p>​        &gt;show  databases;</p>
<p>​       删除数据库：</p>
<p>​       &gt; drop  database  数据库名；</p>
<p>​       进入数据库：</p>
<p>​      &gt; use 数据库名；</p>
<p>​       查看自己所在库：</p>
<p>​      &gt;select database();</p>
<p>  <strong>数据类型</strong>：</p>
<p>  1.数值类型：</p>
<p>​         整数类型    INT          TINYINT   SMALLINT   MEDIUMINT   BIGINT     注意长度</p>
<p>​                                 阅读资料</p>
<p>​          (1)、bigint(2^64)从 -2^63 (-9223372036854775808) 到 2^63-1 (9223372036854775807) 的整型数据（所有数字），无符号的范围是0到18446744073709551615。一位为 8 个字节。</p>
<p>​          (2)、int（2^32）一个正常大小整数。有符号的范围是-2^31 (-2,147,483,648) 到 2^31 - 1 (2,147,483,647) 的整型数据（所有数字），无符号的范围是0到4294967295。一位大小为 4 个字节。</p>
<p> int 的 SQL-92 同义词为 integer。</p>
<p>​         (3)、mediumint(2^24)一个中等大小整数，有符号的范围是-8388608到8388607，无符号的范围是0到16777215。 一位大小为3个字节。</p>
<p>​         (4)、smallint(2^16)一个小整数。有符号的范围是-2^15 (-32,768) 到 2^15 - 1 (32,767) 的整型数据，无符号的范围是0到65535。一位大小为 2 个字节。MySQL提供的功能已经绰绰有余，而且由于MySQL是开放源码软件，因此可以大大降低总体拥有成本。</p>
<p>​         (5)、tinyint(2^8)有符号的范围是-128 - 127，无符号的范围是 从 0 到 255 的整型数据。一位大小为 1 字节。</p>
<p>​             浮点数类型         FLOAT DOUBLE    注意小数点</p>
<p>​             定点数类型          DEC</p>
<p>​             位类型            BIT</p>
<p> 2.字符串类型：</p>
<p>​                     CHAR系列          CHAR  VARCHAR   char的长度不可变。  varchar的长度可以增加。</p>
<p>​                 TEXT系列    TEXT   TINYTEXT  MEDIUMTEXT LONGTEXT  ASCII</p>
<p>​                 BLOB 系列  BLOB    TINYBLOB  MEDIUMBLOB LONGBLOB    特殊符号</p>
<p>​                 BINARY系列         BINARY VARBINARY</p>
<p>​                 枚举类型：        ENUM   65536个元素 单选择题</p>
<p>​                 集合类型：         SET      64个元素     多选择题</p>
<p> 3.时间和日期类型</p>
<p>​         年 YEAY       日期 DATE        时间 TIME        日期和时间 DATETIME</p>
<p> 4.约束类型</p>
<p>​         约束条件                                                说明</p>
<p>​         PRIMARY KEY (PK)</p>
<p>​                     标识该字段为该表的主键，可以唯一的标识记录，不可以为空</p>
<p>​                         员工信息表</p>
<p>​                         UNIQUE + NOT NULL     </p>
<p>​         FOREIGN KEY (FK)</p>
<p>​                     标识该字段为该表的外键，实现表与表（父表主键&#x2F;子表1外键&#x2F;子表2外键）之间的关联</p>
<p>​                     员工工资表</p>
<p>​         UNIQUE KEY  (UK)</p>
<p>​                     标识该字段的值是唯一的，可以为空，一个表中可以有多个UNIQUE KEY</p>
<p>​         AUTO_INCREMENT</p>
<p>​                 标识该字段的值自动增长（整数类型，而且为主键）</p>
<p>​         DEFAULT</p>
<p>​                 为该字段设置默认值</p>
<p>​                 字段是否有默认值，缺省的默认值是NULL，如果插入记录时不给字段赋值，此字段使用默认值</p>
<p>​                  sex enum(‘male’,’female’) not null default ‘male’                &#x2F;&#x2F;默认值male</p>
<p>​                  age int unsigned NOT NULL default 20          &#x2F;&#x2F;必须为正值（无符号） 不允许为空  默认是20</p>
<p>​         NOT NULL       标识该字段不能为空</p>
<p>​                  是否允许为空，默认NULL，可设置NOT NULL，字段不允许为空，必须赋值</p>
<p>​         UNSIGNED</p>
<p>​                  无符号，正数</p>
<p>​         ZEROFILL</p>
<p>​                  使用0填充，例如0000001 </p>
<h2 id="DML"><a href="#DML" class="headerlink" title="DML:"></a>DML:</h2><p> <strong>一、插入数据INSERT</strong></p>
<p>​         完整插入</p>
<p>​                 语法</p>
<p>​                         INSERT INTO 表名       VALUES (值1,值2,值3…值n);</p>
<p>​      </p>
<p>​         部分插入</p>
<p>​                 语法</p>
<p>​                         INSERT INTO 表名（列名，列名）  VALUES (值1,值2);</p>
<p> <strong>二 . 更新数据update</strong></p>
<p>​           语法</p>
<p>​                UPDATE   表名   SET   列名&#x3D;值   WHERE   CONDITION; </p>
<p> 示例1</p>
<p>​         准备一张表</p>
<p>​                 mysql&gt; create table t6(id int, name varchar(20));</p>
<p>​                 mysql&gt; insert into t6 values (1,’aa’);</p>
<p>​                 mysql&gt; insert into t6 values (2,’bb’);</p>
<p>​         更新数据</p>
<p>​                 需求：把bb改成cc</p>
<p>​                 mysql&gt; update   t6   set   name&#x3D;’cc’  where id&#x3D;2;</p>
<p>​         查询结果</p>
<p>​                 mysql&gt; select * from t6;  </p>
<p> 示例2</p>
<p>​         修改mysql数据库管理员root账户的密码。</p>
<p>​          mysql&gt; update mysql.user set authentication_string&#x3D;password(“QianFeng@123456”) where                            user&#x3D;”root”;</p>
<p> <strong>三、删除数据DELETE</strong></p>
<p>​         语法：</p>
<p>​                 DELETE   FROM    表名   WHERE   CONDITION;</p>
<p>​         示例：</p>
<p>​                 需求：删除id为2 的用户记录。</p>
<p>​                 mysql&gt; delete from t6 where id&#x3D;2;</p>
<p>​                 请思考不加where条件会如何。</p>
<h4 id="一、简单查询"><a href="#一、简单查询" class="headerlink" title="一、简单查询"></a><strong>一、简单查询</strong></h4><p>​         简单查询</p>
<p>​                 查看所有列</p>
<p>​                         前提是需要进入数据库。不进入数据库，就请输入库名。</p>
<p>​                         SELECT    *    FROM   表名;</p>
<p>​                 查部分列</p>
<p>​                         SELECT   列1，列2，列3    FROM     表名;  通过四则运算查询</p>
<p>​                 看一看年薪</p>
<p>​                             SELECT name, salary, salary*14 FROM employee5;              </p>
<h4 id="二、条件查询"><a href="#二、条件查询" class="headerlink" title="二、条件查询"></a><strong>二、条件查询</strong></h4><ul>
<li>单条件查询where</li>
</ul>
<p>​            查询hr部门的员工姓名 SELECT name,post FROM employee5 WHERE post&#x3D;’hr’;</p>
<ul>
<li>多条件查询AND&#x2F;OR</li>
</ul>
<p>​             查询hr部门的员工姓名，并且工资大于1000 </p>
<p> SELECT name,salary FROM employee5 WHERE post&#x3D;’hr’ AND salary&gt;1000;</p>
<p>​             查询所有部门的员工姓名，并且工资是6000或者8000的员工</p>
<p> SELECT name, salary FROM employee5  WHERE salary&#x3D;6000 OR salary&#x3D;8000</p>
<p>​             关键字BETWEEN AND 在什么之间   需求：查一查薪资在5000到15000</p>
<p> SELECT name,salary FROM employee5  WHERE salary BETWEEN 5000 AND 15000;</p>
<p>​                 需求：不在5000~15000呢？请使用NOT</p>
<p> SELECT name,salary FROM employee5 WHERE salary NOT BETWEEN 5000 AND 15000;</p>
<p>​                      在5000~15000   使用 BETWEEN  5000  AND  15000</p>
<p>​              关键字IN   工资可能是4000，也可能是5000，还有可能是9000，怎么查   OR可以组合多条件，效率如何？</p>
<p> SELECT name, salary FROM employee5  WHERE salary&#x3D;4000 OR salary&#x3D;5000 OR salary&#x3D;6000 OR salary&#x3D;9000 ;</p>
<p>​              优化           是什么什么</p>
<p> SELECT name, salary FROM employee5  WHERE salary IN (4000,5000,6000,9000) ;</p>
<p>​                               不是什么什么</p>
<p> SELECT name, salary FROM employee  WHERE salary NOT IN (4000,5000,6000,9000) ;</p>
<p>​             关键字IS NULL       没有岗位描述的   空</p>
<p> SELECT name,job_description FROM employee5  WHERE job_description IS NULL;</p>
<p>​                         非空</p>
<p> SELECT name,job_description FROM employee5   WHERE job_description IS NOT NULL;</p>
<p>​                         错误示范，空格’’</p>
<p> SELECT name,job_description FROM employee5   WHERE job_description&#x3D;’’;</p>
<p>​              关键字LIKE模糊查询  好像有个员工姓阿</p>
<p> SELECT * FROM employee5   WHERE name LIKE ‘al%’;</p>
<p>​              通配符’%’代表多个任意字符  注意不是shell的”*”星号。mysql使用”%”</p>
<p>​               好像有个员工姓阿</p>
<p> SELECT * FROM employee5    WHERE name LIKE ‘al___’;</p>
<p>​      注意不是shell的“？”问号。mysql使用”<em>“下划线</em>_     通配符’_’代表1个任意字符三、查询排序</p>
<p>​       例如以工资升序排列</p>
<p> SELECT    *     FROM     表名   ORDER       BY     工资的列名     ASC;</p>
<p>​        例如以工资降序排列</p>
<p> SELECT    *     FROM     表名   ORDER BY    工资的列名     DESC;</p>
<p>​         工资最高的前五名</p>
<p> SELECT * FROM employee5 ORDER BY salary DESC    LIMIT  5;               &#x2F;&#x2F;默认初始位置为0</p>
<p> <strong>多表查询：</strong></p>
<p> 分类</p>
<p>​         交叉连接    生成笛卡尔积，它不使用任何匹配条件</p>
<p>​         内连接      只连接匹配的行</p>
<p>​         外连接</p>
<p>​                 左连接：        会显示左边表内所有的值，不论在右边表内匹不匹配</p>
<p>​                 右连接：        会显示右边表内所有的值，不论在左边表内匹不匹配</p>
<p> <strong>内连接</strong>：</p>
<p> 语法</p>
<p>​         SELECT 字段列表  FROM 表1 ，表2   WHERE    表1.字段 &#x3D; 表2.字段;</p>
<p> 实例</p>
<p>​       select info.name,info.age,info.dep_num,department.dep_name from info,department where info.dep_num &#x3D; department.dep_num;</p>
<p> <strong>外连接(左连接 left join  on)</strong></p>
<p>​    需求    找出所有员工及所属的部门，包括没有部门的员工</p>
<p>​                 查看所有员工的部门信息。</p>
<p>​         示例</p>
<p>​                 select info.name,info.age,info.dep_num,department.dep_name from info left join department on info.dep_num &#x3D; department.dep_num;</p>
<p>   外连接(右连接right join  on)</p>
<p>​         需求1 显示所有的部门的员工信息。</p>
<p>​         示范</p>
<p>​                 select info.name,info.age,info.dep_num,department.dep_name from info right join department on info.dep_num &#x3D; department.dep_num;</p>
<p>​         需求2</p>
<p>​                 找出公司所有部门中年龄大于25岁的员工</p>
<p>​         示例</p>
<p>​                 select info.name,info.age,info.dep_num,department.dep_name  from</p>
<p>  info right join department on  info.dep_num &#x3D; department.dep_num </p>
<p> AND  age &gt; 25;</p>
<p>​         需求3</p>
<p>​                 找出公司所有部门中的员工，对他们的年龄排序</p>
<p>​         示例</p>
<p>​                 select info.name,info.age,info.dep_num,department.dep_name from </p>
<p> info right join department on info.dep_num &#x3D; department.dep_num  ORDER BY </p>
<p> age ASC;</p>
<p> <strong>DCL:</strong></p>
<p> <strong>mysql用户管理</strong></p>
<p>​         \1. 创建用户</p>
<p>​                 示例</p>
<p>​                         CREATE         USER          user1@’localhost’        IDENTIFIED       BY      ‘QianFeng@123456’;</p>
<p>​                                 验证</p>
<p>​                                         select * from mysql.user\G;</p>
<p>​                         注释</p>
<p>​                                 CREATE  创建（关键字）</p>
<p>​                                 USER 用户（关键字）</p>
<p>​                                 user1   用户名称（自定义）</p>
<p>​                                 @ 分隔符（关键字）</p>
<p>​                                 ‘localhost’   允许登录的主机</p>
<p>​                                 IDENTIFIED BY 身份认证（关键字）</p>
<p>​                                 ‘QianFeng@123456’   用户密码</p>
<p>​         \2. 删除用户</p>
<p>​                 示例</p>
<p>​                         DROP USER ‘user1‘@’localhost’;</p>
<p>​                         操作示例</p>
<p>​                                 select * from mysql.user\G;</p>
<p>​                                 drop user ‘user1‘@’localhost’;</p>
<p>​                                 select * from mysql.user\G;</p>
<p>​                                         或者select user from mysql.user;</p>
<p>​         \3. 修改用户密码</p>
<p>​                 root修改自己密码</p>
<p>​                         示例1</p>
<p>​                                 # mysqladmin      -uroot      -p’123’         password       ‘new_password’</p>
<p>​                                         前提是拥有系统权限</p>
<p>​                                                 update也可以哦。不过比较复杂</p>
<p>​                                                             UPDATE mysql.user SET authentication_string&#x3D;password(‘new_password’)  WHERE user&#x3D;’root’ AND host&#x3D;’localhost’;</p>
<p>​                                                             FLUSH PRIVILEGES;</p>
<p>​                                         123为旧密码</p>
<p>​                         示例2</p>
<p>​                                 SET PASSWORD&#x3D;password(‘new_password’);</p>
<p>​                                     FLUSH PRIVILEGES;</p>
<p>​                                         刷新权限</p>
<p>​                 丢失root用户密码</p>
<p>​                         1.前言</p>
<p>​                                 当root用户，忘记了密码。可以使用破解的方式来登录系统。修改密码。</p>
<p>​                                 原理：使系统在启动时，不加载密码文件。</p>
<p>​                         2.修改mysql启动设置</p>
<p>​                                     # vim &#x2F;etc&#x2F;my.cnf</p>
<p>​     [mysqld]</p>
<p>​     skip-grant-tables</p>
<p>​                         3.重启mysql，无密码登录</p>
<p>​                                 重启mysql程序</p>
<p>​                                             # systemctl    restart   mysqld</p>
<p>​                                 无密码登录</p>
<p>​                                             # mysql -uroot</p>
<p>​                                 修改自己的密码</p>
<p>​                                         mysql&gt;UPDATE mysql.user SET authentication_string&#x3D;password(‘QianFeng@123456789’)  where  user&#x3D;’root’  and  host&#x3D;’localhost’;</p>
<p>​                                         mysql&gt; FLUSH PRIVILEGES;</p>
<p>​                         4.修改mysql启动设置</p>
<p>​                                 注释掉跳过密码</p>
<p>​         \4. 登录MySQL</p>
<p>​                 mysql   -P 3306 -u root -p123 mysql -e ‘show tables’</p>
<p>​                             -h        指定主机名                       【默认为localhost】</p>
<p>​                     -P        MySQL服务器端口              【默认3306】    大P</p>
<p>​                     -u        指定用户名                       【默认root】</p>
<p>​                     -p        指定登录密码                    【默认为空密码】</p>
<p>​                 此处mysql为指定登录的数据库</p>
<p>​                     -e        接SQL语句</p>
<p>​                 示例</p>
<p>​                         免登录查询数据库</p>
<p>​                                 mysql -uroot -p‘QianFeng@123’ -hlocalhost -P 3306 mysql -e ‘show tables’</p>
<p> <strong>mysql权限原理</strong></p>
<p>​         语法格式</p>
<p>​                  grant 权限列表  on 库名.表名 to ‘用户名‘@’客户端主机’  [identified by ‘密码’  with option参数];</p>
<p>​                 &#x3D;&#x3D;权限列表</p>
<p>​                         all： 所有权限（不包括授权权限）</p>
<p>​                         select,update         查询更新</p>
<p>​                 &#x3D;&#x3D;数据库.表名</p>
<p>​                         <em>.</em></p>
<p>​                                 所有库下的所有表</p>
<p>​                         web.*</p>
<p>​                                 web库下的所有表</p>
<p>​                         web.stu_info</p>
<p>​                                 web库下的stu_info表</p>
<p>​                         grant SELECT (id), INSERT (name,age) ON mydb.mytbl to ‘user8‘@’localhost’ identified by ‘QianFeng@123’;</p>
<p>​                                      Column level</p>
<p>​                 &#x3D;&#x3D;客户端主机</p>
<p>​                          %</p>
<p>​                                 所有主机</p>
<p>​                         192.168.2.%                    192.168.2.0网段的所有主机</p>
<p>​                         192.168.2.168                    指定主机</p>
<p>​                         localhost                指定主机</p>
<p>​                 &#x3D;&#x3D;with_option参数</p>
<p>​                             GRANT OPTION</p>
<p>​                                 授权选项</p>
<p> <strong>mysql权限示例</strong></p>
<p>​         赋予权限</p>
<p>​                 授权目标</p>
<p>​                         授予admin3 对bbs库 所有的表，具有所有权限（不包含授权）</p>
<p>​                         GRANT ALL ON bbs.* TO admin3@’%’ IDENTIFIED BY ‘QianFeng@13910604684’;</p>
<p>​                 赋权示例</p>
<p>​                         1.准备测试账户</p>
<p>​                                 root账户创建</p>
<p>​                                         CREATE USER admin3@’%’ IDENTIFIED BY ‘QianFeng@123’;</p>
<p>​                         2.授权账户</p>
<p>​                                 root账户授权</p>
<p>​                                         GRANT ALL ON bbs.* TO admin3@’%’ IDENTIFIED BY ‘QianFeng@13910604684’;</p>
<p>​                         3.使用测试账户操作数据库</p>
<p>​                                 [root@localhost ~]# mysql -uadmin3 -p‘QianFeng@123’</p>
<p>​                                 mysql&gt; create database bbs;</p>
<p>​                                 试试创建别的库</p>
<p>​                                         mysql&gt; create database bba;</p>
<p>​                                         ERROR 1044 (42000): Access denied for user ‘admin3‘@’%’ to database ‘bba’</p>
<p>​                                 进入bbs库，创建数据表和插入数据。</p>
<p>​                                         授权验证完毕</p>
<p>​         回收权限</p>
<p>​                 查看权限</p>
<p>​                         查看自己的权限</p>
<p>​                                 SHOW GRANTS\G</p>
<p>​                         查看别人的权限</p>
<p>​                                 SHOW GRANTS FOR admin3@’%’\G</p>
<p>​                 回收权限REVOKE</p>
<p>​                         语法</p>
<p>​                                 REVOKE 权限列表 ON 数据库名 FROM 用户名@‘客户端主机’</p>
<p>​                         示例</p>
<p>​                                     REVOKE ALL PRIVILEGES  ON bbs.*  FROM admin3@’%’;                                      &#x2F;&#x2F;回收所有权限</p>
<p>​                 删除用户的版本问题</p>
<p>​                         5.6之前，先   revoke all privilege        再  drop user</p>
<p>​                         5.7之后，直接        drop user</p>
<h4 id="三-日志"><a href="#三-日志" class="headerlink" title="三.  日志:"></a>三.  日志:</h4><p>​         一、日志分类</p>
<p>​                 图示</p>
<p>​                         1 错误日志 ：启动，停止，关闭失败报错。rpm安装日志位置 &#x2F;var&#x2F;log&#x2F;mysqld.log</p>
<p>​                         2 通用查询日志：所有的查询都记下来。</p>
<p>​                         3 二进制日志：实现备份，增量备份。只记录改变数据，除了select都记。</p>
<p>​                         4 中继日志：读取主服务器的binlog，在本地回放。保持一致。</p>
<p>​                         5 slow log：慢查询日志，指导调优，定义某一个查询语句，定义超时时间，通过日志提供调优建议给开发人员。</p>
<p>​                         6 DDL log： 定义语句的日志。</p>
<p>​         二、Error Log</p>
<p>​                 vim   &#x2F;etc&#x2F;my.cnf</p>
<p>​                         进入主配置文件，观察日志是否启动。</p>
<p>​                 log-error&#x3D;&#x2F;var&#x2F;log&#x2F;mysqld.log</p>
<p>​                         该字段，标记是否启动日志，以及日志位置。</p>
<p>​                 如果哪天mysql服务起不来了，请来这个日志文件看看。</p>
<p>​         三、Binary Log</p>
<p>​                 默认没有开启,二进制日志</p>
<p>​                 启动二进制日志</p>
<p>​                         # vim   &#x2F;etc&#x2F;my.cnf</p>
<p>​                         log_bin</p>
<p>​                                 添加该字段。指启动二进制日志</p>
<p>​                         server-id&#x3D;2</p>
<p>​                                 群集问题，必须指定该主机的序号。数字随意</p>
<p>​                         # systemctl restart mysqld</p>
<p>​                                 重启数据库</p>
<p>​                 测试</p>
<p>​                         1 查看二进制日志文件当前状态</p>
<p>​                                 ls &#x2F;var&#x2F;lib&#x2F;mysql&#x2F;<em>bin</em></p>
<p>​                                         查询二进制文件生成完成。</p>
<p>​                                 mysqlbinlog -v &#x2F;var&#x2F;lib&#x2F;mysql&#x2F;localhost-bin.000001</p>
<p>​                                         查看二进制文件日志。后续讲解</p>
<p>​                                 # at 123</p>
<p>​                                         找到一个记录位置</p>
<p>​                         2 进入数据库，进行数据操作</p>
<p>​                                 创库，创表，创数据（过程略）</p>
<p>​                         3 完成二进制日志启动，查询测试</p>
<p>​                                 mysqlbinlog -v &#x2F;var&#x2F;lib&#x2F;mysql&#x2F;localhost-bin.000001</p>
<p>​                                         找到刚才创建的记录即可。</p>
<p>​         四、Slow Query Log</p>
<p>​                 默认慢查询日志未开启</p>
<p>​                 开启慢查询日志功能</p>
<p>​                         vim   &#x2F;etc&#x2F;my.cnf</p>
<p>​                                  加入下面2行配置</p>
<p>​                                 slow_query_log&#x3D;1</p>
<p>​                                         启动慢查询日志</p>
<p>​                                         这个参数设置为ON，可以捕获执行时间超过一定数值的SQL语句。</p>
<p>​                                 long_query_time&#x3D;3</p>
<p>​                                         当SQL语句执行时间超过此数值时，就会被记录到日志中，建议设置为1或者更短。</p>
<p>​                                 重启服务器</p>
<p>​                                         #systemctl  restart  mysqld</p>
<p>​                 查看慢查询日志文件</p>
<p>​                         #ll &#x2F;var&#x2F;lib&#x2F;mysql&#x2F;<em>slow</em></p>
<p>​                                 查看日志文件已经生成</p>
<p>​                 模拟慢查询</p>
<p>​                         mysql&gt;SELECT BENCHMARK(500000000,2*3);</p>
<p>​                                 基本测试语句，测试一个超长时间的查询。</p>
<p>​                                 课后作业：收集数据库压力测试工具信息。（面试题）</p>
<p>​                 验证慢查询日志</p>
<p>​                         #tail &#x2F;var&#x2F;lib&#x2F;mysql&#x2F;localhost-slow.log</p>
<p>​                                 观察长查询日志记录，记录了刚才超长的查询结果。</p>
<h2 id="备份："><a href="#备份：" class="headerlink" title="备份："></a>备份：</h2><ol>
<li><h4 id="Percona-xtrabackup"><a href="#Percona-xtrabackup" class="headerlink" title="Percona-xtrabackup:"></a><strong>Percona-xtrabackup:</strong></h4></li>
</ol>
<p> 它是开源免费的支持MySQL 数据库热备份的软件，它能对InnoDB和XtraDB存储引擎的数据库非阻塞地备份。它不暂停服务创建Innodb热备份；</p>
<p> 为mysql做增量备份；在mysql服务器之间做在线表迁移；使创建replication更加容易；备份mysql而不增加服务器的负载。</p>
<p>​     percona是一家老牌的mysql技术咨询公司。它不仅提供mysql的技术支持、培训、咨询，还发布了mysql的分支版本–percona Server。并围绕</p>
<p> percona Server还发布了一系列的mysql工具。 </p>
<p> 官方站点</p>
<p>​         <a target="_blank" rel="noopener" href="https://www.percona.com/">https://www.percona.com/</a></p>
<p> YUM安装percona-xtrabackup</p>
<p>​         yum -y install percona-xtrabackup-24.x86_64</p>
<p>​                 安装percona</p>
<p>​                 本地RPM</p>
<p>​                         percona-xtrabackup24.rpm.zip</p>
<p> 查询安装结果</p>
<p>​         rpm -ql percona-xtrabackup-24 </p>
<ul>
<li><strong>1-1.完全备份流程：</strong></li>
</ul>
<p>​      (1.)#innobackupex  –user&#x3D;root --password&#x3D;‘QianFeng@123’  &#x2F;xtrabackup&#x2F;full   连接数据库开始备份</p>
<p>​      (2.)#ls  &#x2F;xtrabackup&#x2F;full   查看备份目录。</p>
<p>​      (3.)#ls  &#x2F;xtrabackup&#x2F;full&#x2F;2024-05-16_00-00-06&#x2F;   数据库，配置文件，日志文件</p>
<p>​     (4.)#cat &#x2F;xtrabackup&#x2F;full&#x2F;2024-05-16_00-00-07&#x2F;xtrabackup_binglog_info  观察二进制文件日志位置</p>
<ul>
<li><strong>1-2.完全恢复流程：</strong></li>
</ul>
<p>​     （1.）#systemctl   stop  mysqld    停止数据库</p>
<p>​     （2.）#rm  -rf   &#x2F;var&#x2F;lib&#x2F;mysql&#x2F;*   清理环境   模拟环境损坏 #rm -rf   &#x2F;var&#x2F;log&#x2F;mysqld.log</p>
<p>​     （3.）#innobackupex  –apply-log &#x2F;xtrabackup&#x2F;full&#x2F;2024-05-16_00-00-06      生成回滚日志</p>
<p>​    （4.）#innobackupex –copy-back  &#x2F;xtrabackup&#x2F;full&#x2F;20224-05-16_00-00-08      恢复文件</p>
<p>​    （5.）登录验证：</p>
<p>​        #ls  &#x2F;var&#x2F;lib&#x2F;mysql</p>
<p>​       #chown  -R  mysql.mysql  &#x2F;var&#x2F;lib&#x2F;mysql</p>
<p>​       #systemctl  start  mysqld</p>
<p>​       #mysql -uroot -p’ 密码’</p>
<ul>
<li><strong>2-1.增量备份流程</strong>：</li>
</ul>
<p>​     (1.)#准备工作，创数据库，创表，插入数据</p>
<p>   （2.)周一完整备份：</p>
<p>​      #date  09010000   指定时间</p>
<p>​     #innobackupex  –user&#x3D;root  --password&#x3D;‘QianFeng@123’   &#x2F;xtrabackup    备份</p>
<p>​    #ll  &#x2F;xtrabackup&#x2F;      能看到2024-xx-xx_xx-xx-xx</p>
<p> （3.）周二增量备份</p>
<p>​     #date   09020000  更新时间</p>
<p>​     #mysql -uroot -p‘QainFeng@123’  -e  ‘insert  into  testdb.test  values(2)’</p>
<p>​    #innobackupex  –user&#x3D;root  --pasword&#x3D;‘QianFeng@123’  –incremental &#x2F;xtrabackup   –incremental-basedir&#x3D;&#x2F;xtrabackup&#x2F;2024-xx-xx_xx-xx-xx</p>
<p>  basedir基于周一的备份会生成一个今天的</p>
<p>​    #ls  &#x2F;xtrabackup&#x2F;   查看备份</p>
<p> （4.）周三增量备份</p>
<p>​      #date  09030000</p>
<p>​      #mysql  -uroot -p‘QianFeng@123’  -e  ‘insert  into  testdb.test  values(3)’</p>
<p>​     #innobackupex  –user&#x3D;root  --password&#x3D;‘QianFeng@123’  –incremental  &#x2F;xtrabackup&#x2F;  –incremental-basedir&#x3D;&#x2F;xtrabackup&#x2F;2024-xx-xx_xx-xx-xx</p>
<p>  basedir基于周二的备份生成一个今天的</p>
<p>​     #ls   &#x2F;xtrabackup&#x2F;    查看备份</p>
<ul>
<li><p><strong>2-2增量备份恢复：</strong></p>
<p> #systemctl  stop  mysqld   停止数据库</p>
<p> #rm -rf &#x2F;var&#x2F;lib&#x2F;mysql&#x2F;*    清理环境</p>
<p> #innobackupex  –apply-log  –redo-only  &#x2F;xtrabackup&#x2F;周一文件             周一回滚</p>
<p>#innobackupex  –apply-log  –redo-only &#x2F;xtrabckup&#x2F;周一文件   –incremental-dir&#x3D;&#x2F;xtrabackup&#x2F;周二文件   –incremental-dir&#x3D;&#x2F;xtrabackup&#x2F;周三文件      周二周三回滚</p>
</li>
</ul>
<p> #innobackupex  –copy-back  &#x2F;xtrabackup&#x2F;周一文件     恢复</p>
<p> #chown  -R  mysql.mysql  &#x2F;var&#x2F;lib&#x2F;mysql     授权</p>
<p> #systemctl  start  mysqld      启动mysql</p>
<ol>
<li><h4 id="Mysqldump-binlog"><a href="#Mysqldump-binlog" class="headerlink" title="Mysqldump+binlog:"></a><strong>Mysqldump+binlog:</strong></h4></li>
</ol>
<ul>
<li><p><strong>优势</strong></p>
<p> 1 自动记录日志position位置。 （show master  status\G;）</p>
</li>
</ul>
<p>​         2 可用性，一致性        锁表机制。</p>
<ul>
<li><strong>语法</strong></li>
</ul>
<p>​       &gt; mysqldump  -h 服务器  -u用户名  -p密码   数据库名  &gt; 备份文件.sql</p>
<p>​         参数说明:</p>
<p>​         库的范围</p>
<p>​        -A, –all-databases                          所有库</p>
<p>​                 school                                  数据库名</p>
<p>​                 school stu_info t1                  是指school数据库的表stu_info、t1</p>
<p>​        -B, –databases bbs test mysql         #多个数据库</p>
<p>​        –single-transaction                      #InnoDB 一致性 服务可用性</p>
<p>​        –master-data&#x3D;1|2                        #该选项将会记录binlog的日志位置与文件名并追加到文件中，或添加注释高级选项</p>
<p>​    –opt                                          #同时启动各种高级选项</p>
<p>​        -R, –routines                               #备份存储过程和存储函数</p>
<p>​        -F, –flush-logs                             #备份之前刷新日志，截断日志。备份之后新binlog。</p>
<p>​        –triggers                                    #备份触发器</p>
<h4 id="2-3-备份实战"><a href="#2-3-备份实战" class="headerlink" title="2.3 备份实战"></a>2.3 <strong>备份实战</strong></h4><p>​         请准备两套root密码   密码1</p>
<p>​                         QianFeng@123</p>
<p>​          配置到当前数据库中。 密码2</p>
<p>​                         QianFeng@1234</p>
<p>​                                 备用</p>
<p> <strong>1-1  准备库1</strong></p>
<p>​     *注意          请清理掉之前的test库。实验后半部分，需要继续创建test库，避免混淆。</p>
<p>​      创建表testdb1.t1         mysql&gt; select * from testdb1.t1;  插入数据</p>
<p>  +——+</p>
<p>  | id   |</p>
<p>  +——+</p>
<p>  |    1 |</p>
<p>  |    2 |</p>
<p>  |    3 |</p>
<p>  +——+</p>
<p>​      执行备份：      </p>
<p>  [root@localhost ~]# mysqldump -p‘QianFeng@123’ \</p>
<p>​                                –all-databases –single-transaction \</p>
<p>​                            –master-data&#x3D;2 \</p>
<p>​                                –flush-logs \</p>
<blockquote>
<p>​                           &#x2F;backup&#x2F;<code>date +%F-%H</code>-mysql-all.sql</p>
<p>​         master-data&#x3D;2 注释掉日志记录</p>
<p>​        观察备份细节</p>
<p>​                vim &#x2F;backup&#x2F;2016-11-25-14-mysql-all.sql</p>
<p>​                LOCK TABLES <code>user</code> WRITE;</p>
<p>​                        观察各种锁机制，用来保证数据一致性</p>
<p>​                22 CHANGE MASTER TO MASTER_LOG_FILE&#x3D;’localhost-bin.000004’, MASTER_LOG_POS&#x3D;154;</p>
<p>​                        二进制日志截断位置。第22行</p>
<p>​                业务正常推进…</p>
<p>​        备份后的，数据变更行为</p>
<p>​                在testdb2.t2 中插入数据1，2,3；</p>
<p>创testdb3库</p>
<p>切断二进制日志（重启数据库）</p>
</blockquote>
<p>  在testdb2.t2 中插入数据4；</p>
<p>  删testdb3库</p>
<p>  在testdb2.t2 中插入数据 </p>
<p>   mysql&gt; select * from testdb2.t2;</p>
<p>   +——+</p>
<p>   | id   |</p>
<p>   +——+</p>
<p>   |    1 |</p>
<p>   |    2 |</p>
<p>   |    3 |</p>
<p>   +——+</p>
<p>   mysql&gt; show databases;</p>
<p>   +——————–+</p>
<p>   | Database           |</p>
<p>   +——————–+</p>
<p>   | testdb1            |</p>
<p>   | testdb2            |</p>
<p>   +——————–+</p>
<p>  12 rows in set (0.00 sec)</p>
<p>  mysql&gt; </p>
<p>  <strong>1-2 执行备份</strong></p>
<p>​          [root@localhost ~]# mysqldump -p‘QianFeng@123’ \</p>
<p>  –all-databases –single-transaction \</p>
<p>   –master-data&#x3D;2 \</p>
<p>  –flush-logs \</p>
<p>  &#x2F;backup&#x2F;<code>date +%F-%H</code>-mysql-all.sql</p>
<p>   <strong>1-3 观察备份细节</strong>     </p>
<blockquote>
<p>​        vim &#x2F;backup&#x2F;2016-11-25-14-mysql-all.sql</p>
<p>​        LOCK TABLES <code>user</code> WRITE;</p>
<p>​                观察各种锁机制，用来保证数据一致性</p>
<p>​        22 CHANGE MASTER TO MASTER_LOG_FILE&#x3D;’localhost-bin.000004’, MASTER_LOG_POS&#x3D;154;</p>
<p>​                二进制日志截断位置。第22行</p>
<p>业务正常推进… master-data&#x3D;2 注释掉日志记录  </p>
<p><strong>1-4  备份后的，数据变更行为</strong></p>
<p>​        在testdb2.t2 中插入数据1，2,3；</p>
<p>创testdb3库</p>
<p>切断二进制日志（重启数据库）</p>
<p>在testdb2.t2 中插入数据4；</p>
<p>删testdb3库</p>
<p>在testdb2.t2 中插入数据5；</p>
<p> mysql&gt; select * from testdb2.t2;</p>
<p>+——+</p>
<p>| id   |</p>
<p>+——+</p>
<p>|    1 |</p>
<p>|    2 |</p>
<p>|    3 |</p>
<p>+——+</p>
<p>mysql&gt; show databases;</p>
<p>+——————–+</p>
<p>| Database           |</p>
<p>+——————–+</p>
<p>| testdb1            |</p>
<p>| testdb2            |</p>
<p>+——————–+</p>
<p>12 rows in set (0.00 sec)</p>
<p>mysql&gt;   </p>
</blockquote>
<h4 id="2-4-恢复实战"><a href="#2-4-恢复实战" class="headerlink" title="2.4 恢复实战"></a>2.4 恢复实战</h4><p>​        1 备份二进制日志文件</p>
<p>​                cp &#x2F;var&#x2F;lib&#x2F;mysql&#x2F;<em>bin</em> ~</p>
<p>​        \2. 停止数据库</p>
<p>​                systemctl stop mysqld</p>
<p>​        \3. 清理环境</p>
<p>​                rm -rf &#x2F;var&#x2F;lib&#x2F;mysql&#x2F;*</p>
<p>​        \4. 启动数据库</p>
<p>​                systemctl start mysqld</p>
<p>​                grep ‘password’ &#x2F;var&#x2F;log&#x2F;mysqld.log</p>
<p>​                        找密码，再改一下密码。请使用密码2      Kyzw;u2dq&lt;mh</p>
<p>​                        mysqladmin -uroot -p’Kyzw;u2dq&lt;mh’ password ‘QianFeng@1234’</p>
<p>​                        注意</p>
<p>​                                语法要求password后面有空格。</p>
<p>​        \5. mysql恢复数据</p>
<p>​                 mysql -p‘QianFeng@1234’ &lt; &#x2F;backup&#x2F;2016-12-08-04-mysql-all.sql</p>
<p>​                mysql -p‘QianFeng@1234’ -e ‘flush privileges’</p>
<p>​                        请使用备份时密码</p>
<p>​                登陆并验证数据恢复结果。请思考恢复的数据库有几个？</p>
<p>​                        1个</p>
<p>​        \6. 二进制日志恢复</p>
<p>​                观察二进制截取记录</p>
<p>​                        vim &#x2F;backup&#x2F;2016-11-25-14-mysql-all.sql</p>
<p>​                        CHANGE MASTER TO MASTER_LOG_FILE&#x3D;’localhost-bin.0000010’, MASTER_LOG_POS&#x3D;154;</p>
<p>​      恢复二进制日志     mysqlbinlog localhost-bin.000002 localhost-bin.000003</p>
<p>​                                       –start-position&#x3D;154  | mysql -p‘QianFeng@123’</p>
<p>​                注意后续有多少日志，要跟多少日志名字。</p>
<p>​        7.观察数据</p>
<p>​                请思考数据是否恢复完整。    是完整的。</p>
<p>​        8.请思考误删除的问题</p>
<p>​                如何保留testdb3库</p>
<p>​                        [root@localhost ~]#mysqlbinlog  localhost-bin.00004      ……005…..006…… &gt; 1.txt</p>
<p>​                        删除1.txt中不需要的at（比如test3库是误操作）</p>
<p>​                        cat  1.txt | mysql -p‘QianFeng@123’</p>
<p>​                课后题：是否可以通过mysqlbinlog start 和stop 命令解决。</p>
<p>​        9.关于数据恢复时的多余日志。</p>
<p>​             方法一</p>
<p>​                 原因</p>
<p>​                      每次还原数据库都会增加日志的体积。但这些都是还原操作。恢复数据库的日志占用了存储空间。</p>
<p>​                        mysql&gt;  set sql_log_bin &#x3D;0                         再mysql&gt;  source   &#x2F;backup&#x2F;*.sql</p>
<p>​                 观察           二进制日志并没有发生变化。</p>
<p>​             方法2</p>
<p>​                        在备份文件中，加入关闭二进制日志。</p>
<h2 id="集群"><a href="#集群" class="headerlink" title="集群"></a>集群</h2><ol>
<li><h4 id="集群技术"><a href="#集群技术" class="headerlink" title="集群技术"></a>集群技术</h4></li>
</ol>
<p>集群目的</p>
<p><img src="https://hqrchvz3h42.feishu.cn/space/api/box/stream/download/asynccode/?code=Njg0MzlhZTFhYzgwNDVkNDAxYzc1MzZkOTNmNjRkNTBfUmE2dHh6SkRzRUdJQ1JpYkc0Q3NUbDBxbGtTZVJCbU9fVG9rZW46WnVmamJ5anc3b0l0SWt4Z1ZTcmNZNUNEbkplXzE3MTk3MTk1MjE6MTcxOTcyMzEyMV9WNA" srcset="/img/loading.gif" lazyload alt="img"></p>
<p>​        负载均衡          解决高并发</p>
<p>​        高可用HA         服务可用性</p>
<p>​        远程灾备         数据有效性</p>
<p>集群原理</p>
<p><img src="https://hqrchvz3h42.feishu.cn/space/api/box/stream/download/asynccode/?code=NGI4NGZhNTMzNGEyNjVmNGI1NmZiOGFlODdkOWM1N2JfS2RzbFFTcnNvdzdmNzd6YzFFeXVoRlRYeURYcHhhZ1ZfVG9rZW46WDlOd2JZT1Eyb0dXUWN4a0ptRmNvMUlHbm9lXzE3MTk3MTk1MjE6MTcxOTcyMzEyMV9WNA" srcset="/img/loading.gif" lazyload alt="img"></p>
<p>概念</p>
<p>​        \1. 在主库上把数据更改（DDL DML DCL）记录到二进制日志（Binary Log）中。</p>
<p>​        \2. 备库I&#x2F;O线程将主库上的日志复制到自己的中继日志（Relay Log）中。</p>
<p>​        \3. 备库SQL线程读取中继日志中的事件，将其重放到备库数据库之上。</p>
<p><strong>1-1 集群案例</strong></p>
<p>环境</p>
<p><strong>一. 环境三部曲</strong></p>
<p>​        1.全新服务器-互相通信</p>
<p>​        2.全新安装mysql57-逐一安装</p>
<p>​        3.配置域名解析                        </p>
<p>​    4.请重新安装多台数据库，不要克隆已经安装的数据库。因为数据库的ID相同。</p>
<p>​    5.可以使用host文件的形式，也可以使用DNS服务器解析</p>
<p><strong>二. 一主一从（M-S）(1)</strong></p>
<p>主(master1)：</p>
<p>1.部署一台新mysql服务器。准备好域名解析。</p>
<p>2.准备数据1（验证主从同步使用）   master1</p>
<p>​     create database master1db;</p>
<p>​     create table master1db.master1tab(name char(50));</p>
<p>​     insert into master1db.master1tab values (1111);</p>
<p>​     insert into master1db.master1tab values (2222);</p>
<p>3.开启二进制日志      master1</p>
<p>​     [root@localhost ~]# vim &#x2F;etc&#x2F;my.cnf</p>
<p>​                log_bin</p>
<p>​                server-id&#x3D;1</p>
<p>​     [root@localhost ~]# systemctl restart mysqld</p>
<p>​                  重启生效</p>
<p>4.创建复制用户       master1</p>
<p>​     &gt; grant replication slave, replication  client on <em>.</em> to ‘192.168.39.%’  identified by ‘QianFeng@123’;</p>
<p>5.备份master数据库的数据       master1</p>
<p>​    &gt; mysqldump -p‘QianFeng@123’ –all-databases –single-transaction –master-data&#x3D;2 –flush-logs &gt; <code>date +%F</code>-mysql-all.sql</p>
<p>​    # scp -r 2020-1-1-mysql-all.sql master2:&#x2F;tmp     发送给另一台主机</p>
<p>vim 观察二进制日志分割点       CHANGE MASTER TO MASTER_LOG_FILE&#x3D;’localhost-bin.000002’,             MASTER_LOG_POS&#x3D;154;</p>
<p>6.准备数据2（验证主从同步使用）    master1</p>
<p> &gt; insert into master1db.master1tab values (33333333);</p>
<p> &gt; insert into master1db.master1tab values (44444);</p>
<p>从(master2):</p>
<ol>
<li>测试rep用户是否可用    master2</li>
</ol>
<p>​     部署数据库应用     mysql -h master1 -urep -p‘QianFeng@123’</p>
<p>​     预防账户问题。</p>
<ol>
<li>启动服务器序号</li>
</ol>
<p>​     [root@localhost ~]#vim &#x2F;etc&#x2F;my.cnf</p>
<p>​      不用在从设备上开启二进制日志，没有人向master2请求日志。</p>
<p>​      server-id&#x3D;2     服务器ID是必须设置的。</p>
<p>​     [root@localhost ~]# systemctl restart mysqld</p>
<p>​      mysql -uroot -p‘QianFeng@123’    </p>
<p>​    测试服务器是否修改正确。能否正常登陆。</p>
<ol>
<li>手动同步数据</li>
</ol>
<p>​        mysql&gt;  set sql_log_bin&#x3D;0;</p>
<p>​        mysql&gt;  source &#x2F;tmp&#x2F;2020-1-1-mysql-full.sql</p>
<ol>
<li>设置主服务器</li>
</ol>
<p>​        mysql&gt; change master to</p>
<p>​                   master_host&#x3D;’master1’,</p>
<p>​                   master_user&#x3D;’rep’,</p>
<p>​                   master_password&#x3D;‘QianFeng@123’,</p>
<p>​                   master_log_file&#x3D;’localhost-bin.000002’,</p>
<p>​                   master_log_pos&#x3D;154;</p>
<p>​                注意，二进制日志的位置，应该参照主服务器备份时生成的新位置。</p>
<ol>
<li>启动从设备</li>
</ol>
<p>​                  mysql&gt; start slave;</p>
<ol>
<li>查看启动状态（IO-YES&#x2F;SQL-YES）</li>
</ol>
<p>​        show slave status\G;</p>
<p>​                mysql&gt; show slave status\G;</p>
<p>*************************** 1. row ***************************</p>
<p>​               Slave_IO_State: Waiting for master to send event</p>
<p>​                  Master_Host: master1</p>
<p>​                  Master_User: rep</p>
<p>​                  Master_Port: 3306</p>
<p>​                Connect_Retry: 60</p>
<p>​              Master_Log_File: localhost-bin.000003</p>
<p>​          Read_Master_Log_Pos: 154</p>
<p>​               Relay_Log_File: localhost-relay-bin.000003</p>
<p>​                Relay_Log_Pos: 375</p>
<p>​        Relay_Master_Log_File: localhost-bin.000003</p>
<p>​             Slave_IO_Running: Yes</p>
<p>​            Slave_SQL_Running: Yes</p>
<ol>
<li>返回主服务器（master1）更新数据，在从服务器（master2）观察是否同步。</li>
</ol>
<p><strong>三. 一主一从（M-S）(2)</strong></p>
<p>​      需求   实验2与上一个实验需求基本相同经。master1 作为主mysql，master2 作为从mysql。</p>
<p>不同之处，使用了</p>
<p>​      “gtid_mode&#x3D;ON</p>
<p>​       enforce_gtid_consistency&#x3D;1”</p>
<p>该属性自动记录position位置。不需要手动指定了。</p>
<ul>
<li>环境</li>
</ul>
<p>​                因与实验1功能相同</p>
<p>​                请重置master2数据库</p>
<p>​                        systemctl stop mysqld</p>
<p>​                        rm -rf &#x2F;var&#x2F;lib&#x2F;mysql&#x2F;*</p>
<p>​                        systemctl start mysqld</p>
<p>​                        grep password &#x2F;var&#x2F;log&#x2F;mysqld.log</p>
<p>​                         mysqladmin -p’VsudOt+g%5Nw’ password ‘QianFeng@123’</p>
<ol>
<li><strong>主</strong></li>
</ol>
<p>​      启动二进制日志，服务器ID，GTID</p>
<p>​       #vim &#x2F;etc&#x2F;my.cnf</p>
<p>​          log_bin</p>
<p>​          server-id&#x3D;1</p>
<p>​          gtid_mode&#x3D;ON</p>
<p>​          enforce_gtid_consistency&#x3D;1</p>
<p>​       #systemctl restart mysqld</p>
<ol>
<li>授权复制用户rep（略）</li>
</ol>
<p>​         &gt; grant replication slave,replication client on <em>.</em> to ‘rep‘@’192.168.39.%’ identified by ‘QianFeng@123’;</p>
<p>​         &gt; flush privileges;</p>
<ol>
<li>备份数据</li>
</ol>
<p>​        &gt; mysqldump -p‘QianFeng@123’ –all-databases –single-transaction –master-data&#x3D;2 –flush-logs &gt; <code>date +%F-%H</code>-mysql-all.sql</p>
<p>​         master-data&#x3D;2设置为2，已经不需要这个标记了。</p>
<p>​        # scp 2020-1-1-mysql-all.sql    master2:&#x2F;tmp    复制</p>
<ol>
<li>模拟数据变化</li>
</ol>
<p>​         &gt; insert into master1db.master1tab values (6666666666);</p>
<p> <strong>从</strong></p>
<ol>
<li>测试rep用户是否可用    master2</li>
</ol>
<p>​         &gt; mysql -h master1 -urep -p‘QianFeng@123’</p>
<p>​               预防账户问题。    注意防火墙应该关闭</p>
<ol>
<li>启动二进制日志，服务器ID，GTID</li>
</ol>
<p>​                  #vim &#x2F;etc&#x2F;my.cnf</p>
<p>​           log_bin</p>
<p>​           server-id&#x3D;2</p>
<p>​          gtid_mode&#x3D;ON</p>
<p>​          enforce_gtid_consistency&#x3D;1</p>
<p>​                #systemctl restart mysqld</p>
<p>​    测试配置是否有问题，如果启动失败。请检查配置。</p>
<ol>
<li>还恢复手动同步数据</li>
</ol>
<p>​              &gt; set sql_log_bin&#x3D;0;</p>
<p>​              &gt; source &#x2F;tmp&#x2F;2020-1-1-mysql-full.sql</p>
<p>​              &gt; select * from master1db.master1tab;</p>
<p>​      该实验的关键效果即将出现。</p>
<ol>
<li>设置主服务器</li>
</ol>
<p>mysql&gt; change master to</p>
<p> master_host&#x3D;’master1’,</p>
<p> master_user&#x3D;’rep’,</p>
<p> master_password&#x3D;‘QianFeng@123’,</p>
<p> master_auto_position&#x3D;1;</p>
<p>​       注意，和前一个实验比少了两行</p>
<p>mysql&gt; change master to</p>
<p> master_host&#x3D;’master1’,</p>
<p> master_user&#x3D;’rep’,</p>
<p> master_password&#x3D;‘QianFeng@123’,</p>
<p> master_log_file&#x3D;’localhost-bin.000002’,</p>
<p> master_log_pos&#x3D;154;</p>
<p>mysql&gt; start slave;</p>
<p>mysql&gt; show slave status\G;</p>
<p>返回主服务器（master1）更新数据，在从服务器（master2）观察是否同步。</p>
<p><strong>四. 双主双从（MM-SS）</strong></p>
<p><strong>一. 双主（MM</strong>）</p>
<p>​                前言</p>
<p>​                        前面的实验，主服务器单节点设置。假如主服务器故障会影响全局的写入事件。</p>
<p>​                        故设置双主。</p>
<p>​                        目前：已经设置master1为master2的主服务器，</p>
<p>​                        只需设置master2为master1的主服务器，</p>
<ol>
<li>设置master2为master1的主服务器</li>
</ol>
<p>​      在master2 上进行授权：</p>
<p>​     mysql&gt; grant replication slave, replication  client on <em>.</em> to ‘rep‘@’192.168.2.%’  identified by ‘QianFeng@123’;</p>
<p>​     mysql&gt; flush privileges;</p>
<ol>
<li>在master1上：</li>
</ol>
<p>​     mysql&gt; change master to</p>
<p>​            master_host&#x3D;’master2’,</p>
<p>  master_user&#x3D;’rep’,</p>
<p>  master_password&#x3D;‘QianFeng@123’,</p>
<p>  master_auto_position&#x3D;1;</p>
<p>​    mysql&gt; start slave;</p>
<p>​    mysql&gt; show slave status\G;</p>
<ol>
<li><p>如果状态不佳，重启一下master2的mysqld    再去master2上。启动和停止从属状态。</p>
<p>mysql&gt; start slave;</p>
<p>mysql&gt; stop slave;</p>
<p>测试</p>
</li>
</ol>
<p> master1上插入数据，在master2上观察</p>
<p> master2上插入数据，在master1上观察</p>
<p>  双方同步成功，双主设置完成。</p>
<p><strong>二. 双从（SS</strong>）</p>
<ol>
<li>同步现有数据库     master1</li>
</ol>
<p> mysql&gt; mysqldump -p‘QianFeng@123’ –all-databases –single-transaction –master-data&#x3D;2  –flush-logs &gt; <code>date +%F</code>-mysql-all.sql</p>
<p>  # scp -r 2020-1-1-mysql-all.sql slave1:&#x2F;tmp</p>
<p>  # scp -r 2020-1-1-mysql-all.sql slave2:&#x2F;tmp</p>
<p> 在  slave1上</p>
<p> # mysql -p‘QianFeng@123’ &lt; &#x2F;tmp&#x2F;2020-1-1-mysql-all.sql</p>
<p> 在 slave2上</p>
<p>#mysql -p‘QianFeng@123’ &lt; &#x2F;tmp&#x2F;2020-1-1-mysql-all.sql</p>
<ol>
<li>启动从服务器ID，gtid</li>
</ol>
<p>在 slave1 上</p>
<p>​     #vim &#x2F;etc&#x2F;my.cnf</p>
<p>server-id&#x3D;3</p>
<p>gtid_mode&#x3D;ON</p>
<p>enforce_gtid_consistency&#x3D;1</p>
<p>master-info-repository&#x3D;TABLE</p>
<p>relay-log-info-repository&#x3D;TABLE</p>
<p>​                                        从机把主的信息存在主信息仓库里。主信息库可以是文件也可以上表，具体由—master-info-repository参数值决定。—master-info-repository＝file时 会生成master.info 和 relay-log.info2个文件，如果—master-info-repository＝table，信息就会存在mysql.master_slave_info表中。</p>
<p>​     #systemctl restart mysqld</p>
<p> 在slave2上 </p>
<p>  #vim &#x2F;etc&#x2F;my.cnf</p>
<p>   server-id&#x3D;4</p>
<p>gtid_mode&#x3D;ON</p>
<p>enforce_gtid_consistency&#x3D;1</p>
<p>master-info-repository&#x3D;TABLE</p>
<p>relay-log-info-repository&#x3D;TABLE</p>
<p>​    #systemctl restart mysqld</p>
<ol>
<li>设置主服务器</li>
</ol>
<p> 在slave1上</p>
<p>mysql&gt; change master to</p>
<p> master_host&#x3D;’master1’,</p>
<p> master_user&#x3D;’rep’,</p>
<p> master_password&#x3D;‘QianFeng@123’,</p>
<p> master_auto_position&#x3D;1 for channel ‘master1’;</p>
<p>mysql&gt; change master to</p>
<p> master_host&#x3D;’master2’,</p>
<p> master_user&#x3D;’rep’,</p>
<p> master_password&#x3D;‘QianFeng@123’,</p>
<p> master_auto_position&#x3D;1 for channel ‘master2’;</p>
<p>mysql&gt; start slave;</p>
<p>mysql&gt; show slave status\G;</p>
<p>在slave2上</p>
<p>mysql&gt; change master to</p>
<p> master_host&#x3D;’master1’,</p>
<p> master_user&#x3D;’rep’,</p>
<p> master_password&#x3D;‘QianFeng@123’,</p>
<p> master_auto_position&#x3D;1 for channel ‘master1’;</p>
<p>mysql&gt; change master to</p>
<p> master_host&#x3D;’master2’,</p>
<p> master_user&#x3D;’rep’,</p>
<p> master_password&#x3D;‘QianFeng@123’,</p>
<p> master_auto_position&#x3D;1 for channel ‘master2’;</p>
<p>mysql&gt; start slave;</p>
<p>mysql&gt; show slave status\G;</p>
<ol>
<li>测试</li>
</ol>
<p>​                        master1 插入数据</p>
<p>​                        master2插入数据</p>
<p>​                        slave1查看</p>
<p>​                        slave2查看</p>
<ol>
<li>错误示例：</li>
</ol>
<p>暂时无法在飞书文档外展示此内容</p>
<ol>
<li><h4 id="代理技术"><a href="#代理技术" class="headerlink" title="代理技术"></a>代理技术</h4></li>
</ol>
<p>功能</p>
<p>​        \1. 读写分离　M-S-S  M-M-S-S</p>
<p>​        \2. 负载均衡   Galera Cluster</p>
<p>​        \3. 支持数据的分片自动路由与聚合               </p>
<p><img src="https://hqrchvz3h42.feishu.cn/space/api/box/stream/download/asynccode/?code=YmUxZjg2ZGYzM2Y5NDRjZjE4ZmRhNGUzOGJiNDgyNDBfajE0bExocHRtbkYxYjZtM2ZhSVU2aUp6RFNzWDh1VWdfVG9rZW46RTZTcWJvQ0hYb25vS0x4VDZQZ2NaVU9FbjFlXzE3MTk3MTk1MjE6MTcxOTcyMzEyMV9WNA" srcset="/img/loading.gif" lazyload alt="img"></p>
<p><strong>Mycat 实战</strong></p>
<p>​       \1. 架构</p>
<p>​                请准备好域名解析</p>
<p>​                MyCat</p>
<p>​                        10.18.43.163  mycat</p>
<p>​                 M-M-S-S</p>
<p>​                        10.18.43.41 master1</p>
<p>​                        10.18.43.170 master2</p>
<p>​                        192.168.0.116 slave1</p>
<p>​                        192.168.0.117 slave2</p>
<p>​        2.案例1</p>
<p><strong>一、配置 Java环境</strong></p>
<p>​         下载jdk图示</p>
<p><img src="https://hqrchvz3h42.feishu.cn/space/api/box/stream/download/asynccode/?code=NzRhOThhYjI2NzMxYzhhYzRlOTc1ZGUzNGVkMDZhY2NfNmQweXU4RzhtZmRxUExIRUswUmJTYVNFUU15akJRQ0JfVG9rZW46TVNkOWJBTzhtb1NSVHR4VjFQVWNlTm9hbnJjXzE3MTk3MTk1MjE6MTcxOTcyMzEyMV9WNA" srcset="/img/loading.gif" lazyload alt="img"></p>
<p>#tar xf jdk-8u91-linux-x64.tar.gz -C &#x2F;usr&#x2F;local&#x2F;      解压java软件开发工具包</p>
<p>#ln -s &#x2F;usr&#x2F;local&#x2F;jdk1.8.0_91&#x2F; &#x2F;usr&#x2F;local&#x2F;java        创建软连接java</p>
<p>#vim   &#x2F;etc&#x2F;profile</p>
<p>​           JAVA_HOME&#x3D;&#x2F;usr&#x2F;local&#x2F;java</p>
<p> PATH&#x3D;$JAVA_HOME&#x2F;bin:$PATH</p>
<p> export JAVA_HOME PATH</p>
<p>  添加三行     设置JAVA变量，便于JAVA调用</p>
<p>​     #source &#x2F;etc&#x2F;profile   更新立刻生效</p>
<p>​     #env |grep JAVA        查看与java相关的变量</p>
<p>​     #java     -version        查询到版本。说明jdk安装成功</p>
<p><strong>二、配置Mycat</strong></p>
<p>​    下载mycat           <a target="_blank" rel="noopener" href="http://www.mycat.org.cn/">http://www.mycat.org.cn/</a></p>
<p>​    # wget <a target="_blank" rel="noopener" href="http://dl.mycat.org.cn/1.6-RELEASE/Mycat-server-1.6-RELEASE-20161028204710-linux.tar.gz">http://dl.mycat.org.cn/1.6-RELEASE/Mycat-server-1.6-RELEASE-20161028204710-linux.tar.gz</a></p>
<p>   解压      # tar xf  Mycat-server-1.6-RELEASE-20161028204710-linux.tar.gz -C &#x2F;usr&#x2F;local&#x2F;</p>
<p>   查看      # ls &#x2F;usr&#x2F;local&#x2F;mycat&#x2F;</p>
<ol>
<li>配置mycat前端</li>
</ol>
<p>​               # vim  &#x2F;usr&#x2F;local&#x2F;mycat&#x2F;conf&#x2F;server.xml</p>
<p><img src="https://hqrchvz3h42.feishu.cn/space/api/box/stream/download/asynccode/?code=YzY2M2IzN2UxMzlmZWM0MjA2YjY1MzdhMTY1NGUxYjFfVElBWWdnRUhubnlqTU5sTkRHM21DNUhNeElVN21OWEVfVG9rZW46S1VlTWJTTFlVb2I0Qzh4aDNIMmMwdm5zblZlXzE3MTk3MTk1MjE6MTcxOTcyMzEyMV9WNA" srcset="/img/loading.gif" lazyload alt="img"></p>
<p>注释掉多余用户 95行-99行</p>
<p><img src="https://hqrchvz3h42.feishu.cn/space/api/box/stream/download/asynccode/?code=YmVlOTIwYjZkNWUzMTJmOWU2NDc2N2JiNmQ3YTYzNDVfOHVtcjc0ZERSVWNzZGpMWHFxVmY5czBlcUcwYlJTa2dfVG9rZW46SUJaaGJ0dHdwb1l5N2t4dkZoSmNsQXI0bk5mXzE3MTk3MTk1MjE6MTcxOTcyMzEyMV9WNA" srcset="/img/loading.gif" lazyload alt="img"></p>
<p>​      启动mycat管理员</p>
<ol>
<li>配置mycat后端</li>
</ol>
<p>​     请备份该文件</p>
<p> # vim  &#x2F;usr&#x2F;local&#x2F;mycat&#x2F;conf&#x2F;schema.xml</p>
<p><img src="https://hqrchvz3h42.feishu.cn/space/api/box/stream/download/asynccode/?code=YWI1M2E2MWNjZDczNzU1NWZlMjc4NmJiYTQ1Y2QxNDVfUVZZMGR5TUNwQUdKV0prbWMzdXRESXRaUnpHdFBCbEJfVG9rZW46QzdDZWJ5RVl3b250dWh4dWg5RGNVcUFIblZlXzE3MTk3MTk1MjE6MTcxOTcyMzEyMV9WNA" srcset="/img/loading.gif" lazyload alt="img"></p>
<p> 注释：</p>
<p>schema name：mycat维护的集群名称。</p>
<p>datanode：后方节点群的名称。</p>
<p>datahost：后方节点群的主机名称。</p>
<p>writehost：写主机</p>
<p>readhost：读主机</p>
<p> 倒着看</p>
<p>在本例中switchType值设置为1，表示自动切换，某些对主从数据一致要求较高的场景，建议使用2判断主从状态后再切换</p>
<p>切换的触发条件为主节点mysql服务崩溃或停止</p>
<p>slaveThreshold 主从的延迟在多少秒以内，则把读请求分发到这个从节点，否则不往这个节点分发，假设生产环境能容忍的主从延时为60秒，则设置此值为60，此例中设置值为100</p>
<p>​                        关于属性的介绍</p>
<p>​                                balance 类型</p>
<p>​                                        \1. balance&#x3D;“0”,  关闭读写分离功能。</p>
<p>​                                所有读操作都发送到当前可用的writeHost上。</p>
<p>​                                        \2. balance&#x3D;“1”，开启读写分离</p>
<p>​                        所有读操作都随机的发送到readHost。</p>
<p>​                                writeType 属性</p>
<p>​                                        备份型</p>
<p>​                                                \1. writeType&#x3D;”0”, 所有写操作发送到配置的第一个 writeHost，</p>
<p>第一个挂了切到还生存的第二个writeHost，</p>
<p>重新启动后已切换后的为准，切换记录在配置文件中:dnindex.properties .</p>
<p>​                                        负载型</p>
<p>​                                                \2. writeType&#x3D;”1”，所有写操作都随机的发送到配置的 writeHost。</p>
<p>​                                switchType 模式</p>
<p>​                                        switchType指的是切换的模式，目前的取值也有4种：</p>
<p>​                                        \1. switchType&#x3D;’-1’ 负1表示不自动切换</p>
<p>​                                        \2. switchType&#x3D;’1’ 默认值，表示根据延时自动切换</p>
<p>​                                        \3. switchType&#x3D;’2’ 根据MySQL主从同步的状态决定是否切换,心跳语句为 show slave status</p>
<p><strong>三、配置mysql群</strong></p>
<p>M-M-S-S　准备Mycat连接的用户及权限</p>
<p>例如master1</p>
<p>#grant all on <em>.</em> to ‘mycatproxy‘@’192.168.39.128’ identified by ‘QianFeng@123’;</p>
<p>​         192.168.39.128是mycat服务器的IP</p>
<p><strong>四、启动Mycat</strong></p>
<p> 在mycat服务器上</p>
<p>#&#x2F;usr&#x2F;local&#x2F;mycat&#x2F;bin&#x2F;mycat start</p>
<p>​       Starting Mycat-server…</p>
<p>启动成功，否则就是配置Mycat后端语法错误。</p>
<p>#netstat  -anpt | grep java</p>
<p>​        监测端口是否启动</p>
<p>[root@localhost ~]# netstat  -anpt | grep java</p>
<p> tcp        0      0 127.0.0.1:32000         0.0.0.0:*               LISTEN      3487&#x2F;java           </p>
<p> tcp6       0      0 :::1984                 :::*                    LISTEN      3487&#x2F;java           </p>
<p> tcp6       0      0 :::8066                 :::*                    LISTEN      3487&#x2F;java           </p>
<p> tcp6       0      0 :::59268                :::*                    LISTEN      3487&#x2F;java           </p>
<p> tcp6       0      0 :::9066                 :::*                    LISTEN      3487&#x2F;java           </p>
<p> tcp6       0      0 :::44500                :::*                    LISTEN      3487&#x2F;java           </p>
<p> tcp6       0      0 127.0.0.1:31000         127.0.0.1:32000         ESTABLISHED 3487&#x2F;java                         </p>
<p>#ps aux | grep mycat          检测进程是否启动</p>
<p>[root@localhost ~]# ps aux | grep mycat</p>
<p> root       3485  0.0  0.1  17812   808 ?        Sl   23:36   0:00 &#x2F;usr&#x2F;local&#x2F;mycat&#x2F;bin&#x2F;.&#x2F;wrapper-linux-x86-64 &#x2F;usr&#x2F;local&#x2F;mycat&#x2F;conf&#x2F;wrapper.conf wrapper.syslog.ident&#x3D;mycat wrapper.pidfile&#x3D;&#x2F;usr&#x2F;local&#x2F;mycat&#x2F;logs&#x2F;mycat.pid wrapper.daemonize&#x3D;TRUE wrapper.lockfile&#x3D;&#x2F;var&#x2F;lock&#x2F;subsys&#x2F;mycat</p>
<p> root       3487  4.0 35.4 6473184 172568 ?      Sl   23:36   0:03 java -DMYCAT_HOME&#x3D;. -server -XX:MaxPermSize&#x3D;64M -XX:+AggressiveOpts -XX:MaxDirectMemorySize&#x3D;2G -Dcom.sun.management.jmxremote -Dcom.sun.management.jmxremote.port&#x3D;1984 -Dcom.sun.management.jmxremote.authenticate&#x3D;false -Dcom.sun.management.jmxremote.ssl&#x3D;false -Xmx4G -Xms1G -Djava.library.path&#x3D;lib -classpath lib&#x2F;wrapper.jar:conf:lib&#x2F;zookeeper-3.4.6.jar:lib&#x2F;jline-0.9.94.jar:lib&#x2F;ehcache-core-2.6.11.jar:lib&#x2F;log4j-1.2.17.jar:lib&#x2F;fastjson-1.2.12.jar:lib&#x2F;curator-client-2.11.0.jar:lib&#x2F;joda-time-2.9.3.jar:lib&#x2F;log4j-slf4j-impl-2.5.jar:lib&#x2F;libwrapper-linux-x86-32.so:lib&#x2F;netty-3.7.0.Final.jar:lib&#x2F;druid-1.0.26.jar:lib&#x2F;log4j-api-2.5.jar:lib&#x2F;mapdb-1.0.7.jar:lib&#x2F;slf4j-api-1.6.1.jar:lib&#x2F;univocity-parsers-2.2.1.jar:lib&#x2F;hamcrest-core-1.3.jar:lib&#x2F;Mycat-server-1.6-RELEASE.jar:lib&#x2F;objenesis-1.2.jar:lib&#x2F;leveldb-api-0.7.jar:lib&#x2F;hamcrest-library-1.3.jar:lib&#x2F;wrapper.jar:lib&#x2F;commons-lang-2.6.jar:lib&#x2F;reflectasm-1.03.jar:lib&#x2F;mongo-java-driver-2.11.4.jar:lib&#x2F;guava-19.0.jar:lib&#x2F;curator-recipes-2.11.0.jar:lib&#x2F;curator-framework-2.11.0.jar:lib&#x2F;libwrapper-linux-ppc-64.so:lib&#x2F;log4j-core-2.5.jar:lib&#x2F;leveldb-0.7.jar:lib&#x2F;sequoiadb-driver-1.12.jar:lib&#x2F;mysql-binlog-connector-java-0.4.1.jar:lib&#x2F;kryo-2.10.jar:lib&#x2F;jsr305-2.0.3.jar:lib&#x2F;commons-collections-3.2.1.jar:lib&#x2F;disruptor-3.3.4.jar:lib&#x2F;log4j-1.2-api-2.5.jar:lib&#x2F;velocity-1.7.jar:lib&#x2F;libwrapper-linux-x86-64.so:lib&#x2F;dom4j-1.6.1.jar:lib&#x2F;minlog-1.2.jar:lib&#x2F;asm-4.0.jar -Dwrapper.key&#x3D;cECV31vA3vcZHrvr -Dwrapper.port&#x3D;32000 -Dwrapper.jvm.port.min&#x3D;31000 -Dwrapper.jvm.port.max&#x3D;31999 -Dwrapper.pid&#x3D;3485 -Dwrapper.version&#x3D;3.2.3 -Dwrapper.native_library&#x3D;wrapper -Dwrapper.service&#x3D;TRUE -Dwrapper.cpu.timeout&#x3D;10 -Dwrapper.jvmid&#x3D;1 org.tanukisoftware.wrapper.WrapperSimpleApp io.mycat.MycatStartup star</p>
<p>  # yum install -y mariadb         安装客户端</p>
<p>​     # mysql -hmycat -uroot -p123456 -P8066</p>
<p>​                  &gt; show databases;</p>
<p>MySQL [(none)]&gt; show databases;</p>
<p> +———-+</p>
<p>  | DATABASE |</p>
<p>  +———-+</p>
<p> | tianyun  |</p>
<p> +———-+</p>
<p>1 row in set (0.01 sec)</p>
<p>看到的数据库是虚拟的。     注意后方mysql群中应该创建该库</p>
<p>在mysql-master1上创库创表</p>
<p>​     &gt; create database  tianyun;</p>
<p>​     &gt; create table tianyun.t1 (id int);</p>
<p><strong>五、Mycat使用后方数据库</strong></p>
<p>​       在mycat上</p>
<p>  mariadb&gt; select * from tianyun.t1;</p>
<p>  mariadb&gt; insert into tianyun.t1 values(3);</p>
<p>  在mysql集群能 查询到数据。实验完成。</p>
<p>案例2</p>
<p><img src="https://hqrchvz3h42.feishu.cn/space/api/box/stream/download/asynccode/?code=MGNhMjlhZWMyNzg2MzRlNzQ4MjZmOTU5N2M4ZDk4NWVfVnVkeVcxeHdFTXR2TDk4S0pEY29zbkVwZXVpRVBwanBfVG9rZW46Qk5Pb2JQVG5Tb0tNeWd4cVZvb2M0TGs5bmdoXzE3MTk3MTk1MjE6MTcxOTcyMzEyMV9WNA" srcset="/img/loading.gif" lazyload alt="img"></p>
<p><img src="https://hqrchvz3h42.feishu.cn/space/api/box/stream/download/asynccode/?code=NGYzNGQzYmM1YTJhYzYxY2NhZDQ1ODEwNTI5ZTJjZThfZDlQVER3UXh4cEVNTzF2cEpYVkp2TzRtYTkwdDQ3VnhfVG9rZW46SjFrU2I5QmVGb2k3Vnl4MmhFUmNnVlZUbjRjXzE3MTk3MTk1MjE6MTcxOTcyMzEyMV9WNA" srcset="/img/loading.gif" lazyload alt="img"></p>
<p>​       多库时如何设置mycat</p>
<ol>
<li><h1 id="第二阶段shell编程"><a href="#第二阶段shell编程" class="headerlink" title="第二阶段shell编程"></a>第二阶段shell编程</h1></li>
</ol>
<h3 id="shell变量"><a href="#shell变量" class="headerlink" title="shell变量"></a>shell变量</h3><h4 id="一-自定义变量"><a href="#一-自定义变量" class="headerlink" title="一.自定义变量"></a><strong>一.自定义变量</strong></h4><p>定义变量：变量名&#x3D;变量值  变量名必须以字母或下划线开头，区分大小写</p>
<p>引用变量：$变量名   或者    ${变量名}</p>
<p>查看变量： echo $变量名：”set”可以查看所有变量（包括自定义变量和环境变量）</p>
<p>取消变量：unset  变量名</p>
<p>作用范围：仅在当前shell中有效</p>
<p>例子：</p>
<p>[localhost~]# vim  ping.sh</p>
<p>#! &#x2F;usr&#x2F;bin&#x2F;env bash</p>
<p>  # 脚本声明，蛇帮</p>
<p>ip&#x3D;192.168.160.129</p>
<p> # 变量名&#x3D;变量值  &#x3D;：赋值</p>
<p>ping -c1 -w1 $ip  &amp;&gt; &#x2F;dev&#x2F;null &amp;&amp; echo “$ip 通的” ||  echo “$ip 不通”</p>
<p> # $变量名：调用，变量不调用默认不生效</p>
<p>echo 默认只输出一段内容，所以要加””</p>
<p> # -c1：  ping一次    -w1：ping一秒</p>
<p>[localhost~]#chmod u+x ping.sh</p>
<p>[localhost~]#bash  ping.sh</p>
<p><strong>1.2 shell多种执行方式</strong></p>
<p>执行1：bash      ping.sh</p>
<p>执行2：sh         ping.sh</p>
<p>执行3：.           ping.sh</p>
<p>执行4：source    ping.sh</p>
<p>1和2是子shell：开一个子shell环境在里面执行脚本，执行结束时退出子shell,自身位置不会发生改变</p>
<p>3和4是本shell：在当前shell环境执行，执行完之后位置会发生改变</p>
<p><strong>1.3显式赋值</strong>：</p>
<p>变量名&#x3D;”变量值”   不进行结果输出，引号里的作为结果输出</p>
<p>变量名&#x3D;<code>变量值</code>   强引用，会去掉里面所有字符的含义，将命令的结果作为输出</p>
<p>变量名&#x3D;$(变量值)   将命令的结果作为输出</p>
<p>例子：</p>
<p>  # ip1&#x3D;”date +%F”</p>
<p>  # echo $ip1</p>
<p>​     date +%F</p>
<p> # ip1&#x3D;<code>date +%F</code></p>
<p> # echo $ip1</p>
<p>​      2024-06-08</p>
<p>   # ip1&#x3D;$(date +%F)</p>
<p>   # echo $ip1</p>
<p>  2024-06-08</p>
<p><strong>1.4隐式赋值：</strong></p>
<p> read   -p(print打印)  “提示信息：”   变量名</p>
<p> read   -t(time时间)  5  -p  “提示信息：”  变量名     -t  5   等待5秒，退出</p>
<p> read   -n  2  变量名      &#x2F;&#x2F;-n  只记录几个字符</p>
<p>例子：</p>
<p>#  vim  ping.sh</p>
<p>#!&#x2F;bin&#x2F;bash</p>
<p>read   -p    “请输入测试的ip：”   ip</p>
<p>ping -c1 -w1 $ip  &amp;&gt; &#x2F;dev&#x2F;null &amp;&amp; echo “$ip 通的” ||  echo “$ip 不通”</p>
<p><strong>1.5三种引号的区别</strong>：</p>
<p>“  “     双引号：弱引用，一般只会去掉空格</p>
<p>‘   ‘     单引号： 强引用，会去掉所有字符含义</p>
<p><code>  </code>     反引号：优先执行   等同$()</p>
<p>例子：</p>
<p># school&#x3D;1000phone</p>
<p># echo “$school  is  good”</p>
<p>1000phone  is  good</p>
<p># echo ‘$school  is  good’</p>
<p>$school  is  good</p>
<p># echo  <code>date +%F</code></p>
<p>2024-06-08</p>
<p># echo “date +%F”</p>
<p>date +%F</p>
<h4 id="二-环境变量"><a href="#二-环境变量" class="headerlink" title="二.环境变量"></a><strong>二.环境变量</strong></h4><p>定义环境变量：方法一： export     变量名&#x3D;变量值</p>
<p>​            方法二： # 变量值&#x3D;变量名     # export   变量名   将自定义变量转换成环境变量</p>
<p>引用环境变量： $变量名或${变量名}</p>
<p>查看环境变量：echo  $变量名  env   例如env |变量名</p>
<p>取消环境变量： unset  变量名</p>
<p>变量作用范围： 在当前shell和子shell有效</p>
<p>&#x2F;etc&#x2F;profile    环境变量文件，系统启动时进行加载</p>
<p> #  env    查看环境变量</p>
<p>例子：</p>
<p>[root@localhost ~]# bbb&#x3D;123</p>
<p>[root@localhost ~]# export  bbb</p>
<p>[root@localhost ~]# echo $bbb</p>
<p>123</p>
<p>[root@localhost ~]# export  ccc&#x3D;3.1415926</p>
<p>[root@localhost ~]# echo $ccc</p>
<p>3.1415926</p>
<p>[root@localhost ~]# vim &#x2F;etc&#x2F;profile</p>
<p>export   aaa&#x3D;hello</p>
<p>重启生效</p>
<p>[root@localhost ~]# echo  $aaa</p>
<p>hello</p>
<h4 id="三-位置变量和预定义变量"><a href="#三-位置变量和预定义变量" class="headerlink" title="三.位置变量和预定义变量"></a>三.位置变量和预定义变量</h4><p>位置变量</p>
<p>​        命令     参数1 参数2 参数3 ….9以后特殊定义</p>
<p>$$0     $$1 $2 $3 $4 $5 $6 $7 $8 $9  …位置变量</p>
<p>​        命令     参数1 参数2 参数3 ….9以后特殊定义</p>
<p>$0      $1 $2 $3 $4 $5 $6 $7 $8 $9  …</p>
<p>[root@loaclhost]#  vim   test.sh</p>
<p>#!&#x2F;bin&#x2F;bash</p>
<p>echo “第1个位置参数是$1”</p>
<p>echo “第2个位置参数是$2”</p>
<p>echo “第3个位置参数是$3”</p>
<p>echo “第4个位置参数是$4”</p>
<p>echo “第5个位置参数是$5”</p>
<p>echo “第6个位置参数是$6”</p>
<p>echo “第7个位置参数是$7”</p>
<p>echo “第8个位置参数是$8”</p>
<p>echo “所有的参数是     $*”</p>
<p>echo “所有的参数是     $@”</p>
<p>echo “参数的个数是     $#”</p>
<p>echo “当前进程的pid是  $$”</p>
<p>echo “进程的名字是 ：  $0” </p>
<p>[root@localhost ~]# bash   test.sh   11  22 88 66 44 55 66</p>
<p>第1个位置参数是11</p>
<p>第2个位置参数是22</p>
<p>第3个位置参数是88</p>
<p>第4个位置参数是66</p>
<p>第5个位置参数是44</p>
<p>第6个位置参数是55</p>
<p>第7个位置参数是66</p>
<p>第8个位置参数是</p>
<p>所有的参数是     11 22 88 66 44 55 66</p>
<p>所有的参数是     11 22 88 66 44 55 66</p>
<p>参数的个数是     7</p>
<p>当前进程的pid是  1305</p>
<p>进程的名字是 ：  test.sh</p>
<p>shell编程</p>
<p>​        完成一些重复度高的工作</p>
<p>​        完成一些周期性工作  shell+crontab</p>
<p>​        预定任务        监控+执行预定脚本</p>
<p> 把你完成一个事情的一系列命令，写入文件</p>
<p> 同时要考虑意外发生</p>
<p> 1-1 输入输出重定向</p>
<p>​         &gt;输出覆盖 &gt;&gt;输出追加  &amp;&gt;混合输出 &amp;&gt;&gt;</p>
<p>​         &lt;输入</p>
<p>​         0 1 2 3+</p>
<p>​         0  标准输入</p>
<p>​         1  标准输出</p>
<p>​         2  错误输出</p>
<p>​         3+ 文件名</p>
<p> 1-2 ; 顺序关系  &amp;&amp; 逻辑与  || 逻辑或</p>
<p> cmd1 &amp;           放后台运行</p>
<p> cmd1 &amp;&amp; cmd2     逻辑运算 当命令1执行成功，才执行命令2</p>
<p> cmd1 &amp;&gt; a.txt    将命令1的输出，都写入到a.txt</p>
<p> ;  &amp;&amp;  ||</p>
<p> cmd1 ; cmd2        命令1执行后，执行命令2 两者之间无逻辑关系，只有顺序关系</p>
<p> cmd1 &amp;&amp; cmd2       只有当命令1执行成功，才会执行命令2</p>
<p> cmd1 || cmd2       只有当命令1执行失败，才会执行命令2</p>
<p> 当一个命令的返回值为0，则命令执行成功</p>
<p> 如果返回非0，则命令执行失败</p>
<p> ; &amp;&amp; || 关联关系，让命令会称为一个整体</p>
<p> &amp;&amp; 都成功，才算成功</p>
<p> || 有一个成功，就算成功</p>
<p>比如：</p>
<p>1、cmd1 &amp;&amp; cmd2 || cmd3</p>
<p>cmd1执行成功，cmd2执行失败，cmd3是否执行</p>
<p>​        cmd1 &amp;&amp; cmd2 整体是失败     cmd3执行 </p>
<p>cmd1执行成功，cmd2执行成功，cmd3是否执行</p>
<p>​        cmd1 &amp;&amp; cmd2 整体是成功     cmd3不执行</p>
<p>​        </p>
<p>2、cmd1 || cmd2 &amp;&amp; cmd3</p>
<p>cmd1执行成功，cmd2执行失败，cmd3是否执行</p>
<p>​        cmd1 || cmd2 整体是成功   cmd3执行</p>
<p>cmd1执行成功，cmd2执行成功，cmd3是否执行</p>
<p>​        cmd1 || cmd2 整体是成功   cmd3执行</p>
<p>​        </p>
<p>cmd1执行失败 cmd2失败  cmd3不执行</p>
<p> #     $?</p>
<p>​        0成功</p>
<p>​        非0 失败</p>
<p>创建文件并写入内容</p>
<p> # cat a.txt</p>
<p>aa</p>
<p>bb</p>
<p>cc</p>
<p>手动的方式</p>
<p> # vim a.txt</p>
<p>aa</p>
<p>bb</p>
<p>cc</p>
<p>创建一个文件并写入指定内容</p>
<p>cat &gt; &#x2F;tmp&#x2F;a.txt  &lt;&lt;-EOF</p>
<p>aa</p>
<p>bb</p>
<p>cc</p>
<p>EOF</p>
<p>&#x2F;etc            该目录用来存放配置文件</p>
<p>sysconfig       系统配置</p>
<p>network-script  网络-脚本</p>
<p>ifcfg           interface-configure 网络-配置文件</p>
<p>cat &gt; &#x2F;etc&#x2F;sysconfig&#x2F;network-scripts&#x2F;ifcfg-ens33  &lt;&lt;-EOF</p>
<p>TYPE&#x3D;”Ethernet”</p>
<p>BOOTPROTO&#x3D;static</p>
<p>DEFROUTE&#x3D;”yes”</p>
<p>DEVICE&#x3D;ens33</p>
<p>ONBOOT&#x3D;”yes”</p>
<p>IPADDR&#x3D;192.168.81.133</p>
<p>NETMASK&#x3D;255.255.255.0</p>
<p>GATEWAY&#x3D;192.168.81.2</p>
<p>DNS1&#x3D;223.5.5.5</p>
<p>DNS2&#x3D;8.8.8.8</p>
<p>EOF</p>
<h1 id="4-第四阶段大型网站架构"><a href="#4-第四阶段大型网站架构" class="headerlink" title="4.第四阶段大型网站架构"></a>4.第四阶段大型网站架构</h1><h2 id="一-nginx"><a href="#一-nginx" class="headerlink" title="一.nginx"></a>一.nginx</h2><h4 id="1-配置yum源-官方源-www-nginx-org-yum-install-y-yum-utils-vim-etc-yum-repos-d-nginx-repo-nginx-stable-name-nginx-stable-repo-baseurl-http-nginx-org-packages-centos-releasever-basearch-gpgcheck-1-enabled-1-gpgkey-https-nginx-org-keys-nginx-signing-key-nginx-mainline-name-nginx-mainline-repo-baseurl-http-nginx-org-packages-mainline-centos-releasever-basearch-gpgcheck-1-enabled-0-gpgkey-https-nginx-org-keys-nginx-signing-key-yum-list-grep-nginx-yum-install-y-nginx-systemctl-start-nginx-systemctl-enable-nginx"><a href="#1-配置yum源-官方源-www-nginx-org-yum-install-y-yum-utils-vim-etc-yum-repos-d-nginx-repo-nginx-stable-name-nginx-stable-repo-baseurl-http-nginx-org-packages-centos-releasever-basearch-gpgcheck-1-enabled-1-gpgkey-https-nginx-org-keys-nginx-signing-key-nginx-mainline-name-nginx-mainline-repo-baseurl-http-nginx-org-packages-mainline-centos-releasever-basearch-gpgcheck-1-enabled-0-gpgkey-https-nginx-org-keys-nginx-signing-key-yum-list-grep-nginx-yum-install-y-nginx-systemctl-start-nginx-systemctl-enable-nginx" class="headerlink" title="1.配置yum源  官方源 www.nginx.org`#  yum install  -y  yum-utils #  vim  &#x2F;etc&#x2F;yum.repos.d&#x2F;nginx.repo     [nginx-stable]        name&#x3D;nginx stable repo        baseurl&#x3D;http://nginx.org/packages/centos/$releasever/$basearch/        gpgcheck&#x3D;1        enabled&#x3D;1        gpgkey&#x3D;https://nginx.org/keys/nginx_signing.key    [nginx-mainline]        name&#x3D;nginx mainline repo        baseurl&#x3D;http://nginx.org/packages/mainline/centos/$releasever/$basearch/        gpgcheck&#x3D;1        enabled&#x3D;0        gpgkey&#x3D;https://nginx.org/keys/nginx_signing.key          #    yum list |grep nginx #    yum   install  -y  nginx  #    systemctl   start   nginx #    systemctl   enable  nginx&#96;"></a><strong>1.配置yum源</strong>  官方源 <a target="_blank" rel="noopener" href="http://www.nginx.org`/#">www.nginx.org`#</a>  yum install  -y  yum-utils #  vim  &#x2F;etc&#x2F;yum.repos.d&#x2F;nginx.repo     [nginx-stable]        name&#x3D;nginx stable repo        baseurl&#x3D;<a target="_blank" rel="noopener" href="http://nginx.org/packages/centos/$releasever/$basearch/">http://nginx.org/packages/centos/$releasever/$basearch/</a>        gpgcheck&#x3D;1        enabled&#x3D;1        gpgkey&#x3D;<a target="_blank" rel="noopener" href="https://nginx.org/keys/nginx_signing.key">https://nginx.org/keys/nginx_signing.key</a>    [nginx-mainline]        name&#x3D;nginx mainline repo        baseurl&#x3D;<a target="_blank" rel="noopener" href="http://nginx.org/packages/mainline/centos/$releasever/$basearch/">http://nginx.org/packages/mainline/centos/$releasever/$basearch/</a>        gpgcheck&#x3D;1        enabled&#x3D;0        gpgkey&#x3D;<a target="_blank" rel="noopener" href="https://nginx.org/keys/nginx_signing.key">https://nginx.org/keys/nginx_signing.key</a>          #    yum list |grep nginx #    yum   install  -y  nginx  #    systemctl   start   nginx #    systemctl   enable  nginx&#96;</h4><h4 id="2-nginx的配置文件-rpm-ql-nginx"><a href="#2-nginx的配置文件-rpm-ql-nginx" class="headerlink" title="2.nginx的配置文件#  rpm -ql nginx"></a><strong>2.nginx的配置文件</strong><code>#  rpm -ql nginx</code></h4><p>​          &#x2F;etc&#x2F;logrotate.d&#x2F;nginx                          日志轮转</p>
<p>​          &#x2F;etc&#x2F;nginx&#x2F;nginx.conf                           总配置文件</p>
<p>​          &#x2F;etc&#x2F;nginx&#x2F;conf.d                                 子配置文件夹</p>
<p>​          &#x2F;etc&#x2F;nginx&#x2F;conf.d&#x2F;default.conf                默认的网站配置文件</p>
<p>​            &#x2F;etc&#x2F;nginx&#x2F;koi-utf                                 字符集，文件编码</p>
<p>​          &#x2F;etc&#x2F;nginx&#x2F;win-utf</p>
<p>​          &#x2F;etc&#x2F;nginx&#x2F;koi-win</p>
<p>​          &#x2F;etc&#x2F;nginx&#x2F;mime.types                          文件关联程序网站文件类型 和 相关处理程序</p>
<p>​          &#x2F;etc&#x2F;nginx&#x2F;modules                               模块文件夹。第三方模块</p>
<p>​          &#x2F;etc&#x2F;sysconfig&#x2F;nginx</p>
<p>​                  # Configuration file for the nginx service.</p>
<p>​                  NGINX&#x3D;&#x2F;usr&#x2F;sbin&#x2F;nginx</p>
<p>​                  CONFFILE&#x3D;&#x2F;etc&#x2F;nginx&#x2F;nginx.conf</p>
<p>​          &#x2F;etc&#x2F;sysconfig&#x2F;nginx-debug</p>
<p>​                  # Configuration file for the nginx-debug service.</p>
<p>​                  NGINX&#x3D;&#x2F;usr&#x2F;sbin&#x2F;nginx-debug</p>
<p>​                  CONFFILE&#x3D;&#x2F;etc&#x2F;nginx&#x2F;nginx.conf</p>
<p>​                  LOCKFILE&#x3D;&#x2F;var&#x2F;lock&#x2F;subsys&#x2F;nginx-debug</p>
<p>​          &#x2F;usr&#x2F;lib&#x2F;systemd&#x2F;system&#x2F;nginx-debug.service            nginx调试程序启动脚本</p>
<p>​          &#x2F;usr&#x2F;lib&#x2F;systemd&#x2F;system&#x2F;nginx.service systemctl         服务脚本。</p>
<p>​          &#x2F;usr&#x2F;sbin&#x2F;nginx                            主程序</p>
<p>​          &#x2F;usr&#x2F;sbin&#x2F;nginx-debug                   nginx调试程序</p>
<p>​          &#x2F;usr&#x2F;share&#x2F;doc&#x2F;nginx-1.12.1           文档</p>
<p>​          &#x2F;usr&#x2F;share&#x2F;doc&#x2F;nginx-1.12.1&#x2F;COPYRIGHT</p>
<p>​          &#x2F;usr&#x2F;share&#x2F;man&#x2F;man8&#x2F;nginx.8.gz      man 手册</p>
<p>​          &#x2F;usr&#x2F;share&#x2F;nginx</p>
<p>​          &#x2F;usr&#x2F;share&#x2F;nginx&#x2F;html</p>
<p>​          &#x2F;usr&#x2F;share&#x2F;nginx&#x2F;html&#x2F;50x.html</p>
<p>​          &#x2F;usr&#x2F;share&#x2F;nginx&#x2F;html&#x2F;index.html        默认主页</p>
<p>​          &#x2F;var&#x2F;cache&#x2F;nginx                               缓存各种</p>
<p>​                  ls &#x2F;var&#x2F;cache&#x2F;nginx&#x2F;</p>
<p>​                          client_temp fastcgi_temp proxy_temp scgi_temp uwsgi_temp</p>
<p>​          &#x2F;var&#x2F;log&#x2F;nginx                                  日志文件夹</p>
<p>​                 #  ls &#x2F;var&#x2F;log&#x2F;nginx&#x2F;access.log  或 error.log</p>
<p>​          &#x2F;usr&#x2F;lib64&#x2F;nginx                               Nginx模块目录</p>
<h4 id="3-nginx-V-nginx编译模块"><a href="#3-nginx-V-nginx编译模块" class="headerlink" title="3.nginx -V     nginx编译模块"></a><strong>3.nginx -V     nginx编译模块</strong></h4><p>​       </p>
<p>​          configure arguments:                                     配置参数.&#x2F;configure –help查询帮助</p>
<p>​          –prefix&#x3D;&#x2F;etc&#x2F;nginx                                        安装路径</p>
<p>​          –sbin-path&#x3D;&#x2F;usr&#x2F;sbin&#x2F;nginx                            程序文件</p>
<p>​          –modules-path&#x3D;&#x2F;usr&#x2F;lib64&#x2F;nginx&#x2F;modules        模块路径</p>
<p>​          –conf-path&#x3D;&#x2F;etc&#x2F;nginx&#x2F;nginx.conf                   主配置文件</p>
<p>​          –error-log-path&#x3D;&#x2F;var&#x2F;log&#x2F;nginx&#x2F;error.log          错误日志</p>
<p>​          –http-log-path&#x3D;&#x2F;var&#x2F;log&#x2F;nginx&#x2F;access.log         访问日志</p>
<p>​          –pid-path&#x3D;&#x2F;var&#x2F;run&#x2F;nginx.pid                          程序ID</p>
<p>​          –lock-path&#x3D;&#x2F;var&#x2F;run&#x2F;nginx.lock                       锁路径，防止重复启动nginx</p>
<p>​          –http-client-body-temp-path&#x3D;&#x2F;var&#x2F;cache&#x2F;nginx&#x2F;client_temp     缓存</p>
<p>​          –http-proxy-temp-path&#x3D;&#x2F;var&#x2F;cache&#x2F;nginx&#x2F;proxy_temp             代理缓存</p>
<p>​          –http-fastcgi-temp-path&#x3D;&#x2F;var&#x2F;cache&#x2F;nginx&#x2F;fastcgi_temp           php缓存</p>
<p>​          –http-uwsgi-temp-path&#x3D;&#x2F;var&#x2F;cache&#x2F;nginx&#x2F;uwsgi_temp             python缓存</p>
<p>​          –http-scgi-temp-path&#x3D;&#x2F;var&#x2F;cache&#x2F;nginx&#x2F;scgi_temp</p>
<p>​          –with-compat                                                                   启用动态模块兼容性</p>
<p>​          –user&#x3D;nginx                                                                     用户</p>
<p>​          –group&#x3D;nginx                                                                   组</p>
<p>​          –with-file-aio                                                                    使用nginx的aio特性会大大提高性能，比                     如图片站的特点是大量的读io操作，nginx aio不用等待每次io的结果，有助于并发处理大量io和                      提高nginx处理效率。</p>
<p>​                      aio的优点就是能够同时提交多个io请求给内核，然后直接由内核的io调度算法去处理这些请求                        (directio)，这样的话，内核就有可能执行一些合并，节约了读取文件的处理时间。</p>
<p>​                      就是异步非阻塞</p>
<p>​          –with-threads                                                                   多线程模块</p>
<p>​         –with-http_addition_module                                               响应之前或者之后追加文本内容</p>
<p>   –with-http_auth_request_module                                        认证模块</p>
<p>​            –with-http_dav_module    增加上传PUT,DELETE,MKCOL:创建集合,COPY和MOVE方法)默认情况下为关闭</p>
<p>​       –with-http_flv_module                                                       NGINX 添加MP4、FLV视频支持模块</p>
<p>​       –with-http_gunzip_module                                                   压缩模块</p>
<p>​         –with-http_gzip_static_module</p>
<p>​        –with-http_mp4_module                                                     多媒体模块</p>
<p>​        –with-http_random_index_module                                   nginx显示随机首页模块</p>
<p>​        –with-http_realip_module                                               Nginx获取真实IP模块</p>
<p>​        –with-http_secure_link_module                                        nginx安全下载模块</p>
<p>​        –with-http_slice_module                                                  nginx中文文档</p>
<p>​        –with-http_ssl_module                                                     安全模块</p>
<p>​        –with-http_stub_status_module                                         访问状态</p>
<p>​        –with-http_sub_module                                                    nginx替换网站响应内容</p>
<p>​        –with-http_v2_module</p>
<p>​        –with-mail                                                                      邮件客户端</p>
<p>​        –with-mail_ssl_module</p>
<p>   –with-stream                 负载均衡模块。nginx从1.9.0开始，新增加了一个stream模块，用来实现四层协议      的转发、代理或者负载均衡等。</p>
<h4 id="4-nginx的基本配置文件"><a href="#4-nginx的基本配置文件" class="headerlink" title="4.nginx的基本配置文件"></a><strong>4.nginx的基本配置文件</strong></h4><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs Markdown"><span class="hljs-section"># vim  /etc/nginx/nginx.conf</span><br></code></pre></td></tr></table></figure>

<p> <strong>4-1.主配置文件  ：3个部分组成</strong></p>
<ul>
<li><strong>核心模块（进程数等）         coremodule</strong></li>
<li><strong>事件驱动模块（工作模块）   eventsmodule</strong></li>
<li><strong>网站模块，http内核模块       httpcoremodule</strong></li>
</ul>
<p> <strong>1.核心模块</strong></p>
<p> user  nginx;     用户</p>
<p> worker_processes   1;     默认启动几个nginx服务，与cpu数量相同</p>
<p> error_log  &#x2F;var&#x2F;log&#x2F;nginx&#x2F;error.log   warn;    错误日志位置     warn ：日志格式</p>
<p> Pid  &#x2F;var&#x2F;run&#x2F;nginx.pid;      进程编号</p>
<p> <strong>2.事件驱动模块</strong>     </p>
<p>  events {                                        事件</p>
<p> worker_connections     10240;     可以同时为多少人服务</p>
<p> }</p>
<p> <strong>3.网站模块</strong></p>
<p>http  {</p>
<p>include    &#x2F;etc&#x2F;nginx&#x2F;mirn.type;       &#x2F;&#x2F;程序相关文件</p>
<p>default_type  application&#x2F;octet-stream;  &#x2F;&#x2F;字节流处理方式，以字节的形式读取信息</p>
<p>log_format main  ‘$remote_addr - $remote_user [$time_local] “$request” ‘</p>
<p>​                               ‘$status $body_bytes_sent “$http_referer” ‘</p>
<p>​                               ‘“$http_user_agent” “$http_x_forwarded_for”‘; &#x2F;&#x2F;日志格式定义</p>
<p>‘“$http_user_agent” “$http_x_forwarded_for”‘;           &#x2F;&#x2F;日志格式</p>
<p>access_log  &#x2F;var&#x2F;log&#x2F;nginx&#x2F;access.log main;              &#x2F;&#x2F;访问日志</p>
<p>sendfile      on;                &#x2F;&#x2F;加速nginx访问</p>
<p>#tcp_nopush   on;           &#x2F;&#x2F;优化nginx访问</p>
<p>keepalive_timeout     65;    &#x2F;&#x2F;长连接</p>
<p>#gzip       on;                  &#x2F;&#x2F;压缩</p>
<p>include     &#x2F;etc&#x2F;nginx&#x2F;conf.d&#x2F;*.conf       &#x2F;&#x2F;子配置文件</p>
<p>  }</p>
<p><strong>nginx子配置文件</strong></p>
<figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><code class="hljs Markdown"><span class="hljs-section"># vim  /etc/nginx/conf.d/default.conf       //子配文件</span><br>server &#123;                                    //虚拟主机<br><span class="hljs-code">    listen    80;                           //端口</span><br><span class="hljs-code">    server_name  localhost;                 //域名</span><br><span class="hljs-code">    #charset   koi8-r                       //字符集</span><br><span class="hljs-code">    #access_log  /var/log/nginx/host.access.log  main;   //日志位置</span><br><span class="hljs-code">    location / &#123;                            //网站网页</span><br><span class="hljs-code">        root  /usr/share/nginx/html;        //默认网页</span><br><span class="hljs-code">        index   index.html;                 //默认主页文件名</span><br><span class="hljs-code">    &#125;</span><br><span class="hljs-code">    </span><br><span class="hljs-code">    </span><br><span class="hljs-code">    #error_page  404              /404.html;  //错误页面</span><br><span class="hljs-code">    # redirect server error pages to the static page /50x.html</span><br><span class="hljs-code">    </span><br><span class="hljs-code">    error_page   500 502 503 504  /50x.html;  //错误页面</span><br><span class="hljs-code">    location = /50x.html &#123;                    //错误页面</span><br><span class="hljs-code">        root   /usr/share/nginx/html;         //错误页面主目录</span><br><span class="hljs-code">    &#125; </span><br><span class="hljs-code">    </span><br><span class="hljs-code">                                     </span><br><span class="hljs-code"># proxy the PHP scripts to Apache listening on 127.0.0.1:80   //代理设置</span><br><span class="hljs-code">#location ~ \.php$ &#123;</span><br><span class="hljs-code"># proxy_pass http://127.0.0.1;</span><br><span class="hljs-code">#&#125;</span><br><span class="hljs-code"># pass the PHP scripts to FastCGI server listening on 127.0.0.1:9000   //动态网站设置</span><br><span class="hljs-code">#location ~ \.php$ &#123;</span><br><span class="hljs-code"># root html;</span><br><span class="hljs-code"># fastcgi_pass 127.0.0.1:9000;</span><br><span class="hljs-code"># fastcgi_index index.php;</span><br><span class="hljs-code"># fastcgi_param SCRIPT_FILENAME /scripts$fastcgi_script_name;</span><br><span class="hljs-code"># include fastcgi_params;</span><br><span class="hljs-code">#&#125;</span><br><span class="hljs-code"># deny access to .htaccess files, if Apache&#x27;s document root            //访问控制部分</span><br><span class="hljs-code"># concurs with nginx&#x27;s one</span><br><span class="hljs-code">#location ~ /\.ht &#123;</span><br><span class="hljs-code"># deny all;</span><br><span class="hljs-code">#&#125;</span><br><span class="hljs-code">&#125;</span><br><span class="hljs-code">&#125;</span><br></code></pre></td></tr></table></figure>

<p><strong>4-2.nginx的基本配置</strong></p>
<p>创建一个新的子配</p>
<figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><code class="hljs Markdown"><span class="hljs-section">#  vim  /etc/nginx/conf.d/xulei.conf</span><br>server &#123;<br><span class="hljs-code">    listen  80;</span><br><span class="hljs-code">    server_name  xulei.com;</span><br><span class="hljs-code">    location  / &#123;</span><br><span class="hljs-code">        root   /xulei;</span><br><span class="hljs-code">        index  index.html;</span><br><span class="hljs-code">    &#125;</span><br><span class="hljs-code">&#125;</span><br><span class="hljs-code"></span><br><span class="hljs-section">#  mkdir  /xulei</span><br><span class="hljs-section">#  echo &quot;测试&quot; &gt; /xulei/index.html</span><br><span class="hljs-section">#  systemctl restart nginx</span><br>win上域名解析访问 xulei.com<br></code></pre></td></tr></table></figure>

<h4 id="5-nginx日志log"><a href="#5-nginx日志log" class="headerlink" title="5.nginx日志log"></a>5.nginx日志log</h4><p>相关指令</p>
<p>​        log_format                    日志格式</p>
<p>​        access_log                    访问日志</p>
<p>​        error_log                       错误日志</p>
<p>​        open_log_file_cache        日志缓存</p>
<p>​       open_log_file_cache  max&#x3D;N [inactive&#x3D;time]  [mim_uses&#x3D;N]  [valid&#x3D;time]  | off</p>
<p> 该指令默认是禁止的，等同于:</p>
<p> open_log_file_cache off;</p>
<p> <strong>5-1. log_format  日志格式</strong></p>
<figure class="highlight nginx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs Nginx"><span class="hljs-comment">#  vim   /etc/nginx/nginx.conf</span><br><span class="hljs-attribute">log_format</span>  main  <span class="hljs-string">&#x27;<span class="hljs-variable">$remote_addr</span> - <span class="hljs-variable">$remote_user</span> [<span class="hljs-variable">$time_local</span>] &quot;<span class="hljs-variable">$request</span>&quot; &#x27;</span><br>                      <span class="hljs-string">&#x27;<span class="hljs-variable">$status</span> <span class="hljs-variable">$body_bytes_sent</span> &quot;<span class="hljs-variable">$http_referer</span>&quot; &#x27;</span><br>                      <span class="hljs-string">&#x27;&quot;<span class="hljs-variable">$http_user_agent</span>&quot; &quot;<span class="hljs-variable">$http_x_forwarded_for</span>&quot;&#x27;</span>;   <br></code></pre></td></tr></table></figure>

<p>$remote_addr,                                 &#x2F;&#x2F;远程地址： 记录客户端IP地址</p>
<p>$remote_user                                 &#x2F;&#x2F;远程用户：记录客户端用户名称</p>
<p>[$time_local]                                 &#x2F;&#x2F;本地时间：服务器自身时间</p>
<p>$request                                      &#x2F;&#x2F;请求：记录请求的URL和HTTP协议      &#x2F;&#x2F;“GET &#x2F;1.html HTTP&#x2F;1.1” 或 “GET &#x2F;index.html HTTP&#x2F;1.1”</p>
<p>$status                                        &#x2F;&#x2F;状态：记录请求状态   200  404  503  100  301</p>
<p>$body_bytes_sent                        &#x2F;&#x2F;发送给客户端的字节数，不包括响应头的大小</p>
<p>$http_referer                              &#x2F;&#x2F;记录从哪个页面链接访问过来的  （超链接）</p>
<p>$http_user_agent                        &#x2F;&#x2F;记录客户端浏览器相关信息     火狐    IE</p>
<p>$http_x_forwarded_for                &#x2F;&#x2F;代理IP</p>
<p><strong>5-2. access_log  访问日志</strong></p>
<p>例如：一条日志记录</p>
<p>192.168.100.254 - - [17&#x2F;Dec&#x2F;2017:14:45:59 +0800] “GET &#x2F;nginx-logo.png HTTP&#x2F;1.1” 200 368 “<a target="_blank" rel="noopener" href="http://192.168.100.10/">http://192.168.100.10/</a>“ “Mozilla&#x2F;5.0 (Windows NT 6.1; WOW64; rv:57.0) Gecko&#x2F;20100101 Firefox&#x2F;57.0” “-“</p>
<p>某条日志记录含义</p>
<p>​        192.168.100.254                                                                     远程主机IP</p>
<p>​     -（分隔符） -                                                                         用户</p>
<p>​         [（分隔符）17&#x2F;Dec&#x2F;2017:14:45:59 +0800（分隔符）]                 时间</p>
<p>​        “(分隔符) GET                                                                         获得，下载，还有post提交。</p>
<p>​         &#x2F;nginx-logo.png                                                                     下载图片</p>
<p>​        HTTP&#x2F;1.1（分隔符）”                                                               版本</p>
<p>​        200     空格作为分隔符                                                            状态码 什么结果</p>
<p>​        368     空格作为分隔符                                                            大小</p>
<p>​        “（分隔符）<a target="_blank" rel="noopener" href="http://192.168.100.10/%EF%BC%88%E5%88%86%E9%9A%94%E7%AC%A6%EF%BC%89">http://192.168.100.10/（分隔符）</a>“                  引用自哪个连接，主页<a target="_blank" rel="noopener" href="http://192.168.100.10/">http://192.168.100.10/</a></p>
<p>​        “（分隔符）Mozilla 5.0                                                          浏览器的版本</p>
<p>​        Windows NT   （分隔符）”                                                     客户端系统类型</p>
<p>​        “（分隔符）-（分隔符）”                                                    远程客户端主机地址  （请看注释）</p>
<p><strong>5-3. error_log  错误日志</strong></p>
<p>个性404页面</p>
<figure class="highlight nginx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><code class="hljs Nginx"><span class="hljs-comment">#   vim  /etc/nginx/xulei.conf  </span><br><span class="hljs-section">server</span> &#123;<br>    <span class="hljs-attribute">listen</span>  <span class="hljs-number">80</span>;<br>    <span class="hljs-attribute">server_name</span>  xulei.com;<br>    <span class="hljs-section">location</span>  / &#123;<br>        <span class="hljs-attribute">root</span>   /xulei;<br>        <span class="hljs-attribute">index</span>  index.html;<br>    &#125;<br>    <span class="hljs-attribute">error_page</span>  <span class="hljs-number">404</span>   /<span class="hljs-number">404</span>.html;<br>    <span class="hljs-section">location</span> =/<span class="hljs-number">404</span>.html &#123;<br>        <span class="hljs-attribute">root</span>   /xulei<br>    &#125;<br>&#125;<br><span class="hljs-comment">#   vim   /xulei/404.html</span><br>&lt;img  src=<span class="hljs-string">&quot;404.jpg&quot;</span> /&gt;   <span class="hljs-comment">#前提是/xulei下有一张404.jpg</span><br><span class="hljs-comment">#   systemctl  restart nginx   </span><br></code></pre></td></tr></table></figure>

<p><strong>5-4. open_log_file_cache  日志缓存</strong></p>
<figure class="highlight nginx"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs Nginx"><span class="hljs-attribute">open_log_file_cache</span> max=<span class="hljs-number">1000</span> inactive=<span class="hljs-number">20s</span> min_uses=<span class="hljs-number">3</span> valid=<span class="hljs-number">1m</span> ;<br></code></pre></td></tr></table></figure>

<p>open_log_file_cache                      &#x2F;&#x2F;打开日志文件缓存</p>
<p>  max&#x3D;1000                                   &#x2F;&#x2F;最大支持1000</p>
<p>  inactive&#x3D;20s                                &#x2F;&#x2F;20s之内</p>
<p>  min_uses&#x3D;3                                &#x2F;&#x2F;3次            20s之内小于3次的清掉</p>
<p>  valid&#x3D;1m                                    &#x2F;&#x2F;间隔时间为1分钟</p>
<p>默认为禁用状态，不建议开启，占用内存资源</p>
<h4 id="6-日志轮转切割"><a href="#6-日志轮转切割" class="headerlink" title="6.日志轮转切割"></a>6.日志轮转切割</h4><p>安装nginx，会默认启动日志轮转</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><code class="hljs Shell"><span class="hljs-meta prompt_"># </span><span class="language-bash"> rpm -ql nginx |grep <span class="hljs-built_in">log</span></span><br>/etc/logrotate.d/nginx<br>/var/log/nginx<br><span class="hljs-meta prompt_"></span><br><span class="hljs-meta prompt_"># </span><span class="language-bash"> vim   /etc/logrotate.d/nginx</span><br>/var/log/nginx/*.log &#123;       //待切割的日志<br>        daily                //天 轮转周期<br>        missingok            //丢失不提示<br>        rotate 52            //52份<br>        compress             //压缩<br>        delaycompress        //延迟压缩<br>        notifempty           //空文件不轮转<br>        create 640 nginx adm //创建新的日志文件 属主<br>        sharedscripts        //轮转后脚本<br>        postrotate           //应用程序重载配置文件<br>                if [ -f /var/run/nginx.pid ]; then<br>                        kill -USR1 `cat /var/run/nginx.pid`<br>                fi<br>        endscript<br>&#125;<br></code></pre></td></tr></table></figure>

<p>  <strong>6-1.日志分析</strong></p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br></pre></td><td class="code"><pre><code class="hljs Shell">1. 统计2017年9月5日 PV量<br><span class="hljs-meta prompt_"># </span><span class="language-bash">  grep <span class="hljs-string">&#x27;05/Sep/2017&#x27;</span> cd.mobiletrain.org.log |<span class="hljs-built_in">wc</span> -l      1260条</span><br>   8点-9点间的PV量<br><span class="hljs-meta prompt_">   # </span><span class="language-bash">  grep <span class="hljs-string">&#x27;05/Sep/2017:08&#x27;</span> sz.mobiletrain.org.log  |<span class="hljs-built_in">wc</span> -l</span><br><span class="hljs-meta prompt_">   # </span><span class="language-bash">  awk <span class="hljs-string">&#x27;$4&gt;=&quot;[05/Sep/2017:08:00:00&quot; &amp;&amp; $4&lt;=&quot;[05/Sep/2017:09:00:00&quot; &#123;print $0&#125;&#x27;</span>  sz.mobiletrain.org.log | <span class="hljs-built_in">wc</span> -l</span><br>   <br>2. 统计2017年9月5日 一天内访问最多的10个IP（ip top10）<br><span class="hljs-meta prompt_">   # </span><span class="language-bash"> grep <span class="hljs-string">&#x27;05/Sep/2017&#x27;</span> cd.mobiletrain.org.log | awk <span class="hljs-string">&#x27;&#123; ips[$1]++ &#125; END&#123;for(i in ips)&#123;print i,ips[i]&#125; &#125; &#x27;</span>| <span class="hljs-built_in">sort</span> -k2 -rn | <span class="hljs-built_in">head</span> -n10</span><br>                121.29.54.122 95<br>                121.29.54.124 84<br>                121.29.54.59 73<br>                121.29.54.101 73<br>                121.29.54.62 62<br>                121.29.54.60 56<br>                58.216.107.23 52<br>                119.147.33.22 50<br>                121.31.30.169 42<br>                <br>3. 统计2017年9月5日 访问大于100次的IP<br><span class="hljs-meta prompt_">  # </span><span class="language-bash">  grep <span class="hljs-string">&#x27;05/Sep/2017&#x27;</span> cd.mobiletrain.org.log | awk <span class="hljs-string">&#x27;&#123; ips[$1]++ &#125; END&#123;for(i in ips)&#123; if(ips[i]&gt;100)  &#123;print i,ips[i]&#125;&#125; &#125; &#x27;</span>| <span class="hljs-built_in">sort</span> -k2 -rn | <span class="hljs-built_in">head</span> -n10</span><br>                182.140.217.111 138<br>                <br>4. 统计2017年9月5日 访问最多的10个页面（$request top 10）<br><span class="hljs-meta prompt_">  # </span><span class="language-bash">  grep <span class="hljs-string">&#x27;05/Sep/2017&#x27;</span> cd.mobiletrain.org.log |awk <span class="hljs-string">&#x27;&#123;urls[$7]++&#125; END&#123;for(i in urls)&#123;print urls[i],i&#125;&#125;&#x27;</span> |<span class="hljs-built_in">sort</span> -k1 -rn |<span class="hljs-built_in">head</span> -n10</span><br>                60 /<br>                41 /img/banner_btn.png<br>                23 /js/jquery-1.8.3.min.js<br>                21 /img/kbxx_bg.png<br>                21 /css/cd_index.css<br>                20 /d/file/works/2017-04-28/afed3f12498e47572f7a31dad04c4717.jpg<br>                19 /js/ymcore.js<br>                18 /img/ico.png<br>                17 /img/huanglaoshi.jpg<br>                17 /e/admin/DoTimeRepage.php<br>                <br>5. 统计2017年9月5日 每个URL访问内容总大小（$body_bytes_sent）<br><span class="hljs-meta prompt_"># </span><span class="language-bash">   grep <span class="hljs-string">&#x27;05/Sep/2017&#x27;</span> sz.mobiletrain.org.log |</span><br>awk &#x27;&#123; urls[$7]++; size[$7]+=$10&#125;END&#123;for(i in urls)&#123;print urls[i],size[i],i&#125;&#125;&#x27;|<br>sort -k1 -rn | head -n10<br>                44 4040481 /<br>                34 5372 /e/admin/DoTimeRepage.php<br>                25 75026 /js/jquery-1.11.3.min.js<br>                25 678973 /skin/sz/js/minkh.php<br>                22 173642 /skin/sz/js/page/jquery-1.4.2.min.js<br>                21 1906 /skin/sz/js/page/ready.js<br>                19 3312 /skin/sz/js/table.js<br>                18 10184 /skin/sz/js/page/core.js<br>                16 7818 /img/kbxx_bg.png<br>                16 42120 /img/sz_home/sz_js.png<br>                <br>6. 统计2017年9月5日 每个IP访问状态码数量（$status）<br><span class="hljs-meta prompt_"># </span><span class="language-bash">  grep <span class="hljs-string">&#x27;05/Sep/2017&#x27;</span> cd.mobiletrain.org.log |</span> <br>awk &#x27;&#123; ip_code[$1&quot; &quot;$9]++&#125;END&#123; for(i in ip_code)&#123;print i,ip_code[i]&#125; &#125;&#x27; | <br>sort -k1 -rn | head -n10<br>                220.112.25.173 304 1<br>                220.112.25.173 200 30<br>                183.214.128.195 304 18<br>                183.214.128.195 200 10<br>                183.214.128.152 200 10<br>                183.214.128.142 304 18<br>                183.214.128.142 200 5<br>                182.140.217.111 404 7<br>                182.140.217.111 304 109<br>                182.140.217.111 200 22<br>                <br>7. 统计2017年9月5日 每个IP访问状态码为404及出现次数（$status）<br><span class="hljs-meta prompt_"># </span><span class="language-bash">   grep <span class="hljs-string">&#x27;05/Sep/2017&#x27;</span> cd.mobiletrain.org.log |</span><br> awk &#x27;$9==&quot;404&quot;&#123;ccc[$1&quot; &quot;$9]++&#125;END&#123;for(i in ccc)&#123;print i,ccc[i]&#125;&#125;&#x27;  | <br>sort -k3 -rn<br><span class="hljs-meta prompt_"># </span><span class="language-bash">   grep <span class="hljs-string">&#x27;05/Sep/2017&#x27;</span> sz.mobiletrain.org.log |</span> <br>awk &#x27;&#123;if($9==&quot;404&quot;)&#123;ip_code[$1&quot; &quot;$9]++&#125;&#125;END&#123;for(i in ip_code)&#123;print i,ip_code[i]&#125;&#125;&#x27;<br>                58.216.107.21 404 5<br>                139.215.203.174 404 67<br>                125.211.204.174 404 10<br>                58.216.107.22 404 25<br>                106.117.249.12 404 6<br>                119.147.33.21 404 50<br>                42.56.76.44 404 5<br>                119.147.33.22 404 117<br>                106.117.249.36 404 9<br>                58.216.107.23 404 2<br>                119.147.33.18 404 118<br>                58.216.107.11 404 7<br>                42.56.76.21 404 5<br>                111.1.57.20 404 6<br>                183.203.65.18 404 28<br>                58.216.107.12 404 21<br>                106.117.249.13 404 4<br>                121.29.54.60 404 38<br>                121.29.54.122 404 67<br>                58.216.107.36 404 43<br>                58.216.107.24 404 10<br>                119.147.33.19 404 47<br>                182.140.217.111 404 18<br>                42.56.76.22 404 6<br>                183.214.128.151 404 15<br>                106.117.249.14 404 4<br>                42.56.76.11 404 6<br>                183.214.128.152 404 15<br>                153.37.238.173 404 41<br>                58.250.143.116 404 25<br>                121.29.54.124 404 91<br>                120.221.31.44 404 24<br>                121.31.30.169 404 90<br>                121.29.54.62 404 71<br>                121.29.54.101 404 76<br>                42.56.76.12 404 3<br>                111.1.57.19 404 6<br>                183.214.128.141 404 29<br>                121.29.54.59 404 51<br>                106.117.249.43 404 8<br>                1.31.173.43 404 27<br>                58.216.107.111 404 5<br>                119.147.33.26 404 147<br>                183.214.128.142 404 45<br>                58.216.107.31 404 4<br>                220.112.25.173 404 12<br>                111.161.109.103 404 27<br>                124.14.1.173 404 18<br>                106.117.249.11 404 35<br>                183.214.128.195 404 6<br>                123.151.76.53 404 49<br>                119.147.33.20 404 94<br>                <br>8. 统计前一分钟的PV量<br><span class="hljs-meta prompt_"># </span><span class="language-bash">  <span class="hljs-built_in">date</span>=$(<span class="hljs-built_in">date</span> -d <span class="hljs-string">&#x27;-1 minute&#x27;</span> +%d/%b/%Y:%H:%M);</span><br><span class="hljs-meta prompt_"># </span><span class="language-bash">  awk  -v <span class="hljs-built_in">date</span>=<span class="hljs-variable">$date</span> <span class="hljs-string">&#x27;$0 ~ date &#123;i++&#125;END&#123;print i&#125;&#x27;</span>  sz.mobiletrain.org.log</span><br>                无<br> shell中的变量在awk程序中无法使用，因为在执行AWK时，是一个新的进程去处理的，因此就需要-v 来向awk程序中传参数了，你比如在shell程序中有一个变量a=15，你在awk程序中直接使用变量a是不行的，而你用awk -v b=a， 这样在AWK程序中就可以使用变量b了！也就相当于使用a了！<br><span class="hljs-meta prompt_"> # </span><span class="language-bash">  <span class="hljs-built_in">date</span>=$(<span class="hljs-built_in">date</span> -d <span class="hljs-string">&#x27;-1 minute&#x27;</span> +%Y:%H:%M);  awk -v <span class="hljs-built_in">date</span>=<span class="hljs-variable">$date</span> <span class="hljs-string">&#x27;$0 ~ date&#123;i++&#125;END&#123;print i&#125;&#x27;</span> /var/log/nginx/xuleilinux.access.log</span> <br> <br> 9. 统计2017年9月5日 8:30－9:00，每个IP，出现404状态码的数量<br><span class="hljs-meta prompt_"># </span><span class="language-bash">  awk <span class="hljs-string">&#x27;$4&gt;=&quot;[05/Sep/2017:08:30:00&quot; &amp;&amp; $4&lt;=&quot;[05/Sep/2017:09:00:00&quot; &#123;if($9==&quot;404&quot;)&#123;ip_code[$1&quot; &quot;$9]++&#125;&#125;END&#123;for(i in ip_code)&#123;print i,ip_code[i]&#125;&#125;&#x27;</span> sz.mobiletrain.org.log</span> <br>                119.147.33.19 404 1<br>                58.250.143.116 404 1<br>        =单等号是赋值 ==双等号是比较<br>10. 统计2017年9月5日 各种状态码数量<br><span class="hljs-meta prompt_"># </span><span class="language-bash">  grep <span class="hljs-string">&#x27;05/Sep/2017&#x27;</span> sz.mobiletrain.org.log  |  awk <span class="hljs-string">&#x27;&#123;code[$9]++&#125; END&#123;for(i in code)&#123;print i,code[i]&#125;&#125;&#x27;</span></span><br>                301 1<br>                304 821<br>                200 625<br>                404 290<br>                405 1<br>百分比<br><span class="hljs-meta prompt_"># </span><span class="language-bash">  grep <span class="hljs-string">&#x27;05/Sep/2017&#x27;</span> sz.mobiletrain.org.log | awk <span class="hljs-string">&#x27;&#123;code[$9]++;total++&#125; END&#123;for(i in code)&#123;printf i&quot; &quot;;printf code[i]&quot;\t&quot;;printf &quot;%.2f&quot;,code[i]/total*100;print &quot;%&quot;&#125;&#125;&#x27;</span></span><br>                        301 1        0.06%<br>                        304 821        47.24%<br>                        200 625        35.96%<br>                        404 290        16.69%<br>                        405 1        0.06%<br>                        <br>                        <br>  &#123;ips[$1]++&#125;: 对于输入的每一行，它都会查看第一个字段（$1）的值，并在数组ips中为这个值增加一个计数。如果这是第一次遇到这个值，那么它的计数会从0开始增加到1；如果之前已经遇到过这个值，那么它的计数就会继续增加。<br>END&#123;for(i in ips)&#123;print i , ips[i]&#125;&#125;: 当所有的输入行都被处理完之后（即到了END块），它会遍历数组ips，并打印出每个不同的字段值（数组索引i）以及该字段值在输入中出现的次数（数组值ips[i]）                      <br>                        <br></code></pre></td></tr></table></figure>

<h4 id="7-nginx-web模块"><a href="#7-nginx-web模块" class="headerlink" title="7.nginx  web模块"></a><strong>7.nginx  web模块</strong></h4><p><strong>7-1.连接状态模块</strong></p>
<p> stub_status_module         &#x2F;&#x2F;分支状态模块</p>
<figure class="highlight nginx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><code class="hljs Nginx"> <span class="hljs-comment">#  nginx -V  2&gt;&amp;1 |grep stup_status     //查询模块是否安装</span><br> <span class="hljs-comment">#  vim   /etc/nginx/conf.d/xulei.conf</span><br><span class="hljs-section">server</span> &#123;<br>    <span class="hljs-attribute">listen</span>  <span class="hljs-number">80</span>;<br>    <span class="hljs-attribute">server_name</span>  xulei.com;<br>    <span class="hljs-section">location</span>  / &#123;<br>        <span class="hljs-attribute">root</span>   /xulei;<br>        <span class="hljs-attribute">index</span>  index.html;<br>    &#125;<br>    <span class="hljs-attribute">error_page</span>  <span class="hljs-number">404</span>   /<span class="hljs-number">404</span>.html;<br>    <span class="hljs-section">location</span> =/<span class="hljs-number">404</span>.html &#123;<br>        <span class="hljs-attribute">root</span>   /xulei<br>    &#125;<br>    location  /nginx_status &#123;<br>        stub_status;<br>        <span class="hljs-attribute">allow</span>  all;<br>    &#125;<br>&#125; <br><span class="hljs-comment">#  systemctl restart  nginx</span><br>访问xulei.com/<span class="hljs-attribute">nginx_status</span> 会看到:<br>Active connections: <span class="hljs-number">2</span>            //当前连接数<br>server accepts handled requests  //服务器接受处理请求数<br> <span class="hljs-number">7191</span> <span class="hljs-number">7191</span> <span class="hljs-number">6</span>                     //<span class="hljs-number">7191</span>:总连接数    <span class="hljs-number">7194</span>:成功连接数     <span class="hljs-number">6</span>:总共处理的请求数<br>Reading: <span class="hljs-number">0</span> Writing: <span class="hljs-number">1</span> Waiting: <span class="hljs-number">1</span>  //reading:读取客户端的header信息数  请求头    writing: 返回给客户端的header信息数  响应头      waiting：等待的请求数  开启了keepalive<br></code></pre></td></tr></table></figure>

<p>​    <strong>7-2.长连接  keepalive</strong></p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs Shell"><span class="hljs-meta prompt_"># </span><span class="language-bash"> vim  /etc/nginx/nginx.conf</span><br>找到里面的:<br>keepalive_timeout  65;<br>修改下时间观察xulei.com/nginx_status的总连接数和成功连接数<br></code></pre></td></tr></table></figure>

<h2 id="七-RabbitMQ-消息队列"><a href="#七-RabbitMQ-消息队列" class="headerlink" title="七.RabbitMQ   消息队列"></a>七.RabbitMQ   消息队列</h2><p>核心功能：</p>
<ul>
<li><p>解耦           耦合[A和B之间强关联]  解除耦合性           </p>
</li>
<li><p>冗余(存储)     分布式</p>
</li>
<li><p>扩展性         mq只身支持多种语言，有较强的扩展性</p>
</li>
<li><p>削峰           削峰填谷</p>
</li>
<li><p>可恢复性       消息确认机制、分片结构</p>
</li>
<li><p>顺序保证       先进先出</p>
</li>
<li><p>缓冲           </p>
</li>
<li><p>异步通信</p>
<p>RabbitMQ 概念图</p>
</li>
</ul>
<p><img src="https://hqrchvz3h42.feishu.cn/space/api/box/stream/download/asynccode/?code=MWE4NTIxZmFkYWU5NGRhZTAwNTk3MzgwNTgzMGVhZGZfcHNiUlV1WE5kaWJTbFExUmw5dnRGNUJFOEZWZkJRWjVfVG9rZW46RGhkNGJnSjNob1JWSHR4NXlrcmNTWjdQblFnXzE3MTk3MTk1MjE6MTcxOTcyMzEyMV9WNA" srcset="/img/loading.gif" lazyload alt="img"></p>
<p>RabbitMQ 概念介绍</p>
<ul>
<li>Broker：       简单来说就是消息队列服务器实体。 [不是rabbitmq的的服务器(物理机、虚拟机)]</li>
<li>Exchange：     消息交换机，它指定消息按什么规则，路由到哪个队列。</li>
<li>Queue：        消息队列载体，每个消息都会被投入到一个或多个队列。</li>
<li>Binding：      绑定，它的作用就是把exchange和queue按照路由规则绑定起来。</li>
<li>Routing Key：  路由关键字，exchange根据这个关键字进行消息投递。</li>
<li>vhost：        虚拟主机，一个broker里可以开设多个vhost，用作不同用户的权限分离。</li>
<li>producer：     消息生产者，就是投递消息的程序。</li>
<li>consumer：     消息消费者，就是接受消息的程序。</li>
<li>channel：      消息通道，在客户端的每个连接里，可建立多个channel，每个channel代表一个会话任务。</li>
</ul>
<p> 消息中间件的两种模式</p>
<p> 1、P2P模式</p>
<p>​         消息队列（Queue）、发送者(Sender)[生产者]、接收者(Receiver)[消费者]</p>
<p>​         特点:</p>
<p>  每个消息只有一个消费者（Consumer），即一旦被消费，消息就不再在消息队列中</p>
<p>  发送者和接收者之间在时间上没有依赖性，也就是说当发送者发送了消息之后，不管接收者有没有正在运行它不会影响到消息被发送到队列        </p>
<p>  接收者在成功接收消息之后需向队列应答成功</p>
<p>  如果希望发送的每个消息都会被成功处理的话，那么需要P2P模 </p>
<p> 2、pub\sub模式</p>
<p>​         主题（Topic）、发布者（Publisher）、订阅者（Subscriber）</p>
<p> 特点</p>
<p>  每个消息可以有多个消费者</p>
<p>  发布者和订阅者之间有时间上的依赖性。针对某个主题（Topic）的订阅者，它必须创建一个订阅者之后，才能消费发布者的消息</p>
<p>  为了消费消息，订阅者必须保持运行的状态</p>
<p>  如果希望发送的消息可以不被做任何处理、或者只被一个消息者处理、或者可以被多个消费者处理的话，那么可以采用Pub&#x2F;Sub模型</p>
<h6 id="1-单机部署rabbitmq"><a href="#1-单机部署rabbitmq" class="headerlink" title="1.单机部署rabbitmq"></a>1.单机部署rabbitmq</h6><p>rabbitmq-3.7.9  使用erlang  19.3~21.x</p>
<p>必须对应版本</p>
<p>1.添加域名解析</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs Shell">vim  /etc/hosts<br>192.168.39.147    rabbitmq1<br></code></pre></td></tr></table></figure>

<p>2.部署erlang环境</p>
<p>源码安装</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><code class="hljs Shell"><span class="hljs-meta prompt_"># </span><span class="language-bash">yum -y install gcc-c++ unixODBC unixODBC-devel openssl-devel ncurses-devel</span><br>    erlang依赖包<br><span class="hljs-meta prompt_"># </span><span class="language-bash">  <span class="hljs-built_in">cd</span>   /usr/local/src/</span><br><span class="hljs-meta prompt_"># </span><span class="language-bash"> wget http://erlang.org/download/otp_src_21.3.tar.gz    //下载erlang安装包</span><br><span class="hljs-meta prompt_"># </span><span class="language-bash"> tar  xzvf  otp_src_21.3.tar.gz  -C /usr/local          //解压</span><br><span class="hljs-meta prompt_"># </span><span class="language-bash"> <span class="hljs-built_in">cd</span>  /usr/local/otp_src_21.3                            //cd去文件夹</span><br><span class="hljs-meta prompt_"># </span><span class="language-bash"> ./configure --prefix=/usr/local/bin/erlang --without-javac</span><br><span class="hljs-meta prompt_"># </span><span class="language-bash">  <span class="hljs-built_in">echo</span> $?                                              //查看返回值是不是0</span><br><span class="hljs-meta prompt_"># </span><span class="language-bash">  make &amp;&amp; make install                                 //编译安装</span><br><span class="hljs-meta prompt_"># </span><span class="language-bash">  vim  /etc/profile.d/erl.sh                          //配置环境变量</span><br>    ERL_HOME=/usr/local/bin/erlang<br>    PATH=$PATH:$ERL_HOME/bin<br>    export ERL_HOME PATH   <br><span class="hljs-meta prompt_"># </span><span class="language-bash">  <span class="hljs-built_in">source</span> /etc/profile.d/erl.sh                        <span class="hljs-comment">#启用环境变量</span></span><br></code></pre></td></tr></table></figure>

<p>3.部署rabbitmq</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs Shell"><span class="hljs-meta prompt_"># </span><span class="language-bash"> wget https://github.com/rabbitmq/rabbitmq-server/releases/download/v3.7.9/rabbitmq- server-generic-unix-3.7.9.tar.xz</span><br><span class="hljs-meta prompt_"># </span><span class="language-bash"> yum install -y xz</span><br><span class="hljs-meta prompt_"># </span><span class="language-bash"> tar xzvf  rabbitmq-server-generic-unix-3.7.9.tar.xz -C /usr/local</span><br><span class="hljs-meta prompt_"># </span><span class="language-bash"> vim  /etc/profile.d/rbt.sh</span><br>    RABBITMQ_HOME=/usr/local/rabbitmq_server-3.7.9<br>    PATH=$PATH:$RABBITMQ_HOME/sbin<br>    export RABBITMQ_HOME PATH<br><span class="hljs-meta prompt_"># </span><span class="language-bash"> <span class="hljs-built_in">source</span>  /etc/profile.d/rbt.sh</span><br></code></pre></td></tr></table></figure>

<p>4.启动管理界面</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs Shell"><span class="hljs-meta prompt_"># </span><span class="language-bash"> rabbitmq-plugins  <span class="hljs-built_in">enable</span> rabbitmq_management</span><br></code></pre></td></tr></table></figure>

<p> 常用功能</p>
<p> 启动监控管理器：rabbitmq-plugins   enable  rabbitmq_management</p>
<p> 关闭监控管理器：rabbitmq-plugins   disable  rabbitmq_management</p>
<p> 启动rabbitmq:     rabbitmq-service  start     &#x2F;&#x2F;或者是:  rabbitmq-server   -detached   在后台运行</p>
<p>   关闭rabbitmq：rabbitmq-service stop</p>
<p>   查看所有的队列：rabbitmqctl list_queues</p>
<p>   清除所有的队列：rabbitmqctl reset</p>
<p>   关闭应用：rabbitmqctl stop_app</p>
<p>   启动应用：rabbitmqctl start_app</p>
<p>  3个端口分别是：</p>
<p>  5672  rabbitmq-server    程序</p>
<p>  15672 rabbitmq-management 图形管理界面</p>
<p>  25672 rabbitmq-cluster    集群</p>
<p>5.测试</p>
<p> 添加用户：</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs Shell"><span class="hljs-meta prompt_"># </span><span class="language-bash">rabbitmqctl  add_user   tom   1</span><br></code></pre></td></tr></table></figure>

<p> 绑定角色：</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs Shell"><span class="hljs-meta prompt_"># </span><span class="language-bash"> rabbitmq set_user_tags  tom   administrator</span><br></code></pre></td></tr></table></figure>

<p> 授权该用户管理vhost:</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs Shell"><span class="hljs-meta prompt_"># </span><span class="language-bash"> rabbitmqctl  set_permissions -p  /  tom <span class="hljs-string">&quot;.*&quot;</span> <span class="hljs-string">&quot;.*&quot;</span> <span class="hljs-string">&quot;.*&quot;</span></span><br></code></pre></td></tr></table></figure>

<p> 测试下 <a target="_blank" rel="noopener" href="https://192.168.39.147:15672/">https://192.168.39.147:15672</a></p>
<h6 id="2-部署rabbitmq集群"><a href="#2-部署rabbitmq集群" class="headerlink" title="2.部署rabbitmq集群"></a>2.部署rabbitmq集群</h6><p>1.改名解析</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs Shell"><span class="hljs-meta prompt_"># </span><span class="language-bash">hostnamectl  set-hostname  xxxx       <span class="hljs-comment">#改名rabbitmq1,rabbitmq3,rabbitmq3</span></span><br><span class="hljs-meta prompt_"># </span><span class="language-bash">vim  /etc/hosts                       <span class="hljs-comment">#3台机器都要做解析</span></span><br>192.168.39.146   rabbitmq1<br>192.168.39.146   rabbitmq2<br>192.168.39.146   rabbitmq3<br></code></pre></td></tr></table></figure>

<p>2.部署3个rabbitmq单机</p>
<p>​       略   </p>
<p>​    3.将3台单机版，构建成集群</p>
<p>rabbitmq想要构建集群，依赖以erlang的分布式特性</p>
<p>erlang构建分布式，需要使用相同的erlang.cookie</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs Shell"><span class="hljs-meta prompt_"># </span><span class="language-bash"> rabbitmqctl  stop                 <span class="hljs-comment">#停止服务</span></span><br><span class="hljs-meta prompt_"># </span><span class="language-bash"> <span class="hljs-built_in">ls</span>  /root/.erlang.cookie          <span class="hljs-comment">#查看文件，但不要改动它，是个隐藏文件</span></span><br><span class="hljs-meta prompt_"># </span><span class="language-bash"> scp  /root/.erlang.cookie rabbitmq2:/root/     <span class="hljs-comment">#拷贝rabbitmq1的cookie给rabbitmq2</span></span><br><span class="hljs-meta prompt_"># </span><span class="language-bash"> scp  /root/.erlang.cookie rabbitmq3:/root/     <span class="hljs-comment">#拷贝rabbitmq1的cookie给rabbitmq3</span></span><br><span class="hljs-meta prompt_"># </span><span class="language-bash"> <span class="hljs-built_in">cat</span>  /root/.erlang.cookie          <span class="hljs-comment">#查看cookie是否一样</span></span><br><span class="hljs-meta prompt_"># </span><span class="language-bash"> rabbitmq-server  -detached         <span class="hljs-comment">#启动rabbitmq后台运行</span></span><br></code></pre></td></tr></table></figure>

<p> 4.开始构建集群</p>
<p>  以某一个节点为主，让其他节点加入集群  [节点之间没有差异]</p>
<p>  以rbtmq1为主，其他两个节点rabbitmq2、rabbitmq3加入集群</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><code class="hljs Shell"><span class="hljs-meta prompt_"># </span><span class="language-bash"> rabbitmqctl  stop_app            <span class="hljs-comment">#停止应用</span></span><br>    Stopping rabbit application on node rabbit@rabbitmq2 ...<br><span class="hljs-meta prompt_"></span><br><span class="hljs-meta prompt_"># </span><span class="language-bash"> rabbitmqctl  join_cluster  rabbit@rabbitmq1       <span class="hljs-comment">#在mq2上加入mq1集群</span></span><br>    Clustering node rabbit@rbtmq2 with rabbit@rabbitmq1<br><span class="hljs-meta prompt_"></span><br><span class="hljs-meta prompt_"># </span><span class="language-bash"> rabbitmqctl  start_app           <span class="hljs-comment">#启动应用</span></span><br>     Starting node rabbit@rbtmq2 ...<br>     completed with 3 plugins.<br><br>    在mq3上同上操作<br>    <br><span class="hljs-meta prompt_"># </span><span class="language-bash"> rabbitmqctl  cluster_status      <span class="hljs-comment">#查看集群状态</span></span> <br>    Cluster status of node rabbit@rbtmq1 ...<br>    [&#123;nodes,[&#123;disc,[rabbit@rabbitmq1,rabbit@rabbitmq2,rabbit@rabbitmq3]&#125;]&#125;,<br>     &#123;running_nodes,[rabbit@rabbitmq3,rabbit@rabbitmq2,rabbit@rabbitmq1]&#125;,<br>     &#123;cluster_name,&lt;&lt;&quot;rabbit@rabbitmq1&quot;&gt;&gt;&#125;,<br>     &#123;partitions,[]&#125;,<br>     &#123;alarms,[&#123;rabbit@rabbitmq3,[]&#125;,&#123;rabbit@rabbitmq2,[]&#125;,&#123;rabbit@rabbitmq1,[]&#125;]&#125;]<br></code></pre></td></tr></table></figure>

<p>5.设置镜像队列策略</p>
<p>  # rabbitmqctl set_policy [-p Vhost] Name Pattern Definition [Priority]</p>
<p> -p Vhost： 可选参数，针对指定vhost下的queue进行设置</p>
<p> Name: policy的名称</p>
<p> Pattern: queue的匹配模式(正则表达式)</p>
<p> Definition：镜像定义，包括三个部分ha-mode, ha-params, ha-sync-mode</p>
<p>​     ha-mode:指明镜像队列的模式，有效值为 all&#x2F;exactly&#x2F;nodes</p>
<p>​               all：表示在集群中所有的节点上进行镜像</p>
<p>​           exactly：表示在指定个数的节点上进行镜像，节点的个数由ha-params指定</p>
<p>​           nodes：表示在指定的节点上进行镜像，节点名称通过ha-params指定</p>
<p>​     ha-params：ha-mode模式需要用到的参数</p>
<p>​     ha-sync-mode：进行队列中消息的同步方式，有效值为automatic和manual</p>
<p> priority：可选参数，policy的优先级</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs Shell"><span class="hljs-meta prompt_"># </span><span class="language-bash"> rabbitmqctl  set_policcy -p  /mall  ikun-ha  <span class="hljs-string">&quot;^&quot;</span> <span class="hljs-string">&#x27;&#123;&quot;ha-mode&quot;:&quot;all&quot;&#125;&#x27;</span></span><br></code></pre></td></tr></table></figure>

<h2 id="八-redis数据缓存"><a href="#八-redis数据缓存" class="headerlink" title="八.redis数据缓存"></a>八.redis数据缓存</h2><p>redis是一个内存型、可持久化的键值对数据库，支持多种数据类型和多种API</p>
<ul>
<li>性能极高       – Redis能读的速度是110000次&#x2F;s,写的速度是81000次&#x2F;s 。  [8G内存的数据库 read 6000   write 3000]</li>
<li>丰富的数据类型 – Redis支持二进制案例的 Strings, Lists, Hashes, Sets 及 Ordered Sets 数据类型操作。</li>
<li>原子           – Redis的所有操作都是原子性的，意思就是要么成功执行要么失败完全不执行。单个操作是原子性的。多个操作也支持事务，即原子性，通过MULTI和EXEC指令包起来。</li>
<li>丰富的特性     – Redis还支持 publish&#x2F;subscribe, 通知, key 过期等等特性</li>
</ul>
<p>1.部署radis</p>
<p>下载地址<a target="_blank" rel="noopener" href="http://redis.io/download%EF%BC%8C%E4%B8%8B%E8%BD%BD%E6%9C%80%E6%96%B0%E7%A8%B3%E5%AE%9A%E7%89%88%E6%9C%AC%E3%80%82">http://redis.io/download，下载最新稳定版本。</a></p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs Shell"><span class="hljs-meta prompt_"># </span><span class="language-bash">wget http://download.redis.io/releases/redis-4.0.9.tar.gz</span><br><span class="hljs-meta prompt_"># </span><span class="language-bash">tar  xzvf   redis-4.0.9.tar.gz -C /usr/local</span><br><span class="hljs-meta prompt_"># </span><span class="language-bash"><span class="hljs-built_in">cd</span>   redis-4.0.9</span><br><span class="hljs-meta prompt_"># </span><span class="language-bash">yum install -y  make gcc</span><br><span class="hljs-meta prompt_"># </span><span class="language-bash">make</span><br><span class="hljs-meta prompt_"># </span><span class="language-bash"><span class="hljs-built_in">ls</span> src/redis-cli  src/redis-server src/redis-sentinel</span> <br>   src/redis-cli<br>   src/redis-server<br>   src/redis-sentinel <br></code></pre></td></tr></table></figure>

<p>2.修改配置</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs Shell"><span class="hljs-meta prompt_"># </span><span class="language-bash">vim redis.conf</span> <br>bind  192.168.39.135       #只监听内网ip<br>daemonize  yes             #<br></code></pre></td></tr></table></figure>


                
              </div>
            
            <hr/>
            <div>
              <div class="post-metas my-3">
  
    <div class="post-meta mr-3 d-flex align-items-center">
      <i class="iconfont icon-category"></i>
      

<span class="category-chains">
  
  
    
      <span class="category-chain">
        
  <a href="/categories/%E4%BA%91%E8%AE%A1%E7%AE%97/" class="category-chain-item">云计算</a>
  
  

      </span>
    
  
</span>

    </div>
  
  
</div>


              
  

  <div class="license-box my-3">
    <div class="license-title">
      <div>云计算</div>
      <div>http://example.com/2024/06/30/云计算/</div>
    </div>
    <div class="license-meta">
      
        <div class="license-meta-item">
          <div>作者</div>
          <div>John Doe</div>
        </div>
      
      
        <div class="license-meta-item license-meta-date">
          <div>发布于</div>
          <div>2024年6月30日</div>
        </div>
      
      
      
        <div class="license-meta-item">
          <div>许可协议</div>
          <div>
            
              
              
                <a class="print-no-link" target="_blank" href="https://creativecommons.org/licenses/by/4.0/">
                  <span class="hint--top hint--rounded" aria-label="BY - 署名">
                    <i class="iconfont icon-by"></i>
                  </span>
                </a>
              
            
          </div>
        </div>
      
    </div>
    <div class="license-icon iconfont"></div>
  </div>



              
                <div class="post-prevnext my-3">
                  <article class="post-prev col-6">
                    
                    
                  </article>
                  <article class="post-next col-6">
                    
                    
                      <a href="/2024/06/30/hello-world/" title="Hello World">
                        <span class="hidden-mobile">Hello World</span>
                        <span class="visible-mobile">下一篇</span>
                        <i class="iconfont icon-arrowright"></i>
                      </a>
                    
                  </article>
                </div>
              
            </div>

            
          </article>
        </div>
      </div>
    </div>

    <div class="side-col d-none d-lg-block col-lg-2">
      
  <aside class="sidebar" style="margin-left: -1rem">
    <div id="toc">
  <p class="toc-header">
    <i class="iconfont icon-list"></i>
    <span>目录</span>
  </p>
  <div class="toc-body" id="toc-body"></div>
</div>



  </aside>


    </div>
  </div>
</div>





  



  



  



  



  







    

    
      <a id="scroll-top-button" aria-label="TOP" href="#" role="button">
        <i class="iconfont icon-arrowup" aria-hidden="true"></i>
      </a>
    

    
      <div class="modal fade" id="modalSearch" tabindex="-1" role="dialog" aria-labelledby="ModalLabel"
     aria-hidden="true">
  <div class="modal-dialog modal-dialog-scrollable modal-lg" role="document">
    <div class="modal-content">
      <div class="modal-header text-center">
        <h4 class="modal-title w-100 font-weight-bold">搜索</h4>
        <button type="button" id="local-search-close" class="close" data-dismiss="modal" aria-label="Close">
          <span aria-hidden="true">&times;</span>
        </button>
      </div>
      <div class="modal-body mx-3">
        <div class="md-form mb-5">
          <input type="text" id="local-search-input" class="form-control validate">
          <label data-error="x" data-success="v" for="local-search-input">关键词</label>
        </div>
        <div class="list-group" id="local-search-result"></div>
      </div>
    </div>
  </div>
</div>

    

    
  </main>

  <footer>
    <div class="footer-inner">
  
    <div class="footer-content">
       <a href="https://hexo.io" target="_blank" rel="nofollow noopener"><span>Hexo</span></a> <i class="iconfont icon-love"></i> <a href="https://github.com/fluid-dev/hexo-theme-fluid" target="_blank" rel="nofollow noopener"><span>Fluid</span></a> 
    </div>
  
  
  
  
</div>

  </footer>

  <!-- Scripts -->
  
  <script  src="https://lib.baomitu.com/nprogress/0.2.0/nprogress.min.js" ></script>
  <link  rel="stylesheet" href="https://lib.baomitu.com/nprogress/0.2.0/nprogress.min.css" />

  <script>
    NProgress.configure({"showSpinner":false,"trickleSpeed":100})
    NProgress.start()
    window.addEventListener('load', function() {
      NProgress.done();
    })
  </script>


<script  src="https://lib.baomitu.com/jquery/3.6.4/jquery.min.js" ></script>
<script  src="https://lib.baomitu.com/twitter-bootstrap/4.6.1/js/bootstrap.min.js" ></script>
<script  src="/js/events.js" ></script>
<script  src="/js/plugins.js" ></script>


  <script  src="https://lib.baomitu.com/typed.js/2.0.12/typed.min.js" ></script>
  <script>
    (function (window, document) {
      var typing = Fluid.plugins.typing;
      var subtitle = document.getElementById('subtitle');
      if (!subtitle || !typing) {
        return;
      }
      var text = subtitle.getAttribute('data-typed-text');
      
        typing(text);
      
    })(window, document);
  </script>




  
    <script  src="/js/img-lazyload.js" ></script>
  




  
<script>
  Fluid.utils.createScript('https://lib.baomitu.com/tocbot/4.20.1/tocbot.min.js', function() {
    var toc = jQuery('#toc');
    if (toc.length === 0 || !window.tocbot) { return; }
    var boardCtn = jQuery('#board-ctn');
    var boardTop = boardCtn.offset().top;

    window.tocbot.init(Object.assign({
      tocSelector     : '#toc-body',
      contentSelector : '.markdown-body',
      linkClass       : 'tocbot-link',
      activeLinkClass : 'tocbot-active-link',
      listClass       : 'tocbot-list',
      isCollapsedClass: 'tocbot-is-collapsed',
      collapsibleClass: 'tocbot-is-collapsible',
      scrollSmooth    : true,
      includeTitleTags: true,
      headingsOffset  : -boardTop,
    }, CONFIG.toc));
    if (toc.find('.toc-list-item').length > 0) {
      toc.css('visibility', 'visible');
    }

    Fluid.events.registerRefreshCallback(function() {
      if ('tocbot' in window) {
        tocbot.refresh();
        var toc = jQuery('#toc');
        if (toc.length === 0 || !tocbot) {
          return;
        }
        if (toc.find('.toc-list-item').length > 0) {
          toc.css('visibility', 'visible');
        }
      }
    });
  });
</script>


  <script src=https://lib.baomitu.com/clipboard.js/2.0.11/clipboard.min.js></script>

  <script>Fluid.plugins.codeWidget();</script>


  
<script>
  Fluid.utils.createScript('https://lib.baomitu.com/anchor-js/4.3.1/anchor.min.js', function() {
    window.anchors.options = {
      placement: CONFIG.anchorjs.placement,
      visible  : CONFIG.anchorjs.visible
    };
    if (CONFIG.anchorjs.icon) {
      window.anchors.options.icon = CONFIG.anchorjs.icon;
    }
    var el = (CONFIG.anchorjs.element || 'h1,h2,h3,h4,h5,h6').split(',');
    var res = [];
    for (var item of el) {
      res.push('.markdown-body > ' + item.trim());
    }
    if (CONFIG.anchorjs.placement === 'left') {
      window.anchors.options.class = 'anchorjs-link-left';
    }
    window.anchors.add(res.join(', '));

    Fluid.events.registerRefreshCallback(function() {
      if ('anchors' in window) {
        anchors.removeAll();
        var el = (CONFIG.anchorjs.element || 'h1,h2,h3,h4,h5,h6').split(',');
        var res = [];
        for (var item of el) {
          res.push('.markdown-body > ' + item.trim());
        }
        if (CONFIG.anchorjs.placement === 'left') {
          anchors.options.class = 'anchorjs-link-left';
        }
        anchors.add(res.join(', '));
      }
    });
  });
</script>


  
<script>
  Fluid.utils.createScript('https://lib.baomitu.com/fancybox/3.5.7/jquery.fancybox.min.js', function() {
    Fluid.plugins.fancyBox();
  });
</script>


  <script>Fluid.plugins.imageCaption();</script>

  <script  src="/js/local-search.js" ></script>





<!-- 主题的启动项，将它保持在最底部 -->
<!-- the boot of the theme, keep it at the bottom -->
<script  src="/js/boot.js" ></script>


  

  <noscript>
    <div class="noscript-warning">博客在允许 JavaScript 运行的环境下浏览效果更佳</div>
  </noscript>
</body>
</html>
